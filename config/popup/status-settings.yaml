################################################################################
#
# @author      : Thomas Maxson
# @package     : Popup, Settings
# @description :
#
################################################################################

action: fire-dom-event
browser_mod:
  command: popup
  service: browser_mod.popup
  data:
    title: Settings
    #timeout: 15000
    style: >
      --popup-max-width: calc( 385px + 385px + 385px );
    content:
      type: custom:mod-card
      card_mod:
        style:
          layout-card$:
            grid-layout$:
              .: |
                #root { overflow: hidden;}
              hui-entities-card:
                $: |
                  .card-content {
                    padding: 1.5em 1.5em 0;
                    margin: -2em 0 1em;
                  }

                  /* Desktop */
                  @media screen and (min-width: 992px) { 
                    .card-content { 
                      border-right: 1px solid var( --entities-divider-color, var( --divider-color ) );
                      border-left: 1px solid var( --entities-divider-color, var( --divider-color ) );
                      margin-right: -1px;
                      margin-left: -1px;
                    }
                  }
      card:
        type: custom:layout-card
        layout_type: custom:grid-layout
        layout:
          margin: 0
          grid-template-columns: repeat( 3, 385px )
          grid-template-rows: 1fr
          grid-template-areas: |
            'column_a column_b column_c'
          mediaquery:
            # Tablet and down
            "(max-width: 992px)":
              grid-template-columns: 1fr
              grid-template-rows: repeat( 3, 1fr )
              grid-template-areas: |
                'column_a'
                'column_b'
                'column_c'
        cards:
          - type: entities
            view_layout:
              grid-area: column_a
            show_header_toggle: false
            card_mod:
              class: column
            entities:
              - type: section
                label: Household Automations
              - entity: sensor.automation_daily_status
                name: Evening Automation

              - type: section
                label: Schedules

              - type: conditional
                conditions:
                  - entity: schedule.waste_take_out_solid
                    state_not: "unknown"
                  - entity: sensor.days_until_waste_day_solid
                    state_not: "unavailable"
                  - entity: sensor.days_until_waste_day_solid
                    state_not: "unknown"
                row:
                  entity: sensor.days_until_waste_day_solid
                  name: Trash Pickup

              - type: conditional
                conditions:
                  - entity: schedule.waste_take_out_bulk
                    state_not: "unknown"
                  - entity: sensor.days_until_waste_day_bulk
                    state_not: "unavailable"
                  - entity: sensor.days_until_waste_day_bulk
                    state_not: "unknown"
                row:
                  entity: sensor.days_until_waste_day_bulk
                  name: Bulk Pickup

              - type: conditional
                conditions:
                  - entity: schedule.waste_take_out_recycle
                    state_not: "unknown"
                  - entity: sensor.days_until_waste_day_recycle
                    state_not: "unavailable"
                  - entity: sensor.days_until_waste_day_recycle
                    state_not: "unknown"
                row:
                  entity: sensor.days_until_waste_day_recycle
                  name: Recycling Pickup

              - type: conditional
                conditions:
                  - entity: schedule.house_cleaning
                    state_not: "unknown"
                  - entity: sensor.days_until_cleaning_day
                    state_not: "unavailable"
                  - entity: sensor.days_until_cleaning_day
                    state_not: "unknown"
                row:
                  entity: sensor.days_until_cleaning_day
                  name: House Cleaning

          - type: entities
            view_layout:
              grid-area: column_b
            show_header_toggle: false
            card_mod:
              class: column
              style: |
                #states > div:nth-child(4), 
                #states > div:nth-child(5),
                #states > div:nth-child(6),
                #states > div:nth-child(7),
                #states > div:nth-child(8),
                #states > div:nth-child(9) { padding-left: 45px !important;}
            entities:
              - type: section
                label: Notifications
              - entity: input_boolean.app_notify
                name: Mobile Push Notifications
              - entity: input_boolean.household_notify
                name: Alexa Announcements

              - type: conditional
                conditions:
                  - entity: input_boolean.household_notify
                    state: "on"
                row:
                  entity: input_boolean.household_notify_kitchen
                  name: Kitchen

              - type: conditional
                conditions:
                  - entity: input_boolean.household_notify
                    state: "on"
                row:
                  entity: input_boolean.household_notify_dining_room
                  name: Dining Room

              - type: conditional
                conditions:
                  - entity: input_boolean.household_notify
                    state: "on"
                row:
                  entity: input_boolean.household_notify_bedroom_1
                  name: Main Bedroom

              - type: conditional
                conditions:
                  - entity: input_boolean.household_notify
                    state: "on"
                row:
                  entity: input_boolean.household_notify_bedroom_2
                  name: Guest Bedroom

              - type: conditional
                conditions:
                  - entity: input_boolean.household_notify
                    state: "on"
                row:
                  entity: input_boolean.household_notify_bedroom_3
                  name: Jess' Office

              - type: conditional
                conditions:
                  - entity: input_boolean.household_notify
                    state: "on"
                row:
                  entity: input_boolean.household_notify_bedroom_4
                  name: Tom's Office

          - type: entities
            view_layout:
              grid-area: column_c
            show_header_toggle: false
            card_mod:
              class: column
            entities:
              - type: section
                label: Sync Lights

              - type: conditional
                conditions:
                  - entity: light.bedroom_1_lamp_j
                    state_not: "unavailable"
                  - entity: light.bedroom_1_lamp_t
                    state_not: "unavailable"
                row:
                  entity: input_boolean.sync_bedroom_1_bedside_lamps
                  name: Main Bedroom, Bedside Lamps

              - type: conditional
                conditions:
                  - entity: light.foyer_ceiling_lights
                    state_not: "unavailable"
                row:
                  entity: input_boolean.sync_foyer_lights
                  name: Foyer, Entryway & Hallway

              - type: conditional
                conditions:
                  - entity: light.bedroom_4_lights
                    state_not: "unavailable"
                row:
                  entity: input_boolean.sync_bedroom_4_lights
                  name: Tom's Office
