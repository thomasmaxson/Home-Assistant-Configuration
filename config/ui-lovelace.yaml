################################################################################
#
# @author      : Thomas Maxson
# @package     : Lovelace UI
# @description :
#
################################################################################

button_card_templates: !include_dir_merge_named button_card_templates
decluttering_templates: !include_dir_named decluttering_templates

kiosk_mode:
  user_settings:
    - users:
        - "Johan"
        - "Jessica"
        - "Thomas"
        - "Leonardo"
        - "Dolores"
      hide_header: true
      hide_sidebar: true

views:
  - type: custom:grid-layout
    title: Dashboard
    path: dashboard
    layout:
      grid-gap: calc( var( --tihiti-dashboard-layout-padding ) / 1.2 ) calc( var( --tihiti-dashboard-layout-padding ) * 1.25 )
      grid-template-rows: min-content
      grid-template-columns: 0 23% repeat( 2, 1fr ) 0
      grid-template-areas: |
        ".  sidebar  common  foyer     ."
        ".  sidebar  bdr_1   bdr_3_4   ."
        ".  sidebar  other   resident  ."
        ".  popups   popups  popups    ."
        ".  .        .       .         ."
      mediaquery:
        # Tablet and down
        "(max-width: 992px)":
          grid-gap: var( --tihiti-dashboard-layout-padding )
          grid-template-rows: auto
          grid-template-columns: 0 1fr 0
          grid-template-areas: |
            ".  sidebar   ."
            ".  common    ."
            ".  foyer     ."
            ".  bdr_1     ."
            ".  bdr_3_4   ."
            ".  other     ."
            ".  resident  ."
            ".  popups    ."
            ".  .         ."
    cards:
      # extra_styles fix
      # https://github.com/custom-cards/button-card#injecting-css-with-extra_styles
      - type: custom:button-card
        styles: { card: [display: none] }

      - type: custom:button-card
        view_layout:
          grid-area: 1 / 2 / 2 / 5
        name: SET THEME TO "TIHITI" IN PROFILE
        tap_action:
          action: navigate
          navigation_path: /profile
        styles:
          card:
            - display: >
                [[[
                  return hass.themes.theme === 'tihiti'
                      ? 'none'
                      : 'initial';
                ]]]
          name:
            - z-index: 1
            - overflow: visible
            - color: red
            - font-weight: bolder
            - font-size: xxx-large
            - background: yellow

      #
      # SIDEBAR
      # --------------------------------------------------

      - type: vertical-stack
        view_layout:
          grid-area: sidebar
        cards:
          - type: custom:button-card
            entity: sensor.template_sidebar
            template: sidebar_template
            tap_action: !include popup/status-sidebar.yaml
            double_tap_action: !include popup/status-sidebar.yaml

          - type: conditional
            conditions:
              - entity: sensor.custom_laundry_machine_state
                state: "on"
            card:
              type: custom:mod-card
              card_mod:
                style:
                  hui-grid-card$: |
                    #root {
                      padding-top: 10%;
                    }
              card:
                type: grid
                square: false
                columns: 1
                cards:
                  - type: custom:button-card
                    entity: sensor.laundry_washer_combined_details
                    icon: mdi:washing-machine
                    name: Washing Machine
                    template:
                      - laundry

                  - type: custom:button-card
                    entity: sensor.laundry_dryer_combined_details
                    icon: mdi:tumble-dryer
                    name: Tumble Dryer
                    template:
                      - laundry

      #
      # COMMON AREAS
      # --------------------------------------------------

      - type: grid
        view_layout:
          grid-area: common
        square: false
        columns: 1
        cards:
          - type: custom:swipe-card
            square: false
            parameters:
              autoHeight: true
              roundLengths: true
              effect: coverflow
              speed: 650
              spaceBetween: 20
              threshold: 7
              coverflowEffect:
                rotate: 80
                depth: 300
            cards:
              - type: grid
                title: Common Areas
                columns: 3
                cards:
                  - type: custom:button-card
                    entity: light.kitchen_ceiling_lights
                    name: Kitchen
                    template:
                      #- popup_dimmer_colors
                      - light

                  - type: custom:button-card
                    entity: light.dining_room_chandelier
                    name: Chandelier
                    template:
                      #- popup_dimmer
                      - light

                  - type: custom:button-card
                    entity: light.living_room_corner_lamp
                    name: Corner Lamp
                    template:
                      #- popup_dimmer_colors
                      - light

              - type: grid
                title: Kitchen Cabinets
                columns: 3
                cards:
                  - type: conditional
                    conditions:
                      #- entity: group.kitchen_cabinet_upper_lights
                      - entity: light.kitchen_cabinet_upper_coffee_bar
                        state_not: "unavailable"
                      - entity: light.kitchen_cabinet_upper_range
                        state_not: "unavailable"
                      - entity: input_boolean.sync_cabinet_above_lights
                        state_not: "unavailable"
                      - entity: input_boolean.sync_cabinet_above_lights
                        state: "on"
                    card:
                      type: custom:button-card
                      entity: light.cabinet_upper_lights
                      #entity: light.kitchen_cabinet_upper_coffee_bar
                      name: Up Lighting
                      template:
                        #- popup_dimmer_colors
                        - light

                  - type: conditional
                    conditions:
                      - entity: light.kitchen_cabinet_upper_coffee_bar
                        state_not: "unavailable"
                      - entity: input_boolean.sync_cabinet_above_lights
                        state: "off"
                    card:
                      type: custom:button-card
                      entity: light.kitchen_cabinet_upper_coffee_bar
                      name: Above Coffee Bar
                      template:
                        #- popup_dimmer_colors
                        - light

                  - type: conditional
                    conditions:
                      - entity: light.kitchen_cabinet_upper_range
                        state_not: "unavailable"
                      - entity: input_boolean.sync_cabinet_above_lights
                        state: "off"
                    card:
                      type: custom:button-card
                      entity: light.kitchen_cabinet_upper_range
                      name: Above Range
                      template:
                        #- popup_dimmer_colors
                        - light

              - type: grid
                title: Living Room Streaming
                columns: 3
                cards:
                  - type: custom:decluttering-card
                    template: button_media_appletv
                    variables:
                      - name: AppleTV
                      - room: Living Room
                      - entity: media_player.appletv_living_room
                      - remote: remote.appletv_living_room

                  - type: custom:button-card
                    entity: media_player.sony_bravia_tv
                    name: Television
                    template:
                      - base

              - type: grid
                title: Other Media
                columns: 3
                cards:
                  - type: custom:decluttering-card
                    template: button_media_echo
                    variables:
                      - name: Echo, Kitchen
                      - room: Kitchen
                      - entity: media_player.echo_kitchen
                      - permission: input_boolean.household_notify_kitchen

                  - type: custom:decluttering-card
                    template: button_media_echo
                    variables:
                      - name: Echo, Dining Room
                      - room: Dining Room
                      - entity: media_player.echo_dot_dining_room
                      - permission: input_boolean.household_notify_dining_room

      #
      # FOYER
      # --------------------------------------------------

      - type: grid
        view_layout:
          grid-area: foyer
        square: false
        columns: 1
        cards:
          - type: custom:swipe-card
            square: false
            parameters:
              autoHeight: true
              roundLengths: true
              effect: coverflow
              speed: 650
              spaceBetween: 20
              threshold: 7
              coverflowEffect:
                rotate: 80
                depth: 300
            cards:
              - type: grid
                title: Foyer
                columns: 3
                cards:
                  - type: custom:button-card
                    entity: light.foyer_ceiling_ledge
                    name: Ledge
                    template:
                      #- popup_dimmer_colors
                      - light

                  - type: conditional
                    conditions:
                      - entity: light.foyer_ceiling_lights
                        state_not: "unavailable"
                      - entity: input_boolean.sync_foyer_lights
                        state: "on"
                    card:
                      type: custom:button-card
                      entity: light.foyer_ceiling_lights
                      name: Ceiling
                      template:
                        #- popup_dimmer
                        - light

                  - type: conditional
                    conditions:
                      - entity: light.foyer_hallway_ceiling
                        state_not: "unavailable"
                      - entity: input_boolean.sync_foyer_lights
                        state: "off"
                    card:
                      type: custom:button-card
                      entity: light.foyer_hallway_ceiling
                      name: Hallway
                      template:
                        #- popup_dimmer
                        - light

                  - type: conditional
                    conditions:
                      - entity: light.foyer_entryway_ceiling
                        state_not: "unavailable"
                      - entity: input_boolean.sync_foyer_lights
                        state: "off"
                    card:
                      type: custom:button-card
                      entity: light.foyer_entryway_ceiling
                      name: Entryway
                      template:
                        #- popup_dimmer
                        - light

              - type: grid
                title: Foyer
                columns: 3
                cards:
                  - type: custom:button-card
                    entity: light.foyer_under_table
                    name: Floor
                    template:
                      #- popup_dimmer_colors
                      - light

                  # - type: custom:button-card
                  #   entity: climate.ecobee
                  #   name: Air Conditioner
                  #   double_tap_action: !include popup/status-temperatures.yaml
                  #   hold_action: !include popup/status-temperatures.yaml
                  #   template:
                  #     - base
                  #     - climate
                  #   variables:
                  #     circle_input: >
                  #       [[[
                  #         if (entity) {
                  #           return entity.state == 'cool' ?
                  #             entity.attributes.temperature :
                  #             entity.attributes.current_temperature;
                  #         }
                  #       ]]]

      #
      # BEDROOM 1
      # --------------------------------------------------

      - type: grid
        view_layout:
          grid-area: bdr_1
        square: false
        columns: 1
        cards:
          - type: custom:swipe-card
            square: false
            parameters:
              autoHeight: true
              roundLengths: true
              effect: coverflow
              speed: 650
              spaceBetween: 20
              threshold: 7
              coverflowEffect:
                rotate: 80
                depth: 300
            cards:
              - type: grid
                title: Main Bedroom
                columns: 3
                cards:
                  - type: conditional
                    conditions:
                      - entity: cover.bedroom_1_large_window_left
                        state_not: "unavailable"
                      - entity: cover.bedroom_1_large_window_right
                        state_not: "unavailable"
                    card:
                      type: custom:button-card
                      entity: cover.bedroom_1_large_curtains
                      name: Curtains
                      template:
                        - cover

                  # - type: custom:button-card
                  #   entity: light.bedroom_1_bedside_lamps
                  #   name: Bedside Lamps
                  #   template:
                  #     - popup_dimmer_colors

                  - type: conditional
                    conditions:
                      - entity: light.bedroom_1_bedside_lamps
                        state_not: "unavailable"
                      - entity: input_boolean.sync_bedroom_1_bedside_lamps
                        state: "on"
                    card:
                      type: custom:button-card
                      entity: light.bedroom_1_bedside_lamps
                      name: Bedside Lamps
                      template:
                        - light

                  - type: conditional
                    conditions:
                      - entity: light.bedroom_1_lamp_j
                        state_not: "unavailable"
                      - entity: input_boolean.sync_bedroom_1_bedside_lamps
                        state: "off"
                    card:
                      type: custom:button-card
                      entity: light.bedroom_1_lamp_j
                      name: Her Bedside
                      template:
                        - light

                  - type: conditional
                    conditions:
                      - entity: light.bedroom_1_lamp_t
                        state_not: "unavailable"
                      - entity: input_boolean.sync_bedroom_1_bedside_lamps
                        state: "off"
                    card:
                      type: custom:button-card
                      entity: light.bedroom_1_lamp_t
                      name: His Bedside
                      template:
                        - light

              - type: grid
                title: Main Bedroom Media
                columns: 3
                cards:
                  - type: custom:decluttering-card
                    template: button_media_appletv
                    variables:
                      - name: AppleTV
                      - room: Main Bedroom
                      - entity: media_player.appletv_bedroom_1
                      - remote: remote.appletv_bedroom_1

                  - type: custom:decluttering-card
                    template: button_media_echo
                    variables:
                      - name: Echo Dot
                      - room: Main Bedroom
                      - entity: media_player.echo_dot_bedroom_1
                      - permission: input_boolean.household_notify_bedroom_1

              - type: grid
                title: Closet Lights
                columns: 3
                cards:
                  - type: custom:button-card
                    entity: light.closet_hallway_ceiling_light
                    name: Hallway
                    icon: hue:recessed-ceiling
                    template:
                      - light

                  - type: custom:button-card
                    entity: light.closet_hallway_light_j
                    name: Her Closet
                    template:
                      #- popup_dimmer_colors
                      - light

                  - type: custom:button-card
                    entity: light.closet_hallway_light_t
                    name: His Closet
                    template:
                      #- popup_dimmer_colors
                      - light

      #
      # BEDROOM 3 AND 4
      # --------------------------------------------------

      - type: grid
        view_layout:
          grid-area: bdr_3_4
        square: false
        columns: 1
        cards:
          - type: custom:swipe-card
            square: false
            parameters:
              autoHeight: true
              roundLengths: true
              effect: coverflow
              speed: 650
              spaceBetween: 20
              threshold: 7
              coverflowEffect:
                rotate: 80
                depth: 300
            cards:
              - type: grid
                title: Office's
                columns: 3
                cards:
                  - type: conditional
                    conditions:
                      - entity: light.bedroom_4_lights
                        state_not: "unavailable"
                      - entity: input_boolean.sync_bedroom_4_lights
                        state: "on"
                    card:
                      type: custom:button-card
                      entity: light.bedroom_4_lights
                      name: Tom
                      template:
                        #- popup_dimmer_colors
                        - light

                  - type: conditional
                    conditions:
                      - entity: light.bedroom_4_desk_lamp
                        state_not: "unavailable"
                      - entity: input_boolean.sync_bedroom_4_lights
                        state: "off"
                    card:
                      type: custom:button-card
                      entity: light.bedroom_4_desk_lamp
                      name: Tom, Desk Lamp
                      template:
                        #- popup_dimmer_colors
                        - light

                  - type: conditional
                    conditions:
                      - entity: light.bedroom_4_lightstrip
                        state_not: "unavailable"
                      - entity: input_boolean.sync_bedroom_4_lights
                        state: "off"
                    card:
                      type: custom:button-card
                      entity: light.bedroom_4_lightstrip
                      name: Tom, Lightstrip
                      template:
                        #- popup_dimmer_colors
                        - light

                  # - type: custom:button-card
                  #   entity: light.bedroom_4_lights
                  #   name: Tom
                  #   template:
                  #     - popup_dimmer_colors
                  #     - light

                  - type: custom:button-card
                    entity: light.closet_hallway_ceiling_light
                    name: Jess
                    icon: hue:room-office
                    template:
                      #- popup_dimmer
                      - light

              - type: grid
                title: Tom's Office Media
                columns: 3
                cards:
                  # - type: custom:button-card
                  #   entity: media_player.appletv_bedroom_4
                  #   name: AppleTV
                  #   template:
                  #     - media

                  - type: custom:decluttering-card
                    template: button_media_appletv
                    variables:
                      - name: AppleTV
                      - room: Tom's Office
                      - entity: media_player.appletv_bedroom_4
                      - remote: remote.appletv_bedroom_4

                  - type: custom:decluttering-card
                    template: button_media_echo
                    variables:
                      - name: Echo Dot
                      - room: Tom's Office
                      - entity: media_player.echo_dot_bedroom_4
                      - permission: input_boolean.household_notify_bedroom_4

              - type: grid
                title: Jess' Office Media
                columns: 3
                cards:
                  - type: custom:decluttering-card
                    template: button_media_appletv
                    variables:
                      - name: AppleTV
                      - room: Jess' Office
                      - entity: media_player.appletv_bedroom_3
                      - remote: remote.appletv_bedroom_3

                  - type: custom:decluttering-card
                    template: button_media_echo
                    variables:
                      - name: Echo Dot
                      - room: Jess' Office
                      - entity: media_player.echo_dot_bedroom_3
                      - permission: input_boolean.household_notify_bedroom_3

      #
      # OTHER
      # --------------------------------------------------

      - type: grid
        view_layout:
          grid-area: other
        square: false
        columns: 1
        cards:
          - type: custom:swipe-card
            square: false
            parameters:
              autoHeight: true
              roundLengths: true
              effect: coverflow
              speed: 650
              spaceBetween: 20
              threshold: 7
              coverflowEffect:
                rotate: 80
                depth: 300
            cards:
              - type: grid
                title: Exterior
                columns: 3
                cards:
                  - type: custom:button-card
                    entity: switch.backyard_string_lights
                    name: Backyard
                    template:
                      #- popup_switch
                      - light

                  - type: custom:button-card
                    entity: light.foyer_exterior_entryway
                    name: Entryway
                    template:
                      #- popup_dimmer
                      - light

                  - type: custom:button-card
                    entity: light.garage_exterior
                    name: Garage
                    template:
                      #- popup_dimmer
                      - light

              - type: grid
                title: Laundry Room
                columns: 3
                cards:
                  - type: custom:button-card
                    entity: light.laundry_ceiling_light
                    name: Ceiling
                    template:
                      #- popup_dimmer_colors
                      - light

                  - type: custom:button-card
                    entity: light.laundry_hallway_light
                    name: Hallway
                    template:
                      #- popup_dimmer
                      - light

              - type: grid
                title: Other
                columns: 3
                cards:
                  - type: custom:button-card
                    entity: light.guest_hallway_light
                    name: Guest Hallway
                    template:
                      #- popup_dimmer
                      - light

                  - type: custom:button-card
                    entity: switch.garage_light
                    name: Garage
                    template:
                      #- popup_switch
                      - light

                  - type: custom:decluttering-card
                    template: button_media_echo
                    variables:
                      - name: Echo Dot
                      - room: Guest Bedroom
                      - entity: media_player.echo_dot_bedroom_2
                      - permission: input_boolean.household_notify_bedroom_2

              # - type: grid
              #   title: Guest Bedroom
              #   columns: 3
              #   cards:
              #     - type: custom:button-card
              #       entity: media_player.appletv_bedroom_2
              #       name: AppleTV
              #       icon: hass:apple
              #       template:
              #         - media

      #
      # RESIDENT
      # --------------------------------------------------

      - type: grid
        view_layout:
          grid-area: resident
        square: false
        columns: 1
        cards:
          - type: custom:swipe-card
            square: false
            parameters:
              autoHeight: true
              roundLengths: true
              effect: coverflow
              speed: 650
              spaceBetween: 20
              threshold: 7
              coverflowEffect:
                rotate: 90
                depth: 300
            cards:
              - type: grid
                title: Resident Status
                columns: 3
                cards:
                  - type: custom:button-card
                    name: Tom
                    entity: person.thomas
                    tap_action: !include popup/person-thomas.yaml
                    double_tap_action: !include popup/person-thomas.yaml
                    hold_action: !include popup/person-thomas.yaml
                    template:
                      - person

                  - type: custom:button-card
                    name: Jess
                    entity: person.jessica
                    tap_action: !include popup/person-jessica.yaml
                    double_tap_action: !include popup/person-jessica.yaml
                    hold_action: !include popup/person-jessica.yaml
                    template:
                      - person

                  - type: custom:button-card
                    name: Doggies
                    entity: group.pets
                    show_entity_picture: true
                    entity_picture: /local/uploads/avatar-gouda.png
                    tap_action: !include popup/pets.yaml
                    double_tap_action: !include popup/pets.yaml
                    hold_action: !include popup/pets.yaml
                    template:
                      - person_boolean

              - type: grid
                title: Resident Status
                columns: 3
                cards:
                  - type: custom:button-card
                    name: Leo
                    entity: person.leo
                    tap_action: !include popup/person-leonardo.yaml
                    double_tap_action: !include popup/person-leonardo.yaml
                    hold_action: !include popup/person-leonardo.yaml
                    template:
                      - person

                  - type: custom:button-card
                    name: Dolores
                    entity: person.dolores
                    tap_action: !include popup/person-dolores.yaml
                    double_tap_action: !include popup/person-dolores.yaml
                    hold_action: !include popup/person-dolores.yaml
                    template:
                      - person

                  - type: custom:button-card
                    name: Guests
                    entity: input_boolean.guests_home
                    show_entity_picture: true
                    entity_picture: /local/uploads/avatar-guest-dino.png
                    template:
                      - person_boolean

      #
      # Popups
      # --------------------------------------------------

      - type: custom:mod-card
        view_layout:
          grid-area: popups
        card_mod:
          style:
            hui-horizontal-stack-card$: |
              #root {
                justify-content: space-between;
                margin-top: 2vw;
              }

              @media screen and (max-width: 992px) {
                #root { 
                  flex-wrap: wrap;
                  margin: 0 -2vw;
                  padding-bottom: 5vw;
                }

                #root > button-card { 
                  flex: 1 1 40vw !important;
                  margin: 4vw 2vw 0 !important;
                  max-width: none !important;
                }
              }
        card:
          type: horizontal-stack
          cards:
            - type: custom:button-card
              #icon: hass:home-circle-outline
              name: >
                <ha-icon icon="mdi:home"></ha-icon> Overview
              template:
                - details
              tap_action: !include popup/status-household-overview.yaml
              double_tap_action: !include popup/status-household-overview.yaml

            - type: custom:button-card
              #icon: hass:home-circle-outline
              name: >
                <ha-icon icon="mdi:floor-plan"></ha-icon> Details
              template:
                - details
              tap_action: !include popup/status-household-details.yaml
              double_tap_action: !include popup/status-household-details.yaml

            - type: custom:button-card
              #icon: hass:thermometer
              name: >
                <ha-icon icon="mdi:thermometer"></ha-icon> Temperature
              template:
                - details
              tap_action: !include popup/status-temperatures.yaml
              double_tap_action: !include popup/status-temperatures.yaml

            - type: custom:button-card
              #icon: hass:router-wireless
              name: >
                <ha-icon icon="mdi:router-wireless"></ha-icon> Router
              template:
                - details
              tap_action: !include popup/status-router.yaml
              double_tap_action: !include popup/status-router.yaml

            - type: custom:button-card
              #icon: hass:information-outline
              name: >
                <ha-icon icon="mdi:information"></ha-icon> Systems
              template:
                - details
              tap_action: !include popup/status-systems.yaml
              double_tap_action: !include popup/status-systems.yaml

            - type: custom:button-card
              #icon: hass:cog
              name: >
                <ha-icon icon="mdi:cog"></ha-icon> Settings
              template:
                - details
              tap_action: !include popup/status-settings.yaml
              double_tap_action: !include popup/helpers.yaml
