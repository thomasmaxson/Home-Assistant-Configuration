[{"id":"0e8f6b67bf5f7644","type":"tab","label":"Time Events","disabled":false,"info":"","env":[]},{"id":"370eac02908e9c72","type":"tab","label":"Lights and Plugs","disabled":false,"info":"","env":[]},{"id":"a95ec654e9a3d387","type":"tab","label":"Contact Sensors","disabled":false,"info":"","env":[]},{"id":"ccf4e5eced60ee19","type":"tab","label":"Motion/Presense Sensors","disabled":false,"info":"","env":[]},{"id":"75bda675505dd534","type":"tab","label":"Button Clicks","disabled":false,"info":"","env":[]},{"id":"948139bb1964bc5a","type":"tab","label":"Status/Reminder Notifications","disabled":false,"info":"","env":[]},{"id":"4e1d02e135536c14","type":"tab","label":"Links & Listeners","disabled":false,"info":"","env":[]},{"id":"81dea24119402f3d","type":"tab","label":"Default Values","disabled":false,"info":"","env":[]},{"id":"9d5b166df6c5a423","type":"subflow","name":"Circadian Calculator","info":"","category":"","in":[{"x":60,"y":160,"wires":[{"id":"dd36e44f52c004a6"}]}],"out":[{"x":1120,"y":140,"wires":[{"id":"b164590f43513f75","port":0}]},{"x":1120,"y":340,"wires":[{"id":"103949ee1d3705df","port":0}]},{"x":520,"y":400,"wires":[{"id":"1c9430e6a50c3787","port":0}]}],"env":[],"meta":{},"color":"#DDAA99"},{"id":"26c6c4d5.3a01e4","type":"subflow","name":"Sub Circadian NR","info":"","category":"","in":[{"x":60,"y":160,"wires":[{"id":"7d4ca80d.e23468"}]}],"out":[{"x":1120,"y":140,"wires":[{"id":"e64dbfa.021204","port":0}]},{"x":1120,"y":340,"wires":[{"id":"d9f0035a.28956","port":0}]},{"x":500,"y":500,"wires":[{"id":"667d6dd.334db94","port":0}]}],"env":[],"color":"#DDAA99"},{"id":"af922ec12cc24eb2","type":"group","z":"0e8f6b67bf5f7644","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["07e34c08054233c9","ad1dd621c9a1d82b","b8f52e4f41cd2d0d","83b265c91908ebc9","72af4f94c5a53079","ce7234c8b9b5fb38","37c06292e60fa0f2","3d6c570539c4e0a6","8df8865412c76469","352185a904ef52c8","37289fa14f97c1e8","36bdeb7225d0ea6e","eb336140f99bd9fb","6e0b3c1b03210e20"],"x":54,"y":39,"w":1152,"h":362},{"id":"97d95b79239fec91","type":"group","z":"0e8f6b67bf5f7644","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["b66b740408fe5733","0e6387d816fe4ec4","96859a22cd8299b4","d547650c5a2d1f2c","5d2192971d6295d0","952a5b6384f3a813","3c62e5ec83b578b2","77ce70f8ea73afa1","37607b4f0d35d515","04bbb29df615e268","1470f335e76b6c98","131cf7adb5bda567","38ac479d21115bd1","a3c88ca6db142ac5","db3807be89a1242f","4a5ed6e5c3b386f2","66d097f60a9eac22","f344be2df57e242f","e35f0e75fe9a65d6","508530b4a6242cc6","3ebc94adc32366e3","9ad5147cd229ac8a","67270dccd98acc56","de0ed0234e95f9c5","c218acd985a07b5a","c17a282f711fde5b","d9c0c2e3795b9980","7971e1dc35e7ff5c","ac8e0389514188ba","1eacbfa02a0bb6ba","8272565b80b03049"],"x":54,"y":459,"w":1952,"h":542},{"id":"bcf8b42cf961c13f","type":"group","z":"0e8f6b67bf5f7644","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["c60407f09c621f80","32cccaadc1c71ce0","8b63dfc4c9e23c15","83bdc9bdedd5c703","8beb947db40d7699","5b4b316c5ce5394b","9d3441863665ba13","392103830291ac1f","69a9377db1fbae6d","be4261c9c45ad9e4","8b51a5fc2224d8ab","4be567938dadd156","66eb2a0e58d55b7e","9b69b8b35935fe53","eeef0cefb4f6596c","31a1ccbe51156198","68f7401fae6b2122","7ef1a443942dbba3","0386f69352102998","50daefad513e6590","83f5bdc8b93aaa05","e73ebd0bd5c0344b","e444dbca5dc32c07","df4ac9e5af0e8f6f"],"x":54,"y":1059,"w":1672,"h":482},{"id":"2e3b23fa8bdd39e5","type":"group","z":"0e8f6b67bf5f7644","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["4991cbbf93c19290","c503d2b6a1a0383b","ae84aaeac0e2a1a9","8802fe602952f823","5ae2e1759b1b5e6f","cfdec9104a02fb65","198e74a3939a6842","c528cc43d00f0cc7","d5ba5751b57363cc"],"x":54,"y":1599,"w":1392,"h":249.5},{"id":"8e91da327c4f467a","type":"group","z":"0e8f6b67bf5f7644","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["ca3ea91ad8b05cff","5acf72e502eba1e0","8575c9d21522d666","2a6908734907a6da","a22dcc5d492030a2","9a968797d5701d11","79a8ec701046fd7e","49aae6dea38bcdde","6cf4987d08bd7f90","24d40ae116f2abbf","fab92a208bf509b5","d4dd2d5a95e5b2bb","82164ad95d19fcbf","6d15f775ebda48ae","edad0925e580072e","1e787fa60f2d075f","a3b250eba3c64cb3"],"x":34,"y":1919,"w":1212,"h":422},{"id":"367e75d2d85ed706","type":"group","z":"370eac02908e9c72","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["c70b6053b4d6599f","dc35a4cc9acaa5b9","ca467f193638218b","515d64c86191d7de","e07fc4259f7b6181","c0622123073c57a8","fee91f9ed6ad470c","d03975cda544a189","6f2d85a6a54fbbee","e8e5c0f9cf80af21","5d5bea5472bb3bb2","1e9050d391ca7819","b9d89c613a1b234e","e4e06f4c1368d459","d7d46190450750b9","e832462b8a547483","37d8647648168c4d","b31402391f53f9d0","f199ea158572f466"],"x":54,"y":39},{"id":"4a7a9a56bbdb18de","type":"group","z":"370eac02908e9c72","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["994755894f9425d7","8d527994334e98eb","dcd72d9fbd5a63f7","c94ff329760335bb","6a488af591956051","315184c507ef5cc0","a4b2a8b79f8c0173","f5d9c9ec46bbfb57","4a3cd92e09296f4f"],"x":54,"y":519},{"id":"6eb43475c0cbaf9e","type":"group","z":"a95ec654e9a3d387","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["1c847a4542ba2517","ef91789de0473a81","e9f3e7483c18d115","ddd8b329f4e3a961","7e202ccdfad1b05e","d15333f5ccc06648","a0c896fe6f9d5e73","f3b33899ef94e86c","2d23a7750946bc2d","e36723d0dfbe9e9b","42ad578531c8707d"],"x":54,"y":39},{"id":"09686aa28ec76166","type":"group","z":"a95ec654e9a3d387","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["6e2692b464e48171","62d3c0a6b3149a7c","b08efe5d84243062","02c9c7877f7bd7c5","cfd5c0a89e5d590f","3ef848920d23e01f","4639f3deaa4ba71c","ffccc618fbd95dcf","c48c1d94ee6a6711","91807a1772f7a7a2","94f366c12ae2345d"],"x":54,"y":399},{"id":"90b28685286b5c32","type":"group","z":"a95ec654e9a3d387","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["17ad99136b4197a1","21801c8f5b05bbeb","44467fe5ac8839e9","e383ad20283ccd96","70edd8b188ca85ad","5daf96868aba87cc","4d811e4669d588c1","d721ce3bd6206ce3","d105d1df17b7b199","b4fb0ad9bfb713c4","b18a99e3215ce7a9","4db84ce07de49276","21107ebe8dd9c18e","0961568796c4d8d0","8669b6b9606d216c"],"x":54,"y":759},{"id":"6c9abf623b0a916b","type":"group","z":"a95ec654e9a3d387","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["4176d3096e74d1b3","0419deb2604ded4e","1fe2909fe5562946","bfd7f3089fe57cd9","106add1242e5743b","6b05354a13d1ee5f","b4d9116fa41904ef","7d9709d3259ee1a6","6ae6f746e7a16ed2","4f8bd1dd7d308b46","6768dd61bf1cd6cb","c1a45add8f9cb37c"],"x":54,"y":1599},{"id":"2ef23d258e2908a5","type":"group","z":"a95ec654e9a3d387","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["d2b33d4a909a0a46","55511dc777b8bc3a","04478b2b3f8ba6c4","fab252dc566fd69f","96a6be7a7bdad98a","10fb8e3957dae1b8","c375aba6238b4590","c367a2a0e26fd211","6ae3bfdbf1d8b22a","0877b98de68e358f","ef376d85a3136f21","95fd9e323278f51b","98af20ded667f694"],"x":54,"y":1199},{"id":"1f3f56a64bdf7245","type":"group","z":"ccf4e5eced60ee19","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["6e95ceae462da943","e679bdef811d07af","cd064c4e352ad592","5bbfae9781c64ed1","19a28fbde3c46587","a6fafb1aaff116e8","72cbdf5001a79ab4","184d75c4d4c87969","eba66ecd4c9de23d","16c1d615caad2d2a","7cf4574ac749e3ee"],"x":54,"y":799},{"id":"ac97a59aa0e054c4","type":"group","z":"ccf4e5eced60ee19","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["3cc73458ada50437","6b7b3dea72c4a498","813c6b4b26caebac","35144f3b54e1eb38","bf86bf1f40773cb9","2a9db556fe75a53e","2d34c7e53a7719d9","dd69428319a5c6d4","6c94fd1427d21d53","b73b70a08481ad81","8c18b33da463a312","18a2e9166694fb0c","a3917d33848d267a","d748f5671dfa2342","66acd1847becf796"],"x":54,"y":419},{"id":"babed62518ff1825","type":"group","z":"ccf4e5eced60ee19","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["deb9982ce6da6405","592b1510af2557a0","7251a67d88a0352f","88b0462386162524","4b31058af4d10e03","0aeff1a50e52889a","a705f00b0dbe73b5","f9d8b6613d08ac34","886d3b36ab1636e9","b8626ff9ac46f637","530882536988219d","f492ca33661c8df8"],"x":54,"y":1199},{"id":"bbdfd791e1227da1","type":"group","z":"75bda675505dd534","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["b33f1b35912969e0","a96ca5ac6d732b08","7133d65cba709e01","0180a8e0974cc07b","1f3d679062bc9586","f7a0be51b3cf53de","9591d8a2bed75603","17e0253cc7611cdd"],"x":54,"y":39},{"id":"33bd061414ad5b40","type":"group","z":"75bda675505dd534","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["2f432fce62092e59","ecaedb0332a56a66","f3677166f9d4bf1f","3edc04d189e93f7a","0312c7401aa0e5d9","3fdb42b5e9184596","29000e8ed5d4d341","fc1689bc6dcb068f","91ddff38f9f28f0e","adea0d6c350bdcaa","5621e03b3e92343a","17e4204a617c9394","c50afa0cb006d3a5","374b4d878013dcbf","53629c3fbf37b8d9","6597a7f5542b62ca","0e97fb0b2de1df97","191741edefbc2879","18a229de6692d719","7cfee9bcaadde84f"],"x":54,"y":359},{"id":"3c888c1f5a7f12b2","type":"group","z":"75bda675505dd534","name":"","style":{"label":true},"nodes":["f478cc2ddd156832","aa395cef7eb28827","0c8aebd6101ee42a","4e657bd12f3da99e","bca1cbf60fec6762","a4d93a3fba41f377","80c1fab30b054d93","1ede4d1e655b7797","541f985126d20172","43099f1c296af873","8b0413d1be866efc","1a9e5b3d723fd043","3f9b5f430db4660b","69db3d8a0e4cd78f","2343f16b29502fdb","804006fe20f4ab7b","49f92784cf7a09aa","ec1fccd358e40463","b2a7b37874b4b0fb"],"x":54,"y":859},{"id":"0b05817bb4d42102","type":"group","z":"75bda675505dd534","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["0e0b319d3521efee","4015279ee4d1fd11","3f4b62c2ba6c794c","16191e38c834bdf9","cb339aea427179e6","6971f02eb5529462","52d9e3956a90fe44","b489e401f64c6561","807a15bf46fb8d0b"],"x":54,"y":1379},{"id":"d46092dab47821af","type":"group","z":"75bda675505dd534","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["d62c5c9d.ef6d18","f67b163fc0dca4a8","01a357c9b63832ae","609ab88c0c8f076c","259e2ad8042c16d9","ca4892a8c0470bd9","259405adc493c6cc","a9ee4724c66e2f19","0a38f536b463b6b0","2a0d77fade2710e7","bfe8b62aa101afa1","dc9e9ba0c3926658","bcca83e51de327bb","577628db0a3600cf","b9a4464ae5baee1b","0998685f26fc6907","fe173d11a4227841","7b2b261b.83d72"],"x":54,"y":1739},{"id":"abb2809c73c9bf16","type":"group","z":"75bda675505dd534","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["4c382fd7d8a1471f","c59048d23c7e78c2","ac6478947365b072","d344f2a97433832f","b6465fd896443869","36f68ebfdafa41a2","a53a26265673939a","c96cb06fce36d315","8b379f210d5b55fd","ebab4eaf662659a7","52b14ca87346ef0d","4054e2fe3d389c8c","a418271732700c61","3142b021887873dc","dee03074ae00cbdc","46724618b7510644","3ca1851b424cb660","bae6b195750d5204","41a8c88062ca01cd"],"x":54,"y":2159},{"id":"ced32fcc854281a5","type":"group","z":"948139bb1964bc5a","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["0d46746ba8440730","6b22269b5e8e1a2c","5bc0b18a1d357024","74378d9b29e099d4","5f9dcdce99752d51","177426a8bad398f7","6af15fa1cd2941e5","0e1fa1181fbfbb95","6b25673ada107590","c6d8e1b43823a5dc"],"x":54,"y":39},{"id":"5df1c59ae220dac5","type":"group","z":"948139bb1964bc5a","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["b963a2ee377d2e71","8d26ab37046c1f9a","7cce35452bc5c875","23c6f469513289a8","beee4018748b4637","2172116495b4ee20","68a78ab1a08de10a"],"x":54,"y":539},{"id":"b4dea0a7c8b7a32a","type":"group","z":"948139bb1964bc5a","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["66022fb5265778ed","539dc1c9d7a3b1eb","0952a2ee0d589e03","a8e6cda928e350b6","7aea4a101153a0b6","e0b6b365e87fb6b5","8be476363dfd33d3","848ffb410d7e4f62","d30a428d728762dd","24c1d189ac8d12bd","fb7e0dafa51b5d69","d8c5e8e094766b97","f1c151b5836bc3ae","5b4d341efd689529","a3a6997c7dba4a4c","11f8bc649bee4ded","f69152fd9615e388"],"x":44,"y":839},{"id":"a2caccdf611fb758","type":"group","z":"948139bb1964bc5a","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["c779d0a765e3d78d","3a4231a2e53f04e3","16cc91349e008901","b6a048bf5769c8cf","2b7b1e49e0f35dad","2449ad9639bf3f31","8519b53052fc2bae","aaf36abb2aa6af60","56e812d6e0542d72","da2b881343195e9c","8418555f93c7b98a"],"x":54,"y":1399},{"id":"931f2c0cfb587811","type":"group","z":"948139bb1964bc5a","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["3d319eb43635c372","17e807837ca65f6b","cf5b15aa2245e096","a7d7b0b570ba854d","d61cb9f373232fee","4e4f06733134eff5","f26119da3f5552c2","444f17c4a559c495","066e5bd8f0eb8948"],"x":54,"y":2919},{"id":"2a7a5bd2ac8e1c46","type":"group","z":"948139bb1964bc5a","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["fd147829f79e871a","cbabbdf4c0ece489","8ccc6e2bce0ab81f","1f6a899ad824a749","b9a65f55c429fd35","bf8f7ff097449bb7"],"x":54,"y":3339},{"id":"7fbcda953d53c56b","type":"group","z":"948139bb1964bc5a","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["7118a48e68688bb8","b365d449119baa70","932e85ab244d80e2","df33dbf3fdbae692","6a042d145daea3b0","36bdebec6ee91fe3","e975ca0adb158f5f","da23c347ee0484dc","f5810ad2a121d7f5","ee5f7ac9c43720cd","e641a7b231760ed2","e288d2c91c14a96e","189c2f3c3581250e","2882055dd098430e","4cfb653c1f115c2c","0854fbd251b10ead","b8f60790ac1aa5c6","fe61967bf161f58f","1d4347f55d10d1e9"],"x":54,"y":2379},{"id":"ac8b5c16b46e9c89","type":"group","z":"4e1d02e135536c14","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["a2729e8ee4af65f5","634407b9c4245106","e9187377527269cb","ef5c926b3d1b7d84","34c20fee04f5acb2"],"x":54,"y":39},{"id":"a7d2737d0af97dc5","type":"group","z":"4e1d02e135536c14","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["eb19baaad61d9a94","31f547857960080c","b9e3518ae89a2aa3","2a99f9bbd9a83d47","44b0cb3beaf052c5","d717b7d40b9afdf5","c27893a6aa3d06a5"],"x":54,"y":299},{"id":"f7b26ea9f0e17e65","type":"group","z":"4e1d02e135536c14","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["b5bf4f1d2a2db4f8","9aa3882e80e1b6ad","5cf6c389a5ca2ed2","2906bc08a146bc76","92896d09a2191b53","79cffc2277e844a8","acaaaba2e5cf897f"],"x":64,"y":579},{"id":"58946bdd678fbfa5","type":"group","z":"4e1d02e135536c14","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["09e750898cfc8b60","c4be9eb3db479d51"],"x":48,"y":873},{"id":"0d3a64265ec09852","type":"group","z":"4e1d02e135536c14","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["e4754a95609a8baa","4c5fa8f19276f614","a4c20c7ee5f47897","7b53b32ba035cdb3","6e24d360031a0fbd","58d39ac25a967346","e08ed68555da4b82","9842fe79057cd998"],"x":54,"y":1639},{"id":"c27b37bacfd81b8e","type":"group","z":"4e1d02e135536c14","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["2248c3bddab232ab","daef73369d61fe35","abc34d2a8e6579a2","331ce6dccb637eac","9802069d87a1a750","e4a57b73ba4e22dd","cfa47ef66a12662e","46ebda7d20107695"],"x":54,"y":2019},{"id":"40db6052de5b63de","type":"group","z":"4e1d02e135536c14","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["dc5c6a3cf1f36edd","c5ecd5198894a738","9c5653e8a90c95e0","420cb61e6f9134cb","1d49619462c6119c","acc1c2bbdc58ad22"],"x":74,"y":2399},{"id":"8806b584b745745a","type":"group","z":"81dea24119402f3d","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["995c225c75538054","b9c175af458d5925","6d4b1fde79a29de3","b9afd6461191262c","d01b9c3f05e47861","28b0e8376823b8b7","077858d3b827010a","cc50702b59c1daa6","1c6b4d87eb9ef8c5","d107c7d766bf05d1","44c2360e2973d30b","e2040307364eefff","abf8d9ee7ba9cf8d","1dc768bbdc5359ac","848729d2b586e7b0","475dcb9934229d2f","c125f1ef115a3db3","5e65ca9be181824f","56b474f2908c2b33","0e31fd0f938087c7","dc79f3514cd3514d","1837f7aa88a7ae60","126413cbde7b5d5e","0e296da289d591b5","f05247446c43b482","7efdbde4e0e67848","f19ff094baa9b02b","b1a00b993f06f4e5","db49b0e0b2f5d0d1"],"x":44,"y":579,"w":1582,"h":1102},{"id":"8953653722b0a6b2","type":"group","z":"75bda675505dd534","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["2e1848ed47ecc384","fdde1db1d040cd66","37c59db0675968bb","d82e0b86dafd432e","f097b40a4e67e02c","c509db097f261da3","d26830d4bca97ec7","17cadfe8639999ee","b5da29cab8251554","a1c3525f3b4e549e","7fc118dbaef58868","2ab6688cb35abf93","70761485952b920a","9a64656fdea0d925","1077480807cb92d0","60967315f0040565","191db3f4aacd4f54","e652e8beb2243482","cead0db4e8f2ec05","d26499c9fabd5eb0"],"x":54,"y":2759},{"id":"6f4459aaf422d31f","type":"group","z":"ccf4e5eced60ee19","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["891e0a6331a6d3ee","d8568999abeae0c5","49caf1957641923a","c84665cc506cc72a","b551f8302ee60639","9983291167b2f4d5","f38856448387560f","2bd12a1dd8e20657","9695c9861fe197a3","5aa651de1c7f8f73","e97f90c8b6b8e055","a3969ac01df45fed","57e784ddeb4dd9f7","2e59f659b453aacb","5babcb06c7a4798c"],"x":54,"y":39},{"id":"13cb201c1eaab454","type":"group","z":"370eac02908e9c72","name":"","style":{"label":true},"nodes":["141c02687d1dfafe","48585d2cc85e09b9","ace97b19d3dc4a64","04d82e625ac65894","4938b8ad0de71b07","b9126440f312c954","6e42e2a393c3e958","323bf2bb26712c07","453043f1396c7a90","e97cc0d5f21f8211"],"x":74,"y":779},{"id":"40c745f7fabb9975","type":"group","z":"948139bb1964bc5a","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["448dbe97f92029d7","6a929669d7f2694b","721da16ca3f82f0d","a0837a18db1ac99b","959662168f83597b","a3d6a6fd4691c143","ead72e2a1c648d87","dc98c779025e2587","b837268a0c564ed7","3bce4a7095a297c0","c477dd8f123cf4b4"],"x":54,"y":1979},{"id":"52a2267cd3f77359","type":"group","z":"948139bb1964bc5a","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["26970241b0954a94","9b8508b0edc4f55a","5d4cdfd4257f70e7","293b8bc84ea48dde","aac23615626ff38d","c8f53c61458fb9a4","aa0f8898cfe55c10","611774d0fbc82adc","81582b29.b2e13"],"x":54,"y":1719},{"id":"09e750898cfc8b60","type":"group","z":"4e1d02e135536c14","g":"58946bdd678fbfa5","style":{"stroke":"#999999","stroke-opacity":"1","fill":"none","fill-opacity":"1","label":true,"label-position":"nw","color":"#a4a4a4"},"nodes":["23bf231d5f92d898","8a0b2594a3296c88","8a1a871a9a68c76c","dddf15f421481e85","9a29585104596ba7","05df8139c9f6130f","914500a98f1597b0","5c045c6f71cafd52","17b416995544c0ca"],"x":74,"y":899},{"id":"c4be9eb3db479d51","type":"group","z":"4e1d02e135536c14","g":"58946bdd678fbfa5","name":"","style":{"label":true},"nodes":["a62008d8914b95a2","1d6d45ce35d1f8fb","fa75df9d99a78852","8363ca529c5b4620","a425ce3a062da4e5","fd82a36789e9f0fd","f9e0b7ba2c681f39","3a01748301fe8498","c722151add88f640","b9fb615b89979085","e4967201c6355ab0","85de72e04aaa2de6","d892463cc91098f1","915f38fb1e724141","d86681ccbd79c9f3","4c26de52a53acb79","064a1785b9c6a8a0","d0dc2e32d91cc767","30a58835931e351d","e6130a39a2ab366a","e3f52efe96ae8364","b9d4c31f4c3cc017","42fa0ba60aff98c6","06d2f5e90b465001"],"x":74,"y":1079},{"id":"1040bb61.673d75","type":"server","name":"Home Assistant","version":2,"addon":true,"rejectUnauthorizedCerts":true,"ha_boolean":"","connectionDelay":false,"cacheJson":true,"heartbeat":false,"heartbeatInterval":""},{"id":"5b243deefd9de0d1","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey","palette":"light"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"31826811.22a458","type":"position-config","name":"Home Location","isValide":"true","longitude":"0","latitude":"0","angleType":"deg","timeZoneOffset":"99","timeZoneDST":"0","stateTimeFormat":"3","stateDateFormat":"12","contextStore":""},{"id":"26f98e1b.bd1812","type":"position-config","name":"","isValide":"true","longitude":"0","latitude":"0","angleType":"deg","timeZoneOffset":"99","timeZoneDST":"0","stateTimeFormat":"3","stateDateFormat":"12","contextStore":""},{"id":"7d5ff4fa087a1ae1","type":"switch","z":"9d5b166df6c5a423","name":"curve switch","property":"payload.times_of_day.active.name","propertyType":"msg","rules":[{"t":"eq","v":"night","vt":"str"},{"t":"eq","v":"morning","vt":"str"},{"t":"eq","v":"day","vt":"str"},{"t":"eq","v":"evening","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":510,"y":240,"wires":[["ceb610e6512e7c5a","ae47d0e553e6bbdc"],["c071a45eafc49203","1eb871a2fca59c93"],["a7f90772d90e5f53","69046c3fc86d6aa0"],["4bc2ddeb21bf7968","f7eace105dc8187f"]]},{"id":"ceb610e6512e7c5a","type":"spline-curve","z":"9d5b166df6c5a423","name":"night curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.3},{"x":0.333,"y":0.037},{"x":0.477,"y":0},{"x":0.783,"y":0},{"x":1,"y":0}],"x":750,"y":80,"wires":[["b164590f43513f75"]]},{"id":"c071a45eafc49203","type":"spline-curve","z":"9d5b166df6c5a423","name":"morning curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.01},{"x":0.132,"y":0.01},{"x":0.269,"y":0.027},{"x":0.449,"y":0.124},{"x":0.676,"y":0.334},{"x":1,"y":0.75}],"x":760,"y":120,"wires":[["b164590f43513f75"]]},{"id":"4bc2ddeb21bf7968","type":"spline-curve","z":"9d5b166df6c5a423","name":"evening curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.85},{"x":0.036,"y":0.78},{"x":0.176,"y":0.63},{"x":1,"y":0.3}],"x":760,"y":200,"wires":[["b164590f43513f75"]]},{"id":"a7f90772d90e5f53","type":"spline-curve","z":"9d5b166df6c5a423","name":"daylight curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.744},{"x":0.03,"y":0.838},{"x":0.097,"y":0.941},{"x":0.183,"y":1},{"x":0.86,"y":0.995},{"x":0.943,"y":0.931},{"x":1,"y":0.85}],"x":760,"y":160,"wires":[["b164590f43513f75"]]},{"id":"ae47d0e553e6bbdc","type":"spline-curve","z":"9d5b166df6c5a423","name":"night curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.5},{"x":0.067,"y":0.368},{"x":0.133,"y":0.265},{"x":0.27,"y":0.171},{"x":0.333,"y":0.16},{"x":0.506,"y":0.124},{"x":0.606,"y":0}],"x":750,"y":280,"wires":[["103949ee1d3705df"]]},{"id":"1eb871a2fca59c93","type":"spline-curve","z":"9d5b166df6c5a423","name":"morning curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0},{"x":0.42,"y":0.018},{"x":0.54,"y":0.051},{"x":0.587,"y":0.101},{"x":0.817,"y":0.675},{"x":1,"y":0.85}],"x":760,"y":320,"wires":[["103949ee1d3705df"]]},{"id":"f7eace105dc8187f","type":"spline-curve","z":"9d5b166df6c5a423","name":"evening curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.85},{"x":0.787,"y":0.598},{"x":1,"y":0.5}],"x":760,"y":400,"wires":[["103949ee1d3705df"]]},{"id":"69046c3fc86d6aa0","type":"spline-curve","z":"9d5b166df6c5a423","name":"daylight curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.85},{"x":0.123,"y":0.927},{"x":0.5,"y":1},{"x":0.92,"y":0.904},{"x":1,"y":0.85}],"x":760,"y":360,"wires":[["103949ee1d3705df"]]},{"id":"1c9430e6a50c3787","type":"function","z":"9d5b166df6c5a423","name":"Times of Day","func":"var newmsg = JSON.parse( JSON.stringify( msg ) );\nnewmsg.payload.times_of_day = {};\n\nprocessTimeOfDay = function( nme, obj, name_start, name_end )\n{ \n    var ret = {};\n    ret.name  = nme;\n    ret.start = obj.times[name_start].ts;\n    ret.end   = obj.times[name_end].ts;\n    ret.perc  = ( obj.ts - ret.start ) / ( ret.end - ret.start );\n\n    // To cover range starting before midnight and ending after it\n    if( ret.start > ret.end )\n    {\n        var a;\n\n        // Before midnight\n        if( ret.start < obj.ts )\n        { \n            a = new Date( ret.end );\n            a.setUTCDate( a.getUTCDate() + 1 );\n            ret.end = a.getTime();\n             \n             \n        } else if( ret.end > obj.ts )\n        { \n            a = new Date( ret.start );\n            a.setUTCDate( a.getUTCDate() - 1 );\n            ret.start = a.getTime();\n\n        } // endif\n    } // endif\n    \n    ret.perc  = ( obj.ts - ret.start ) / ( ret.end - ret.start );\n    \n    obj.times_of_day[nme] = ret;\n\n    if( ret.start <= obj.ts && obj.ts < ret.end )\n    { \n        obj.times_of_day.active = ret;\n\n    } // endif\n}\n\nprocessTimeOfDay( 'night', newmsg.payload, 'astronomicalDusk', 'astronomicalDawn' );\nprocessTimeOfDay( 'morning', newmsg.payload, 'astronomicalDawn', 'goldenHourDawnEnd' );\nprocessTimeOfDay( 'day', newmsg.payload, 'goldenHourDawnEnd', 'sunsetStart' );\nprocessTimeOfDay( 'evening', newmsg.payload, 'sunsetStart', 'astronomicalDusk' );\n\nreturn newmsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":290,"y":240,"wires":[["7d5ff4fa087a1ae1"]]},{"id":"b164590f43513f75","type":"range","z":"9d5b166df6c5a423","minin":"0","maxin":"1","minout":"1","maxout":"100","action":"scale","round":true,"property":"payload","name":"","x":980,"y":140,"wires":[[]]},{"id":"103949ee1d3705df","type":"range","z":"9d5b166df6c5a423","minin":"0","maxin":"1","minout":"2700","maxout":"5500","action":"scale","round":true,"property":"payload","name":"","x":990,"y":340,"wires":[[]]},{"id":"dd36e44f52c004a6","type":"sun-position","z":"9d5b166df6c5a423","name":"","positionConfig":"31826811.22a458","rules":[],"onlyOnChange":"true","topic":"","outputs":1,"start":"","startType":"none","startOffset":0,"startOffsetType":"num","startOffsetMultiplier":60000,"end":"","endType":"none","endOffset":0,"endOffsetType":"num","endOffsetMultiplier":60000,"x":190,"y":160,"wires":[["1c9430e6a50c3787"]]},{"id":"dc97f68a.35ea2","type":"switch","z":"26c6c4d5.3a01e4","name":"curve switch","property":"payload.times_of_day.active.name","propertyType":"msg","rules":[{"t":"eq","v":"night","vt":"str"},{"t":"eq","v":"morning","vt":"str"},{"t":"eq","v":"day","vt":"str"},{"t":"eq","v":"evening","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":510,"y":240,"wires":[["ce91189c.8bc7d8","bd8db343.5462f8"],["ad9966f3.3fced","4db18fbe.9ffb6"],["c2d43d53.d7ddf8","838233f4.7ffed"],["eef1dc11.39342","2e9ef8a9.d7fd88"]]},{"id":"ce91189c.8bc7d8","type":"spline-curve","z":"26c6c4d5.3a01e4","name":"night curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.3},{"x":0.333,"y":0.037},{"x":0.477,"y":0},{"x":0.783,"y":0},{"x":1,"y":0}],"x":750,"y":80,"wires":[["e64dbfa.021204"]]},{"id":"ad9966f3.3fced","type":"spline-curve","z":"26c6c4d5.3a01e4","name":"morning curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.01},{"x":0.132,"y":0.01},{"x":0.269,"y":0.027},{"x":0.449,"y":0.124},{"x":0.676,"y":0.334},{"x":1,"y":0.75}],"x":760,"y":120,"wires":[["e64dbfa.021204"]]},{"id":"eef1dc11.39342","type":"spline-curve","z":"26c6c4d5.3a01e4","name":"evening curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.85},{"x":0.036,"y":0.78},{"x":0.176,"y":0.63},{"x":1,"y":0.3}],"x":760,"y":200,"wires":[["e64dbfa.021204"]]},{"id":"c2d43d53.d7ddf8","type":"spline-curve","z":"26c6c4d5.3a01e4","name":"daylight curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.744},{"x":0.03,"y":0.838},{"x":0.097,"y":0.941},{"x":0.183,"y":1},{"x":0.86,"y":0.995},{"x":0.943,"y":0.931},{"x":1,"y":0.85}],"x":760,"y":160,"wires":[["e64dbfa.021204"]]},{"id":"bd8db343.5462f8","type":"spline-curve","z":"26c6c4d5.3a01e4","name":"night curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.5},{"x":0.067,"y":0.368},{"x":0.133,"y":0.265},{"x":0.27,"y":0.171},{"x":0.333,"y":0.16},{"x":0.506,"y":0.124},{"x":0.606,"y":0}],"x":750,"y":280,"wires":[["d9f0035a.28956"]]},{"id":"4db18fbe.9ffb6","type":"spline-curve","z":"26c6c4d5.3a01e4","name":"morning curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0},{"x":0.42,"y":0.018},{"x":0.54,"y":0.051},{"x":0.587,"y":0.101},{"x":0.817,"y":0.675},{"x":1,"y":0.85}],"x":760,"y":320,"wires":[["d9f0035a.28956"]]},{"id":"2e9ef8a9.d7fd88","type":"spline-curve","z":"26c6c4d5.3a01e4","name":"evening curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.85},{"x":0.787,"y":0.598},{"x":1,"y":0.5}],"x":760,"y":400,"wires":[["d9f0035a.28956"]]},{"id":"838233f4.7ffed","type":"spline-curve","z":"26c6c4d5.3a01e4","name":"daylight curve","output_key":"","input_key":"payload.times_of_day.active.perc","points":[{"x":0,"y":0.85},{"x":0.123,"y":0.927},{"x":0.5,"y":1},{"x":0.92,"y":0.904},{"x":1,"y":0.85}],"x":760,"y":360,"wires":[["d9f0035a.28956"]]},{"id":"667d6dd.334db94","type":"function","z":"26c6c4d5.3a01e4","name":"Times of Day","func":"var newmsg = JSON.parse( JSON.stringify( msg ) );\nnewmsg.payload.times_of_day = {};\n\nprocessTimeOfDay = function( nme, obj, name_start, name_end )\n{ \n    var ret = {};\n    ret.name  = nme;\n    ret.start = obj.times[name_start].ts;\n    ret.end   = obj.times[name_end].ts;\n    ret.perc  = ( obj.ts - ret.start ) / ( ret.end - ret.start );\n\n    // To cover range starting before midnight and ending after it\n    if( ret.start > ret.end )\n    {\n        var a;\n\n        // Before midnight\n        if( ret.start < obj.ts )\n        { \n            a = new Date( ret.end );\n            a.setUTCDate( a.getUTCDate() + 1 );\n            ret.end = a.getTime();\n             \n             \n        } else if( ret.end > obj.ts )\n        { \n            a = new Date( ret.start );\n            a.setUTCDate( a.getUTCDate() - 1 );\n            ret.start = a.getTime();\n\n        } // endif\n    } // endif\n    \n    ret.perc  = ( obj.ts - ret.start ) / ( ret.end - ret.start );\n    \n    obj.times_of_day[nme] = ret;\n\n    if( ret.start <= obj.ts && obj.ts < ret.end )\n    { \n        obj.times_of_day.active = ret;\n\n    } // endif\n}\n\nprocessTimeOfDay( 'night', newmsg.payload, 'astronomicalDusk', 'astronomicalDawn' );\nprocessTimeOfDay( 'morning', newmsg.payload, 'astronomicalDawn', 'goldenHourDawnEnd' );\nprocessTimeOfDay( 'day', newmsg.payload, 'goldenHourDawnEnd', 'sunsetStart' );\nprocessTimeOfDay( 'evening', newmsg.payload, 'sunsetStart', 'astronomicalDusk' );\n\nreturn newmsg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":290,"y":240,"wires":[["dc97f68a.35ea2"]]},{"id":"e64dbfa.021204","type":"range","z":"26c6c4d5.3a01e4","minin":"0","maxin":"1","minout":"1","maxout":"100","action":"scale","round":true,"property":"payload","name":"","x":980,"y":140,"wires":[[]]},{"id":"d9f0035a.28956","type":"range","z":"26c6c4d5.3a01e4","minin":"0","maxin":"1","minout":"2000","maxout":"5500","action":"scale","round":true,"property":"payload","name":"","x":990,"y":340,"wires":[[]]},{"id":"7d4ca80d.e23468","type":"sun-position","z":"26c6c4d5.3a01e4","name":"","positionConfig":"26f98e1b.bd1812","rules":[],"onlyOnChange":"true","topic":"","outputs":1,"start":"","startType":"none","startOffset":0,"startOffsetType":"num","startOffsetMultiplier":60000,"end":"","endType":"none","endOffset":0,"endOffsetType":"num","endOffsetMultiplier":60000,"x":190,"y":160,"wires":[["667d6dd.334db94"]]},{"id":"b66b740408fe5733","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"Turn Living Room Corner Lamp ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.living_room_corner_lamp"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1660,"y":840,"wires":[["a3c88ca6db142ac5"]]},{"id":"0e6387d816fe4ec4","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"Turn Foyer Exterior Light ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.foyer_exterior_entryway"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1180,"y":720,"wires":[["8272565b80b03049"]]},{"id":"96859a22cd8299b4","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"Turn Garage Exterior Lights ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.garage_exterior"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1190,"y":660,"wires":[["66d097f60a9eac22"]]},{"id":"d547650c5a2d1f2c","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"Turn Backyard Exterior Lights ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"switch","service":"turn_on","areaId":[],"deviceId":[],"entityId":["switch.backyard_string_lights"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1480,"y":900,"wires":[["f344be2df57e242f"]]},{"id":"5d2192971d6295d0","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"Turn Foyer Ceiling Ledge Light ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.foyer_ceiling_ledge"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1480,"y":960,"wires":[["e35f0e75fe9a65d6"]]},{"id":"952a5b6384f3a813","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"If TV is on","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"playing","halt_if_type":"str","halt_if_compare":"is","entity_id":"media_player.sony_bravia_tv","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1180,"y":840,"wires":[["38ac479d21115bd1"],[]]},{"id":"3c62e5ec83b578b2","type":"bigtimer","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","outtopic":"","outpayload1":"active","outpayload2":"inactive","name":"Before Sunset","comment":"","lat":"26.305080","lon":"-80.197180","starttime":"5004","endtime":"10005","starttime2":0,"endtime2":0,"startoff":"-30","endoff":"-30","startoff2":0,"endoff2":0,"offs":0,"outtext1":"","outtext2":"","timeout":"2","sun":true,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":true,"jan":true,"feb":true,"mar":true,"apr":true,"may":true,"jun":true,"jul":true,"aug":true,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"day6":0,"month6":0,"day7":0,"month7":0,"day8":0,"month8":0,"day9":0,"month9":0,"day10":0,"month10":0,"day11":0,"month11":0,"day12":0,"month12":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"d6":0,"w6":0,"xday1":0,"xmonth1":0,"xday2":0,"xmonth2":0,"xday3":0,"xmonth3":0,"xday4":0,"xmonth4":0,"xday5":0,"xmonth5":0,"xday6":0,"xmonth6":0,"xday7":0,"xmonth7":0,"xday8":0,"xmonth8":0,"xday9":0,"xmonth9":0,"xday10":0,"xmonth10":0,"xday11":0,"xmonth11":0,"xday12":0,"xmonth12":0,"xd1":0,"xw1":0,"xd2":0,"xw2":0,"xd3":0,"xw3":0,"xd4":0,"xw4":0,"xd5":0,"xw5":0,"xd6":0,"xw6":0,"suspend":false,"random":false,"randon1":false,"randoff1":false,"randon2":false,"randoff2":false,"repeat":true,"atstart":true,"odd":false,"even":false,"x":200,"y":660,"wires":[["db3807be89a1242f"],[],[]]},{"id":"77ce70f8ea73afa1","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"If Residents Home","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"home","halt_if_type":"str","halt_if_compare":"is","entity_id":"group.residents","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":930,"y":840,"wires":[["952a5b6384f3a813","1470f335e76b6c98","131cf7adb5bda567"],[]]},{"id":"37607b4f0d35d515","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_exterior_entryway","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":920,"y":720,"wires":[["0e6387d816fe4ec4"],[]]},{"id":"04bbb29df615e268","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.garage_exterior","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":920,"y":660,"wires":[["96859a22cd8299b4"],[]]},{"id":"1470f335e76b6c98","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.backyard_string_lights","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1200,"y":900,"wires":[["d547650c5a2d1f2c"],[]]},{"id":"131cf7adb5bda567","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_ceiling_ledge","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1200,"y":960,"wires":[["5d2192971d6295d0"],[]]},{"id":"38ac479d21115bd1","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.living_room_corner_lamp","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1380,"y":840,"wires":[["b66b740408fe5733"],[]]},{"id":"c60407f09c621f80","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"Turn Living Room Corner Lamp OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.living_room_corner_lamp"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1370,"y":1440,"wires":[["66eb2a0e58d55b7e"]]},{"id":"32cccaadc1c71ce0","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"Turn Foyer Exterior Light OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.foyer_exterior_entryway"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1170,"y":1260,"wires":[["9b69b8b35935fe53"]]},{"id":"8b63dfc4c9e23c15","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"Turn Backyard Exterior Lights OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"switch","service":"turn_off","areaId":[],"deviceId":[],"entityId":["switch.backyard_string_lights"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1180,"y":1320,"wires":[["eeef0cefb4f6596c"]]},{"id":"83bdc9bdedd5c703","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"Turn Foyer Ceiling Ledge Light OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.foyer_ceiling_ledge"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1180,"y":1500,"wires":[["31a1ccbe51156198"]]},{"id":"8beb947db40d7699","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"If TV is off","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"media_player.sony_bravia_tv","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":900,"y":1440,"wires":[["be4261c9c45ad9e4"],[]]},{"id":"5b4b316c5ce5394b","type":"bigtimer","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","outtopic":"","outpayload1":"active","outpayload2":"inactive","name":"At Bedtime","comment":"","lat":"26.305080","lon":"-80.197180","starttime":"5004","endtime":"10005","starttime2":"0","endtime2":"0","startoff":"+270","endoff":"+270","startoff2":0,"endoff2":0,"offs":0,"outtext1":"","outtext2":"","timeout":"2","sun":true,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":true,"jan":true,"feb":true,"mar":true,"apr":true,"may":true,"jun":true,"jul":true,"aug":true,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"day6":0,"month6":0,"day7":0,"month7":0,"day8":0,"month8":0,"day9":0,"month9":0,"day10":0,"month10":0,"day11":0,"month11":0,"day12":0,"month12":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"d6":0,"w6":0,"xday1":0,"xmonth1":0,"xday2":0,"xmonth2":0,"xday3":0,"xmonth3":0,"xday4":0,"xmonth4":0,"xday5":0,"xmonth5":0,"xday6":0,"xmonth6":0,"xday7":0,"xmonth7":0,"xday8":0,"xmonth8":0,"xday9":0,"xmonth9":0,"xday10":0,"xmonth10":0,"xday11":0,"xmonth11":0,"xday12":0,"xmonth12":0,"xd1":0,"xw1":0,"xd2":0,"xw2":0,"xd3":0,"xw3":0,"xd4":0,"xw4":0,"xd5":0,"xw5":0,"xd6":0,"xw6":0,"suspend":false,"random":false,"randon1":false,"randoff1":false,"randon2":false,"randoff2":false,"repeat":true,"atstart":true,"odd":false,"even":false,"x":210,"y":1260,"wires":[["4be567938dadd156"],[],[]]},{"id":"9d3441863665ba13","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_exterior_entryway","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":910,"y":1260,"wires":[["32cccaadc1c71ce0"],[]]},{"id":"392103830291ac1f","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.backyard_string_lights","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":910,"y":1320,"wires":[["8b63dfc4c9e23c15"],[]]},{"id":"69a9377db1fbae6d","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_ceiling_ledge","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":910,"y":1500,"wires":[["83bdc9bdedd5c703"],[]]},{"id":"be4261c9c45ad9e4","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.living_room_corner_lamp","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1090,"y":1440,"wires":[["c60407f09c621f80"],[]]},{"id":"8b51a5fc2224d8ab","type":"inject","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"Trigger: INACTIVE","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"inactive","payloadType":"str","x":190,"y":1200,"wires":[["4be567938dadd156"]]},{"id":"4991cbbf93c19290","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"2e3b23fa8bdd39e5","name":"If Lock is UNLOCKED","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"unlocked","halt_if_type":"str","halt_if_compare":"is","entity_id":"lock.front_door","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":900,"y":1800,"wires":[["c503d2b6a1a0383b"],[]]},{"id":"c503d2b6a1a0383b","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"2e3b23fa8bdd39e5","name":"Front Door LOCK","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"lock","service":"lock","areaId":[],"deviceId":[],"entityId":["lock.front_door"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1150,"y":1800,"wires":[["ae84aaeac0e2a1a9"]]},{"id":"a3c88ca6db142ac5","type":"debug","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1910,"y":840,"wires":[]},{"id":"ae84aaeac0e2a1a9","type":"debug","z":"0e8f6b67bf5f7644","g":"2e3b23fa8bdd39e5","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1350,"y":1800,"wires":[]},{"id":"4be567938dadd156","type":"switch","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"Is Active?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"active","vt":"str"},{"t":"eq","v":"inactive","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":400,"y":1260,"wires":[["50daefad513e6590"],[]]},{"id":"db3807be89a1242f","type":"switch","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"Is Active?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"active","vt":"str"},{"t":"eq","v":"inactive","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":400,"y":660,"wires":[["c17a282f711fde5b"],[]]},{"id":"4a5ed6e5c3b386f2","type":"debug","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1890,"y":720,"wires":[]},{"id":"66d097f60a9eac22","type":"debug","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1430,"y":660,"wires":[]},{"id":"f344be2df57e242f","type":"debug","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1730,"y":900,"wires":[]},{"id":"e35f0e75fe9a65d6","type":"debug","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1730,"y":960,"wires":[]},{"id":"66eb2a0e58d55b7e","type":"debug","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1630,"y":1440,"wires":[]},{"id":"9b69b8b35935fe53","type":"debug","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1410,"y":1260,"wires":[]},{"id":"eeef0cefb4f6596c","type":"debug","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1430,"y":1320,"wires":[]},{"id":"31a1ccbe51156198","type":"debug","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1430,"y":1500,"wires":[]},{"id":"508530b4a6242cc6","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"If Guests Home","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.guests_home","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":920,"y":900,"wires":[["131cf7adb5bda567","1470f335e76b6c98","952a5b6384f3a813"],[]]},{"id":"68f7401fae6b2122","type":"inject","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"Trigger: ACTIVE","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"active","payloadType":"str","x":200,"y":1160,"wires":[["4be567938dadd156"]]},{"id":"3ebc94adc32366e3","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"If Gouda Home","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.gouda_home","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":920,"y":960,"wires":[["131cf7adb5bda567"],[]]},{"id":"9ad5147cd229ac8a","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"Turn Evening Automation Flag ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_on","areaId":[],"deviceId":[],"entityId":["input_boolean.automation_daily_sunset"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1200,"y":780,"wires":[["67270dccd98acc56"]]},{"id":"7ef1a443942dbba3","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"Turn Evening Automation Flag OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_off","areaId":[],"deviceId":[],"entityId":["input_boolean.automation_daily_sunset"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1180,"y":1380,"wires":[["0386f69352102998"]]},{"id":"67270dccd98acc56","type":"debug","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1430,"y":780,"wires":[]},{"id":"0386f69352102998","type":"debug","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1430,"y":1380,"wires":[]},{"id":"07e34c08054233c9","type":"inject","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","name":"Trigger: ACTIVE","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"active","payloadType":"str","x":200,"y":140,"wires":[["83b265c91908ebc9"]]},{"id":"ad1dd621c9a1d82b","type":"inject","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","name":"Trigger: INACTIVE","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"inactive","payloadType":"str","x":190,"y":180,"wires":[["83b265c91908ebc9"]]},{"id":"b8f52e4f41cd2d0d","type":"bigtimer","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","outtopic":"","outpayload1":"active","outpayload2":"inactive","name":"At Sunrise","comment":"","lat":"26.305080","lon":"-80.197180","starttime":"5003","endtime":"10001","starttime2":0,"endtime2":0,"startoff":"0","endoff":"0","startoff2":0,"endoff2":0,"offs":0,"outtext1":"","outtext2":"","timeout":"2","sun":true,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":true,"jan":true,"feb":true,"mar":true,"apr":true,"may":true,"jun":true,"jul":true,"aug":true,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"day6":0,"month6":0,"day7":0,"month7":0,"day8":0,"month8":0,"day9":0,"month9":0,"day10":0,"month10":0,"day11":0,"month11":0,"day12":0,"month12":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"d6":0,"w6":0,"xday1":0,"xmonth1":0,"xday2":0,"xmonth2":0,"xday3":0,"xmonth3":0,"xday4":0,"xmonth4":0,"xday5":0,"xmonth5":0,"xday6":0,"xmonth6":0,"xday7":0,"xmonth7":0,"xday8":0,"xmonth8":0,"xday9":0,"xmonth9":0,"xday10":0,"xmonth10":0,"xday11":0,"xmonth11":0,"xday12":0,"xmonth12":0,"xd1":0,"xw1":0,"xd2":0,"xw2":0,"xd3":0,"xw3":0,"xd4":0,"xw4":0,"xd5":0,"xw5":0,"xd6":0,"xw6":0,"suspend":false,"random":false,"randon1":false,"randoff1":false,"randon2":false,"randoff2":false,"repeat":true,"atstart":true,"odd":false,"even":false,"x":210,"y":240,"wires":[["83b265c91908ebc9"],[],[]]},{"id":"83b265c91908ebc9","type":"switch","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","name":"Is Active?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"active","vt":"str"},{"t":"eq","v":"inactive","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":400,"y":240,"wires":[["72af4f94c5a53079","8df8865412c76469","37289fa14f97c1e8"],[]]},{"id":"72af4f94c5a53079","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.backyard_string_lights","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":590,"y":360,"wires":[["ce7234c8b9b5fb38"],[]]},{"id":"ce7234c8b9b5fb38","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","name":"Turn Backyard Lights OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"switch","service":"turn_off","areaId":[],"deviceId":[],"entityId":["switch.backyard_string_lights"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":830,"y":360,"wires":[["37c06292e60fa0f2"]]},{"id":"37c06292e60fa0f2","type":"debug","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1050,"y":360,"wires":[]},{"id":"3d6c570539c4e0a6","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","name":"Turn Foyer Exterior Light OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.foyer_exterior_entryway"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":850,"y":240,"wires":[["352185a904ef52c8"]]},{"id":"8df8865412c76469","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_exterior_entryway","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":590,"y":240,"wires":[["3d6c570539c4e0a6"],[]]},{"id":"352185a904ef52c8","type":"debug","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1090,"y":240,"wires":[]},{"id":"37289fa14f97c1e8","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.garage_exterior","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":590,"y":300,"wires":[["36bdeb7225d0ea6e"],[]]},{"id":"36bdeb7225d0ea6e","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","name":"Turn Garage Exterior Lights OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.garage_exterior"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":860,"y":300,"wires":[["eb336140f99bd9fb"]]},{"id":"eb336140f99bd9fb","type":"debug","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1110,"y":300,"wires":[]},{"id":"de0ed0234e95f9c5","type":"inject","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"Trigger: ACTIVE","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"active","payloadType":"str","x":200,"y":560,"wires":[["db3807be89a1242f"]]},{"id":"c218acd985a07b5a","type":"inject","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"Trigger: INACTIVE","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"inactive","payloadType":"str","x":190,"y":600,"wires":[["db3807be89a1242f"]]},{"id":"ca3ea91ad8b05cff","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.garage_exterior","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":570,"y":2120,"wires":[["8575c9d21522d666"],[]]},{"id":"5acf72e502eba1e0","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"If Boolean is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.sidebar_display_waste_reminder","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":590,"y":2180,"wires":[["2a6908734907a6da"],[]]},{"id":"8575c9d21522d666","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"Turn Garage Exterior Lights OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.garage_exterior"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":840,"y":2120,"wires":[["a22dcc5d492030a2"]]},{"id":"2a6908734907a6da","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"Turn Waste Reminder Boolean ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_on","areaId":[],"deviceId":[],"entityId":["input_boolean.sidebar_display_waste_reminder"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":880,"y":2180,"wires":[["9a968797d5701d11"]]},{"id":"a22dcc5d492030a2","type":"debug","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1090,"y":2120,"wires":[]},{"id":"9a968797d5701d11","type":"debug","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1130,"y":2180,"wires":[]},{"id":"8802fe602952f823","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"2e3b23fa8bdd39e5","name":"If Residents are HOME","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"home","halt_if_type":"str","halt_if_compare":"is","entity_id":"group.residents","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":630,"y":1800,"wires":[["4991cbbf93c19290"],[]]},{"id":"5ae2e1759b1b5e6f","type":"bigtimer","z":"0e8f6b67bf5f7644","g":"2e3b23fa8bdd39e5","outtopic":"","outpayload1":"active","outpayload2":"inactive","name":"At 10:00 pm","comment":"","lat":"26.305080","lon":"-80.197180","starttime":"1320","endtime":"10005","starttime2":0,"endtime2":0,"startoff":"0","endoff":"0","startoff2":0,"endoff2":0,"offs":0,"outtext1":"","outtext2":"","timeout":"2","sun":true,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":true,"jan":true,"feb":true,"mar":true,"apr":true,"may":true,"jun":true,"jul":true,"aug":true,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"day6":0,"month6":0,"day7":0,"month7":0,"day8":0,"month8":0,"day9":0,"month9":0,"day10":0,"month10":0,"day11":0,"month11":0,"day12":0,"month12":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"d6":0,"w6":0,"xday1":0,"xmonth1":0,"xday2":0,"xmonth2":0,"xday3":0,"xmonth3":0,"xday4":0,"xmonth4":0,"xday5":0,"xmonth5":0,"xday6":0,"xmonth6":0,"xday7":0,"xmonth7":0,"xday8":0,"xmonth8":0,"xday9":0,"xmonth9":0,"xday10":0,"xmonth10":0,"xday11":0,"xmonth11":0,"xday12":0,"xmonth12":0,"xd1":0,"xw1":0,"xd2":0,"xw2":0,"xd3":0,"xw3":0,"xd4":0,"xw4":0,"xd5":0,"xw5":0,"xd6":0,"xw6":0,"suspend":false,"random":false,"randon1":false,"randoff1":false,"randon2":false,"randoff2":false,"repeat":true,"atstart":true,"odd":false,"even":false,"x":210,"y":1800,"wires":[["cfdec9104a02fb65"],[],[]]},{"id":"79a8ec701046fd7e","type":"bigtimer","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","outtopic":"","outpayload1":"active","outpayload2":"inactive","name":"At Midnight","comment":"","lat":"26.305080","lon":"-80.197180","starttime":"0","endtime":"10001","starttime2":0,"endtime2":0,"startoff":"0","endoff":"0","startoff2":0,"endoff2":0,"offs":0,"outtext1":"","outtext2":"","timeout":"2","sun":true,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":true,"jan":true,"feb":true,"mar":true,"apr":true,"may":true,"jun":true,"jul":true,"aug":true,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"day6":0,"month6":0,"day7":0,"month7":0,"day8":0,"month8":0,"day9":0,"month9":0,"day10":0,"month10":0,"day11":0,"month11":0,"day12":0,"month12":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"d6":0,"w6":0,"xday1":0,"xmonth1":0,"xday2":0,"xmonth2":0,"xday3":0,"xmonth3":0,"xday4":0,"xmonth4":0,"xday5":0,"xmonth5":0,"xday6":0,"xmonth6":0,"xday7":0,"xmonth7":0,"xday8":0,"xmonth8":0,"xday9":0,"xmonth9":0,"xday10":0,"xmonth10":0,"xday11":0,"xmonth11":0,"xday12":0,"xmonth12":0,"xd1":0,"xw1":0,"xd2":0,"xw2":0,"xd3":0,"xw3":0,"xd4":0,"xw4":0,"xd5":0,"xw5":0,"xd6":0,"xw6":0,"suspend":false,"random":false,"randon1":false,"randoff1":false,"randon2":false,"randoff2":false,"repeat":true,"atstart":true,"odd":false,"even":false,"x":190,"y":2120,"wires":[["49aae6dea38bcdde"],[],[]]},{"id":"cfdec9104a02fb65","type":"switch","z":"0e8f6b67bf5f7644","g":"2e3b23fa8bdd39e5","name":"Is Active?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"active","vt":"str"},{"t":"eq","v":"inactive","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":400,"y":1800,"wires":[["8802fe602952f823"],[]]},{"id":"49aae6dea38bcdde","type":"switch","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"Is Active?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"active","vt":"str"},{"t":"eq","v":"inactive","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":380,"y":2120,"wires":[["5acf72e502eba1e0","ca3ea91ad8b05cff","fab92a208bf509b5","6d15f775ebda48ae"],[]]},{"id":"198e74a3939a6842","type":"inject","z":"0e8f6b67bf5f7644","g":"2e3b23fa8bdd39e5","name":"Trigger: ACTIVE","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"active","payloadType":"str","x":200,"y":1700,"wires":[["cfdec9104a02fb65"]]},{"id":"c528cc43d00f0cc7","type":"inject","z":"0e8f6b67bf5f7644","g":"2e3b23fa8bdd39e5","name":"Trigger: INACTIVE","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"inactive","payloadType":"str","x":190,"y":1740,"wires":[["cfdec9104a02fb65"]]},{"id":"6cf4987d08bd7f90","type":"inject","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"Trigger: INACTIVE","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"inactive","payloadType":"str","x":170,"y":2060,"wires":[["49aae6dea38bcdde"]]},{"id":"24d40ae116f2abbf","type":"inject","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"Trigger: ACTIVE","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"active","payloadType":"str","x":180,"y":2020,"wires":[["49aae6dea38bcdde"]]},{"id":"fab92a208bf509b5","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"If Boolean is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.doorbell_motion_snooze_today","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":580,"y":2240,"wires":[["d4dd2d5a95e5b2bb"],[]]},{"id":"d4dd2d5a95e5b2bb","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"Turn Doorbell Notification Boolean OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_off","areaId":[],"deviceId":[],"entityId":["input_boolean.doorbell_motion_snooze_today"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":880,"y":2240,"wires":[["82164ad95d19fcbf"]]},{"id":"82164ad95d19fcbf","type":"debug","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1150,"y":2240,"wires":[]},{"id":"50daefad513e6590","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"If Evening Automation is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.automation_daily_sunset","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":640,"y":1260,"wires":[["9d3441863665ba13","392103830291ac1f","83f5bdc8b93aaa05"],[]]},{"id":"c17a282f711fde5b","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"If Evening Automation is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.automation_daily_sunset","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":640,"y":660,"wires":[["37607b4f0d35d515","04bbb29df615e268","d9c0c2e3795b9980"],[]]},{"id":"d9c0c2e3795b9980","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"If Away Mode Flag is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.home_away_mode","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":640,"y":780,"wires":[["77ce70f8ea73afa1","508530b4a6242cc6","3ebc94adc32366e3","7971e1dc35e7ff5c"],[]]},{"id":"83f5bdc8b93aaa05","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"If Away Mode Flag is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.home_away_mode","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":640,"y":1380,"wires":[["8beb947db40d7699","69a9377db1fbae6d","e444dbca5dc32c07"],[]]},{"id":"e73ebd0bd5c0344b","type":"bigtimer","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","outtopic":"","outpayload1":"active","outpayload2":"inactive","name":"At 10:30 pm","comment":"","lat":"26.305080","lon":"-80.197180","starttime":"1350","endtime":"10005","starttime2":"0","endtime2":"0","startoff":"0","endoff":"0","startoff2":0,"endoff2":0,"offs":0,"outtext1":"","outtext2":"","timeout":"2","sun":true,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":true,"jan":true,"feb":true,"mar":true,"apr":true,"may":true,"jun":true,"jul":true,"aug":true,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"day6":0,"month6":0,"day7":0,"month7":0,"day8":0,"month8":0,"day9":0,"month9":0,"day10":0,"month10":0,"day11":0,"month11":0,"day12":0,"month12":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"d6":0,"w6":0,"xday1":0,"xmonth1":0,"xday2":0,"xmonth2":0,"xday3":0,"xmonth3":0,"xday4":0,"xmonth4":0,"xday5":0,"xmonth5":0,"xday6":0,"xmonth6":0,"xday7":0,"xmonth7":0,"xday8":0,"xmonth8":0,"xday9":0,"xmonth9":0,"xday10":0,"xmonth10":0,"xday11":0,"xmonth11":0,"xday12":0,"xmonth12":0,"xd1":0,"xw1":0,"xd2":0,"xw2":0,"xd3":0,"xw3":0,"xd4":0,"xw4":0,"xd5":0,"xw5":0,"xd6":0,"xw6":0,"suspend":false,"random":false,"randon1":false,"randoff1":false,"randon2":false,"randoff2":false,"repeat":true,"atstart":true,"odd":false,"even":false,"x":210,"y":1340,"wires":[["4be567938dadd156"],[],[]]},{"id":"7971e1dc35e7ff5c","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"If Flag is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.automation_daily_sunset","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":920,"y":780,"wires":[["9ad5147cd229ac8a"],[]]},{"id":"e444dbca5dc32c07","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"If Flag is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.automation_daily_sunset","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":910,"y":1380,"wires":[["7ef1a443942dbba3"],[]]},{"id":"6d15f775ebda48ae","type":"api-current-state","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"If Boolean is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.garage_left_open_snooze_today","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":580,"y":2300,"wires":[["edad0925e580072e"],[]]},{"id":"edad0925e580072e","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"Turn Garage Notification Boolean OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_off","areaId":[],"deviceId":[],"entityId":["input_boolean.garage_left_open_snooze_today"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":870,"y":2300,"wires":[["1e787fa60f2d075f"]]},{"id":"1e787fa60f2d075f","type":"debug","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1130,"y":2300,"wires":[]},{"id":"a3b250eba3c64cb3","type":"comment","z":"0e8f6b67bf5f7644","g":"8e91da327c4f467a","name":"----- Run daily, at midnight -----","info":"","x":200,"y":1960,"wires":[]},{"id":"d5ba5751b57363cc","type":"comment","z":"0e8f6b67bf5f7644","g":"2e3b23fa8bdd39e5","name":"----- Run daily, at 10:00 pm -----","info":"","x":230,"y":1640,"wires":[]},{"id":"df4ac9e5af0e8f6f","type":"comment","z":"0e8f6b67bf5f7644","g":"bcf8b42cf961c13f","name":"----- Run daily, 4 1/2 hours after sunset OR at 10:30 pm -----","info":"","x":310,"y":1100,"wires":[]},{"id":"ac8e0389514188ba","type":"comment","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"----- Run daily, 30 minutes before sunset -----","info":"","x":270,"y":500,"wires":[]},{"id":"6e0b3c1b03210e20","type":"comment","z":"0e8f6b67bf5f7644","g":"af922ec12cc24eb2","name":"----- Run daily, at sunrise. -----","info":"","x":230,"y":80,"wires":[]},{"id":"1eacbfa02a0bb6ba","type":"api-call-service","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"Turn Manual Override OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_off","areaId":[],"deviceId":[],"entityId":["input_boolean.manual_override_foyer_exterior_entryway"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1660,"y":720,"wires":[["4a5ed6e5c3b386f2"]]},{"id":"8272565b80b03049","type":"delay","z":"0e8f6b67bf5f7644","g":"97d95b79239fec91","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":1420,"y":720,"wires":[["1eacbfa02a0bb6ba"]]},{"id":"c70b6053b4d6599f","type":"inject","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"Trigger: Light ON","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"on","payloadType":"str","x":200,"y":140,"wires":[["d03975cda544a189"]]},{"id":"dc35a4cc9acaa5b9","type":"inject","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"Trigger: Light OFF","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"off","payloadType":"str","x":190,"y":180,"wires":[["6f2d85a6a54fbbee"]]},{"id":"ca467f193638218b","type":"server-state-changed","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"Foyer, Hallway","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.foyer_hallway_ceiling","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"on","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":false,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":180,"y":220,"wires":[["d03975cda544a189"],["6f2d85a6a54fbbee"]]},{"id":"515d64c86191d7de","type":"api-current-state","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_entryway_ceiling","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":660,"y":220,"wires":[["e07fc4259f7b6181"],[]]},{"id":"e07fc4259f7b6181","type":"api-call-service","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"Turn Entryway Light ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.foyer_entryway_ceiling"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":910,"y":220,"wires":[["b31402391f53f9d0"]]},{"id":"c0622123073c57a8","type":"comment","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"----- Sync Lights, In the Foyer -----","info":"","x":240,"y":80,"wires":[]},{"id":"fee91f9ed6ad470c","type":"server-state-changed","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"Foyer, Entryway","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.foyer_entryway_ceiling","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"on","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":false,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":180,"y":360,"wires":[["e8e5c0f9cf80af21"],["5d5bea5472bb3bb2"]]},{"id":"d03975cda544a189","type":"api-current-state","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"Sync Foyer Lights?","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.sync_foyer_lights","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":430,"y":220,"wires":[["515d64c86191d7de"],[]]},{"id":"6f2d85a6a54fbbee","type":"api-current-state","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"Sync Foyer Lights?","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.sync_foyer_lights","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":430,"y":280,"wires":[["1e9050d391ca7819"],[]]},{"id":"e8e5c0f9cf80af21","type":"api-current-state","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"Sync Foyer Lights?","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.sync_foyer_lights","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":430,"y":360,"wires":[["e4e06f4c1368d459"],[]]},{"id":"5d5bea5472bb3bb2","type":"api-current-state","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"Sync Foyer Lights?","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.sync_foyer_lights","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":430,"y":420,"wires":[["d7d46190450750b9"],[]]},{"id":"1e9050d391ca7819","type":"api-current-state","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_entryway_ceiling","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":650,"y":280,"wires":[["b9d89c613a1b234e"],[]]},{"id":"b9d89c613a1b234e","type":"api-call-service","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"Turn Entryway Light OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.foyer_entryway_ceiling"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":910,"y":280,"wires":[["b31402391f53f9d0"]]},{"id":"e4e06f4c1368d459","type":"api-current-state","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_hallway_ceiling","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":660,"y":360,"wires":[["37d8647648168c4d"],[]]},{"id":"d7d46190450750b9","type":"api-current-state","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_hallway_ceiling","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":650,"y":420,"wires":[["e832462b8a547483"],[]]},{"id":"e832462b8a547483","type":"api-call-service","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"Turn Hallway Light OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.foyer_hallway_ceiling"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":910,"y":420,"wires":[["f199ea158572f466"]]},{"id":"37d8647648168c4d","type":"api-call-service","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"Turn Hallway Light ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.foyer_hallway_ceiling"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":900,"y":360,"wires":[["f199ea158572f466"]]},{"id":"b31402391f53f9d0","type":"debug","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1130,"y":220,"wires":[]},{"id":"f199ea158572f466","type":"debug","z":"370eac02908e9c72","g":"367e75d2d85ed706","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1130,"y":360,"wires":[]},{"id":"994755894f9425d7","type":"api-current-state","z":"370eac02908e9c72","g":"4a7a9a56bbdb18de","name":"Get Tablet Battery Level","server":"1040bb61.673d75","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"sensor.fire_tablet_battery_level","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":490,"y":620,"wires":[["dcd72d9fbd5a63f7"]]},{"id":"8d527994334e98eb","type":"inject","z":"370eac02908e9c72","g":"4a7a9a56bbdb18de","name":"Check Every 30 Minutes","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1800","crontab":"","once":false,"onceDelay":0.1,"topic":"","payloadType":"date","x":210,"y":620,"wires":[["994755894f9425d7"]]},{"id":"dcd72d9fbd5a63f7","type":"switch","z":"370eac02908e9c72","g":"4a7a9a56bbdb18de","name":"","property":"payload","propertyType":"msg","rules":[{"t":"lte","v":"20","vt":"num"},{"t":"gte","v":"80","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":710,"y":620,"wires":[["315184c507ef5cc0"],["c94ff329760335bb"]]},{"id":"c94ff329760335bb","type":"api-current-state","z":"370eac02908e9c72","g":"4a7a9a56bbdb18de","name":"If Plug is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.tablet_plug","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":890,"y":680,"wires":[["6a488af591956051"],[]]},{"id":"6a488af591956051","type":"api-call-service","z":"370eac02908e9c72","g":"4a7a9a56bbdb18de","name":"Turn Tablet Plug OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.tablet_plug"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1120,"y":680,"wires":[["4a3cd92e09296f4f"]]},{"id":"315184c507ef5cc0","type":"api-current-state","z":"370eac02908e9c72","g":"4a7a9a56bbdb18de","name":"If Plug is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.tablet_plug","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":900,"y":620,"wires":[["a4b2a8b79f8c0173"],[]]},{"id":"a4b2a8b79f8c0173","type":"api-call-service","z":"370eac02908e9c72","g":"4a7a9a56bbdb18de","name":"Turn Tablet Plug ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.tablet_plug"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1140,"y":620,"wires":[["4a3cd92e09296f4f"]]},{"id":"f5d9c9ec46bbfb57","type":"comment","z":"370eac02908e9c72","g":"4a7a9a56bbdb18de","name":"----- Automate Tablet Plug, in the Kitchen -----","info":"","x":270,"y":560,"wires":[]},{"id":"4a3cd92e09296f4f","type":"debug","z":"370eac02908e9c72","g":"4a7a9a56bbdb18de","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1350,"y":620,"wires":[]},{"id":"141c02687d1dfafe","type":"comment","z":"370eac02908e9c72","g":"13cb201c1eaab454","name":"----- Enable Override, on Exterior Entryway Light Toggle -----","info":"","x":320,"y":820,"wires":[]},{"id":"48585d2cc85e09b9","type":"server-state-changed","z":"370eac02908e9c72","g":"13cb201c1eaab454","name":"Foyer, Exterior Entryway","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.foyer_exterior_entryway","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":210,"y":940,"wires":[["4938b8ad0de71b07"]]},{"id":"ace97b19d3dc4a64","type":"api-call-service","z":"370eac02908e9c72","g":"13cb201c1eaab454","name":"Turn Manual Override ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_on","areaId":[],"deviceId":[],"entityId":["input_boolean.manual_override_foyer_exterior_entryway"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":950,"y":940,"wires":[["04d82e625ac65894"]]},{"id":"04d82e625ac65894","type":"debug","z":"370eac02908e9c72","g":"13cb201c1eaab454","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1190,"y":940,"wires":[]},{"id":"4938b8ad0de71b07","type":"switch","z":"370eac02908e9c72","g":"13cb201c1eaab454","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":430,"y":940,"wires":[["453043f1396c7a90"],["e97cc0d5f21f8211"]]},{"id":"b9126440f312c954","type":"api-call-service","z":"370eac02908e9c72","g":"13cb201c1eaab454","name":"Turn Manual Override OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_off","areaId":[],"deviceId":[],"entityId":["input_boolean.manual_override_foyer_exterior_entryway"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":960,"y":1000,"wires":[["04d82e625ac65894"]]},{"id":"6e42e2a393c3e958","type":"inject","z":"370eac02908e9c72","g":"13cb201c1eaab454","name":"Trigger: Light ON","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"on","payloadType":"str","x":240,"y":860,"wires":[["4938b8ad0de71b07"]]},{"id":"323bf2bb26712c07","type":"inject","z":"370eac02908e9c72","g":"13cb201c1eaab454","name":"Trigger: Light OFF","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"off","payloadType":"str","x":230,"y":900,"wires":[["4938b8ad0de71b07"]]},{"id":"453043f1396c7a90","type":"api-current-state","z":"370eac02908e9c72","g":"13cb201c1eaab454","name":"If Evening Automation is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.automation_daily_sunset","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":660,"y":940,"wires":[["ace97b19d3dc4a64"],[]]},{"id":"e97cc0d5f21f8211","type":"api-current-state","z":"370eac02908e9c72","g":"13cb201c1eaab454","name":"If Evening Automation is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.automation_daily_sunset","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":660,"y":1000,"wires":[["b9126440f312c954"],[]]},{"id":"1c847a4542ba2517","type":"api-current-state","z":"a95ec654e9a3d387","g":"6eb43475c0cbaf9e","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.closet_hallway_light_t","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":660,"y":220,"wires":[["ef91789de0473a81","42ad578531c8707d"],[]]},{"id":"ef91789de0473a81","type":"api-call-service","z":"a95ec654e9a3d387","g":"6eb43475c0cbaf9e","name":"Turn Ceiling Light ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.closet_hallway_light_t"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":900,"y":160,"wires":[["2d23a7750946bc2d"]]},{"id":"e9f3e7483c18d115","type":"api-current-state","z":"a95ec654e9a3d387","g":"6eb43475c0cbaf9e","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.closet_hallway_light_t","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":670,"y":300,"wires":[["ddd8b329f4e3a961"],[]]},{"id":"ddd8b329f4e3a961","type":"api-call-service","z":"a95ec654e9a3d387","g":"6eb43475c0cbaf9e","name":"Turn Ceiling Light OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.closet_hallway_light_t"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":900,"y":300,"wires":[["2d23a7750946bc2d"]]},{"id":"7e202ccdfad1b05e","type":"inject","z":"a95ec654e9a3d387","g":"6eb43475c0cbaf9e","name":"Trigger: Door CLOSED","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"off","payloadType":"str","x":200,"y":180,"wires":[["a0c896fe6f9d5e73"]]},{"id":"d15333f5ccc06648","type":"server-state-changed","z":"a95ec654e9a3d387","g":"6eb43475c0cbaf9e","name":"His Closet Door Sensor","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.door_closet_hallway_t","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":200,"y":220,"wires":[["a0c896fe6f9d5e73"]]},{"id":"a0c896fe6f9d5e73","type":"switch","z":"a95ec654e9a3d387","g":"6eb43475c0cbaf9e","name":"Open or Closed","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":440,"y":220,"wires":[["1c847a4542ba2517"],["e9f3e7483c18d115"]]},{"id":"6e2692b464e48171","type":"inject","z":"a95ec654e9a3d387","g":"09686aa28ec76166","name":"Trigger: Door CLOSED","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"off","payloadType":"str","x":200,"y":540,"wires":[["62d3c0a6b3149a7c"]]},{"id":"62d3c0a6b3149a7c","type":"switch","z":"a95ec654e9a3d387","g":"09686aa28ec76166","name":"Open or Closed","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":440,"y":580,"wires":[["02c9c7877f7bd7c5"],["cfd5c0a89e5d590f"]]},{"id":"b08efe5d84243062","type":"server-state-changed","z":"a95ec654e9a3d387","g":"09686aa28ec76166","name":"Hers Closet Door Sensor","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.door_closet_hallway_j","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":190,"y":580,"wires":[["62d3c0a6b3149a7c"]]},{"id":"02c9c7877f7bd7c5","type":"api-current-state","z":"a95ec654e9a3d387","g":"09686aa28ec76166","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.closet_hallway_light_j","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":660,"y":580,"wires":[["3ef848920d23e01f","94f366c12ae2345d"],[]]},{"id":"cfd5c0a89e5d590f","type":"api-current-state","z":"a95ec654e9a3d387","g":"09686aa28ec76166","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.closet_hallway_light_j","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":670,"y":660,"wires":[["4639f3deaa4ba71c"],[]]},{"id":"3ef848920d23e01f","type":"api-call-service","z":"a95ec654e9a3d387","g":"09686aa28ec76166","name":"Turn Ceiling Light ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.closet_hallway_light_j"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":900,"y":520,"wires":[["ffccc618fbd95dcf"]]},{"id":"4639f3deaa4ba71c","type":"api-call-service","z":"a95ec654e9a3d387","g":"09686aa28ec76166","name":"Turn Ceiling Light OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.closet_hallway_light_j"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":900,"y":660,"wires":[["ffccc618fbd95dcf"]]},{"id":"ffccc618fbd95dcf","type":"debug","z":"a95ec654e9a3d387","g":"09686aa28ec76166","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1110,"y":580,"wires":[]},{"id":"17ad99136b4197a1","type":"inject","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"Trigger: Door CLOSED","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"off","payloadType":"str","x":200,"y":900,"wires":[["21801c8f5b05bbeb"]]},{"id":"21801c8f5b05bbeb","type":"switch","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"Open or Closed","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":400,"y":940,"wires":[["e383ad20283ccd96","d105d1df17b7b199"],["70edd8b188ca85ad","b18a99e3215ce7a9"]]},{"id":"44467fe5ac8839e9","type":"server-state-changed","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"Door Sensor","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.door_bedroom_4","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":170,"y":940,"wires":[["21801c8f5b05bbeb"]]},{"id":"e383ad20283ccd96","type":"api-current-state","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"If Lightstrip is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_4_lightstrip","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":630,"y":960,"wires":[["5daf96868aba87cc"],[]]},{"id":"70edd8b188ca85ad","type":"api-current-state","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"If Desk Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_4_desk_lamp","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":630,"y":1040,"wires":[["4d811e4669d588c1"],[]]},{"id":"5daf96868aba87cc","type":"api-call-service","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"Turn Lightstrip ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_lightstrip"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":870,"y":960,"wires":[["0961568796c4d8d0"]]},{"id":"4d811e4669d588c1","type":"api-call-service","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"Turn Desk Light OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_desk_lamp"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":880,"y":1040,"wires":[["d721ce3bd6206ce3"]]},{"id":"d721ce3bd6206ce3","type":"debug","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1090,"y":1040,"wires":[]},{"id":"d105d1df17b7b199","type":"api-current-state","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"If Desk Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_4_desk_lamp","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":630,"y":900,"wires":[["b4fb0ad9bfb713c4"],[]]},{"id":"b4fb0ad9bfb713c4","type":"api-call-service","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"Turn Desk Light ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_desk_lamp"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":870,"y":900,"wires":[["0961568796c4d8d0"]]},{"id":"b18a99e3215ce7a9","type":"api-current-state","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"If Lightstrip is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_4_lightstrip","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":630,"y":1100,"wires":[["4db84ce07de49276"],[]]},{"id":"4db84ce07de49276","type":"api-call-service","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"Turn Lightstrip OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_lightstrip"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":870,"y":1100,"wires":[["d721ce3bd6206ce3"]]},{"id":"d2b33d4a909a0a46","type":"inject","z":"a95ec654e9a3d387","g":"2ef23d258e2908a5","name":"Trigger: Door CLOSED","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"off","payloadType":"str","x":200,"y":1340,"wires":[["55511dc777b8bc3a"]]},{"id":"55511dc777b8bc3a","type":"switch","z":"a95ec654e9a3d387","g":"2ef23d258e2908a5","name":"Open or Closed","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":440,"y":1380,"wires":[["c367a2a0e26fd211"],[]]},{"id":"04478b2b3f8ba6c4","type":"server-state-changed","z":"a95ec654e9a3d387","g":"2ef23d258e2908a5","name":"Door Sensor","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.door_living","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":230,"y":1380,"wires":[["55511dc777b8bc3a"]]},{"id":"fab252dc566fd69f","type":"api-current-state","z":"a95ec654e9a3d387","g":"2ef23d258e2908a5","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.backyard_string_lights","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1220,"y":1380,"wires":[["96a6be7a7bdad98a"],[]]},{"id":"96a6be7a7bdad98a","type":"api-call-service","z":"a95ec654e9a3d387","g":"2ef23d258e2908a5","name":"Turn Backyard Lights ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"switch","service":"turn_on","areaId":[],"deviceId":[],"entityId":["switch.backyard_string_lights"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1470,"y":1380,"wires":[["95fd9e323278f51b"]]},{"id":"10fb8e3957dae1b8","type":"api-call-service","z":"a95ec654e9a3d387","g":"2ef23d258e2908a5","name":"Turn Backyard Lights OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"switch","service":"turn_off","areaId":[],"deviceId":[],"entityId":["switch.backyard_string_lights"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":2180,"y":1380,"wires":[["6ae3bfdbf1d8b22a"]]},{"id":"4176d3096e74d1b3","type":"inject","z":"a95ec654e9a3d387","g":"6c9abf623b0a916b","name":"Trigger: Door CLOSED","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"off","payloadType":"str","x":200,"y":1740,"wires":[["0419deb2604ded4e"]]},{"id":"0419deb2604ded4e","type":"switch","z":"a95ec654e9a3d387","g":"6c9abf623b0a916b","name":"Open or Closed","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":400,"y":1780,"wires":[["bfd7f3089fe57cd9"],["6ae6f746e7a16ed2"]]},{"id":"1fe2909fe5562946","type":"server-state-changed","z":"a95ec654e9a3d387","g":"6c9abf623b0a916b","name":"Door Sensor","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.door_laundry","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":false,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":170,"y":1780,"wires":[["0419deb2604ded4e"]]},{"id":"bfd7f3089fe57cd9","type":"api-current-state","z":"a95ec654e9a3d387","g":"6c9abf623b0a916b","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.laundry_ceiling_light","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":620,"y":1740,"wires":[["6b05354a13d1ee5f"],[]]},{"id":"106add1242e5743b","type":"api-current-state","z":"a95ec654e9a3d387","g":"6c9abf623b0a916b","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.laundry_ceiling_light","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":790,"y":1820,"wires":[["b4d9116fa41904ef"],[]]},{"id":"6b05354a13d1ee5f","type":"api-call-service","z":"a95ec654e9a3d387","g":"6c9abf623b0a916b","name":"Turn Ceiling Light ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.laundry_ceiling_light"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":860,"y":1740,"wires":[["6768dd61bf1cd6cb"]]},{"id":"b4d9116fa41904ef","type":"api-call-service","z":"a95ec654e9a3d387","g":"6c9abf623b0a916b","name":"Turn Ceiling Light OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.laundry_ceiling_light"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1020,"y":1820,"wires":[["7d9709d3259ee1a6"]]},{"id":"7d9709d3259ee1a6","type":"debug","z":"a95ec654e9a3d387","g":"6c9abf623b0a916b","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1230,"y":1820,"wires":[]},{"id":"6ae6f746e7a16ed2","type":"delay","z":"a95ec654e9a3d387","g":"6c9abf623b0a916b","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":600,"y":1820,"wires":[["106add1242e5743b"]]},{"id":"f3b33899ef94e86c","type":"comment","z":"a95ec654e9a3d387","g":"6eb43475c0cbaf9e","name":"----- Toggle Light, on His Closet Door Action -----","info":"","x":280,"y":80,"wires":[]},{"id":"c48c1d94ee6a6711","type":"comment","z":"a95ec654e9a3d387","g":"09686aa28ec76166","name":"----- Toggle Light, on Her Closet Door Action -----","info":"","x":290,"y":440,"wires":[]},{"id":"21107ebe8dd9c18e","type":"comment","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"----- Toggle Lights, on Bedroom 3 Door Action -----","info":"","x":290,"y":800,"wires":[]},{"id":"c375aba6238b4590","type":"comment","z":"a95ec654e9a3d387","g":"2ef23d258e2908a5","name":"----- Toggle Light, on Living Room Sliding Door Action or Timeout -----","info":"","x":350,"y":1240,"wires":[]},{"id":"4f8bd1dd7d308b46","type":"comment","z":"a95ec654e9a3d387","g":"6c9abf623b0a916b","name":"----- Toggle Light, on Laundry Room Door Action -----","info":"","x":300,"y":1640,"wires":[]},{"id":"c367a2a0e26fd211","type":"time-range-switch","z":"a95ec654e9a3d387","g":"2ef23d258e2908a5","name":"","lat":"26.305080","lon":"-80.197180","startTime":"sunset","endTime":"sunrise","startOffset":"-30","endOffset":"+30","x":660,"y":1380,"wires":[["ef376d85a3136f21"],[]]},{"id":"6ae3bfdbf1d8b22a","type":"debug","z":"a95ec654e9a3d387","g":"2ef23d258e2908a5","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2410,"y":1380,"wires":[]},{"id":"2d23a7750946bc2d","type":"debug","z":"a95ec654e9a3d387","g":"6eb43475c0cbaf9e","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1110,"y":220,"wires":[]},{"id":"0961568796c4d8d0","type":"debug","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1070,"y":900,"wires":[]},{"id":"6768dd61bf1cd6cb","type":"debug","z":"a95ec654e9a3d387","g":"6c9abf623b0a916b","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1070,"y":1740,"wires":[]},{"id":"e36723d0dfbe9e9b","type":"inject","z":"a95ec654e9a3d387","g":"6eb43475c0cbaf9e","name":"Trigger: Door OPEN","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"on","payloadType":"str","x":210,"y":140,"wires":[["a0c896fe6f9d5e73"]]},{"id":"91807a1772f7a7a2","type":"inject","z":"a95ec654e9a3d387","g":"09686aa28ec76166","name":"Trigger: Door OPEN","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"on","payloadType":"str","x":210,"y":500,"wires":[["62d3c0a6b3149a7c"]]},{"id":"8669b6b9606d216c","type":"inject","z":"a95ec654e9a3d387","g":"90b28685286b5c32","name":"Trigger: Door OPEN","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"on","payloadType":"str","x":210,"y":860,"wires":[["21801c8f5b05bbeb"]]},{"id":"0877b98de68e358f","type":"inject","z":"a95ec654e9a3d387","g":"2ef23d258e2908a5","name":"Trigger: Door OPEN","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"on","payloadType":"str","x":210,"y":1300,"wires":[["55511dc777b8bc3a"]]},{"id":"c1a45add8f9cb37c","type":"inject","z":"a95ec654e9a3d387","g":"6c9abf623b0a916b","name":"Trigger: Door OPEN","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"on","payloadType":"str","x":210,"y":1700,"wires":[["0419deb2604ded4e"]]},{"id":"ef376d85a3136f21","type":"api-current-state","z":"a95ec654e9a3d387","g":"2ef23d258e2908a5","name":"If Evening Automation Flag is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.automation_daily_sunset","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":940,"y":1380,"wires":[["fab252dc566fd69f"],[]]},{"id":"95fd9e323278f51b","type":"stoptimer","z":"a95ec654e9a3d387","g":"2ef23d258e2908a5","duration":"20","units":"Minute","payloadtype":"num","payloadval":"0","name":"","x":1720,"y":1380,"wires":[["98af20ded667f694"],[]]},{"id":"98af20ded667f694","type":"api-current-state","z":"a95ec654e9a3d387","g":"2ef23d258e2908a5","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"switch.backyard_string_lights","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1930,"y":1380,"wires":[["10fb8e3957dae1b8"],[]]},{"id":"d1eeab16.e941f8","type":"ha-wait-until","z":"a95ec654e9a3d387","name":"","server":"1040bb61.673d75","version":1,"outputs":2,"entityId":"{{topic}}","entityIdFilterType":"exact","property":"state","comparator":"is","value":"off","valueType":"str","timeout":"10","timeoutType":"num","timeoutUnits":"minutes","entityLocation":"","entityLocationType":"none","checkCurrentState":true,"blockInputOverrides":true,"x":420,"y":1460,"wires":[["303ca9bd.bc2bf6"],[]]},{"id":"ca4fa032.0eb8a","type":"api-call-service","z":"a95ec654e9a3d387","name":"Turn Thermostat OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"climate","service":"turn_off","areaId":[],"deviceId":[],"entityId":["climate.ecobee"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":900,"y":1460,"wires":[[]]},{"id":"978417b1.11f808","type":"ha-wait-until","z":"a95ec654e9a3d387","name":"","server":"1040bb61.673d75","version":1,"outputs":2,"entityId":"{{topic}}","entityIdFilterType":"exact","property":"state","comparator":"is","value":"on","valueType":"str","timeout":"10","timeoutType":"num","timeoutUnits":"minutes","entityLocation":"","entityLocationType":"none","checkCurrentState":true,"blockInputOverrides":true,"x":860,"y":1520,"wires":[["cce7562e.2b6698"],[]]},{"id":"cce7562e.2b6698","type":"api-call-service","z":"a95ec654e9a3d387","name":"Turn Thermostat ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"climate","service":"set_hvac_mode","areaId":[],"deviceId":[],"entityId":["climate.ecobee"],"data":"{\"climate_mode\": \"{{thermostat}}\"}","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1080,"y":1520,"wires":[[]]},{"id":"303ca9bd.bc2bf6","type":"api-current-state","z":"a95ec654e9a3d387","name":"Save Thermostat State","server":"1040bb61.673d75","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"climate.ecobee","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"thermostat","propertyType":"msg","value":"","valueType":"entityState"}],"for":0,"forType":"num","forUnits":"minutes","x":640,"y":1460,"wires":[["ca4fa032.0eb8a","978417b1.11f808"]]},{"id":"fed99827.329118","type":"trigger-state","z":"a95ec654e9a3d387","d":true,"name":"Door Sensor","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"binary_sensor.door_living","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"},{"targetType":"entity_id","targetValue":"climate.ecobee","propertyType":"current_state","comparatorType":"is_not","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"new_state.state"}],"inputs":1,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":true,"x":230,"y":1460,"wires":[["d1eeab16.e941f8"],[]]},{"id":"42ad578531c8707d","type":"stoptimer","z":"a95ec654e9a3d387","g":"6eb43475c0cbaf9e","duration":"10","units":"Minute","payloadtype":"num","payloadval":"0","name":"","x":880,"y":220,"wires":[["2d23a7750946bc2d","e9f3e7483c18d115"],[]]},{"id":"94f366c12ae2345d","type":"stoptimer","z":"a95ec654e9a3d387","g":"09686aa28ec76166","duration":"10","units":"Minute","payloadtype":"num","payloadval":"0","name":"","x":880,"y":580,"wires":[["ffccc618fbd95dcf","cfd5c0a89e5d590f"],[]]},{"id":"6e95ceae462da943","type":"server-state-changed","z":"ccf4e5eced60ee19","g":"1f3f56a64bdf7245","name":"Motion Sensor","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.motion_laundry","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":240,"y":960,"wires":[["e679bdef811d07af"]]},{"id":"e679bdef811d07af","type":"api-current-state","z":"ccf4e5eced60ee19","g":"1f3f56a64bdf7245","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.laundry_ceiling_light","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":460,"y":960,"wires":[["5bbfae9781c64ed1"],[]]},{"id":"cd064c4e352ad592","type":"api-current-state","z":"ccf4e5eced60ee19","g":"1f3f56a64bdf7245","name":"If Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.laundry_ceiling_light","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":470,"y":1100,"wires":[["a6fafb1aaff116e8"],[]]},{"id":"5bbfae9781c64ed1","type":"api-call-service","z":"ccf4e5eced60ee19","g":"1f3f56a64bdf7245","name":"Turn Ceiling Light ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.laundry_ceiling_light"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":700,"y":960,"wires":[["184d75c4d4c87969"]]},{"id":"19a28fbde3c46587","type":"debug","z":"ccf4e5eced60ee19","g":"1f3f56a64bdf7245","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":910,"y":1100,"wires":[]},{"id":"a6fafb1aaff116e8","type":"api-call-service","z":"ccf4e5eced60ee19","g":"1f3f56a64bdf7245","name":"Turn Ceiling Light OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.laundry_ceiling_light"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":700,"y":1100,"wires":[["19a28fbde3c46587"]]},{"id":"72cbdf5001a79ab4","type":"comment","z":"ccf4e5eced60ee19","g":"1f3f56a64bdf7245","name":"----- Toggle Light, on Laundry Room Motion Action -----","info":"","x":310,"y":840,"wires":[]},{"id":"3cc73458ada50437","type":"server-state-changed","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"Motion Sensor","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.foyer_doorbell_motion","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":220,"y":620,"wires":[["6b7b3dea72c4a498"]]},{"id":"6b7b3dea72c4a498","type":"time-range-switch","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"","lat":"26.305080","lon":"-80.197180","startTime":"sunset","endTime":"sunrise","startOffset":"+270","endOffset":"0","x":440,"y":620,"wires":[["6c94fd1427d21d53"],[]]},{"id":"813c6b4b26caebac","type":"api-current-state","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_exterior_entryway","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1180,"y":580,"wires":[["35144f3b54e1eb38"],[]]},{"id":"35144f3b54e1eb38","type":"api-call-service","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"Turn Foyer Exterior Light ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.foyer_exterior_entryway"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1440,"y":580,"wires":[["dd69428319a5c6d4"]]},{"id":"bf86bf1f40773cb9","type":"comment","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"----- Toggle Light, on Evening Foyer Entryway Motion Action -----","info":"","x":330,"y":460,"wires":[]},{"id":"184d75c4d4c87969","type":"debug","z":"ccf4e5eced60ee19","g":"1f3f56a64bdf7245","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":910,"y":960,"wires":[]},{"id":"2a9db556fe75a53e","type":"switch","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"On or Off","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":980,"y":620,"wires":[["813c6b4b26caebac"],["a3917d33848d267a"]]},{"id":"eba66ecd4c9de23d","type":"inject","z":"ccf4e5eced60ee19","g":"1f3f56a64bdf7245","name":"Trigger: Motion START","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"on","payloadType":"str","x":220,"y":900,"wires":[["e679bdef811d07af"]]},{"id":"2d34c7e53a7719d9","type":"inject","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"Trigger: Motion START","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"on","payloadType":"str","x":200,"y":520,"wires":[["2a9db556fe75a53e"]]},{"id":"dd69428319a5c6d4","type":"debug","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1670,"y":580,"wires":[]},{"id":"deb9982ce6da6405","type":"trigger-state","z":"ccf4e5eced60ee19","g":"babed62518ff1825","name":"Residents Arrive Home","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"group.residents","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","propertyValue":"old_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"not_home"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","propertyValue":"new_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"home"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":180,"y":1360,"wires":[["592b1510af2557a0"],[]]},{"id":"592b1510af2557a0","type":"time-range-switch","z":"ccf4e5eced60ee19","g":"babed62518ff1825","name":"","lat":"26.305080","lon":"-80.197180","startTime":"sunset","endTime":"sunrise","startOffset":"-30","endOffset":"+30","x":420,"y":1360,"wires":[["7251a67d88a0352f","88b0462386162524"],[]]},{"id":"7251a67d88a0352f","type":"api-current-state","z":"ccf4e5eced60ee19","g":"babed62518ff1825","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_ceiling_ledge","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":640,"y":1360,"wires":[["4b31058af4d10e03"],[]]},{"id":"88b0462386162524","type":"api-current-state","z":"ccf4e5eced60ee19","g":"babed62518ff1825","name":"If Light is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_1_bedside_lamps","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":640,"y":1420,"wires":[["0aeff1a50e52889a"],[]]},{"id":"4b31058af4d10e03","type":"api-call-service","z":"ccf4e5eced60ee19","g":"babed62518ff1825","name":"Turn Foyer Ceiling Ledge Light ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.foyer_ceiling_ledge"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":920,"y":1360,"wires":[["a705f00b0dbe73b5"]]},{"id":"0aeff1a50e52889a","type":"api-call-service","z":"ccf4e5eced60ee19","g":"babed62518ff1825","name":"Turn Main Bedroom Bedside Lights ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_1_bedside_lamps"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":940,"y":1420,"wires":[["f9d8b6613d08ac34"]]},{"id":"a705f00b0dbe73b5","type":"debug","z":"ccf4e5eced60ee19","g":"babed62518ff1825","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1170,"y":1360,"wires":[]},{"id":"f9d8b6613d08ac34","type":"debug","z":"ccf4e5eced60ee19","g":"babed62518ff1825","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1210,"y":1420,"wires":[]},{"id":"886d3b36ab1636e9","type":"comment","z":"ccf4e5eced60ee19","g":"babed62518ff1825","name":"----- Toggle Lights, on Evening Arriving Home -----","info":"","x":290,"y":1240,"wires":[]},{"id":"b8626ff9ac46f637","type":"inject","z":"ccf4e5eced60ee19","g":"babed62518ff1825","name":"Trigger: ARRIVAL","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"home","payloadType":"str","x":200,"y":1300,"wires":[["592b1510af2557a0"]]},{"id":"6c94fd1427d21d53","type":"api-current-state","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"If Evening Automation Flag OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.automation_daily_sunset","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":710,"y":620,"wires":[["66acd1847becf796"],[]]},{"id":"16c1d615caad2d2a","type":"server-state-changed","z":"ccf4e5eced60ee19","g":"1f3f56a64bdf7245","name":"Motion Sensor OFF, for 30s","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.motion_laundry","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"off","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"30","forType":"num","forUnits":"seconds","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":200,"y":1100,"wires":[["cd064c4e352ad592"],[]]},{"id":"b73b70a08481ad81","type":"api-current-state","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"If Motion is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"binary_sensor.foyer_doorbell_motion","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1400,"y":640,"wires":[["8c18b33da463a312"],[]]},{"id":"8c18b33da463a312","type":"api-call-service","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"Turn Foyer Exterior Light OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.foyer_exterior_entryway"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1670,"y":640,"wires":[["18a2e9166694fb0c"]]},{"id":"18a2e9166694fb0c","type":"debug","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1910,"y":640,"wires":[]},{"id":"a3917d33848d267a","type":"stoptimer","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","duration":"3","units":"Minute","payloadtype":"num","payloadval":"0","name":"","x":1180,"y":640,"wires":[["b73b70a08481ad81"],[]]},{"id":"d748f5671dfa2342","type":"inject","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"Trigger: Motion STOP","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"off","payloadType":"str","x":200,"y":560,"wires":[["2a9db556fe75a53e"]]},{"id":"7cf4574ac749e3ee","type":"inject","z":"ccf4e5eced60ee19","g":"1f3f56a64bdf7245","name":"Trigger: Motion STOP","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"off","payloadType":"str","x":220,"y":1040,"wires":[["cd064c4e352ad592"]]},{"id":"530882536988219d","type":"ha-zone","z":"ccf4e5eced60ee19","g":"babed62518ff1825","name":"Tom Arrives at Regency","server":"1040bb61.673d75","version":0,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entities":["person.thomas"],"event":"enter","zones":["zone.regency_lakes"],"x":180,"y":1440,"wires":[["f492ca33661c8df8"]]},{"id":"f492ca33661c8df8","type":"delay","z":"ccf4e5eced60ee19","g":"babed62518ff1825","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":400,"y":1440,"wires":[[]]},{"id":"891e0a6331a6d3ee","type":"comment","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"----- Motion Detected at Front Door, Send Notification with Image -----","info":"","x":350,"y":80,"wires":[]},{"id":"d8568999abeae0c5","type":"inject","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"Trigger: Motion START","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"on","payloadType":"str","x":200,"y":140,"wires":[["a3969ac01df45fed"]]},{"id":"49caf1957641923a","type":"api-current-state","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"Timer Not Snoozed?","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"idle","halt_if_type":"str","halt_if_compare":"is","entity_id":"timer.doorbell_motion_snooze","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":860,"y":160,"wires":[["5aa651de1c7f8f73"],[]]},{"id":"c84665cc506cc72a","type":"trigger-state","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"Motion Sensor","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"binary_sensor.foyer_doorbell_motion","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","propertyValue":"old_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","propertyValue":"new_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":220,"y":240,"wires":[["a3969ac01df45fed"],[]]},{"id":"b551f8302ee60639","type":"api-call-service","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"Take snapshot","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"camera","service":"snapshot","areaId":[],"deviceId":[],"entityId":["camera.foyer_doorbell_high"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1340,"y":240,"wires":[["9983291167b2f4d5"]]},{"id":"9983291167b2f4d5","type":"delay","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"","pauseType":"delay","timeout":"750","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":1550,"y":240,"wires":[[]]},{"id":"f38856448387560f","type":"function","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"Prepare iOS Notification","func":"msg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : \"There is motion at the Front Door\",\n        \"data\"    : {\n            \"subtitle\" : false,\n    \t\t\"image\"    : msg.snapshot,\n    \t\t\"actions\"  : [\n                { \n                    action : \"DOORBELL_SNOOZE_A\",\n                    title  : \"Snooze: 30 Minutes\"\n                }, \n                { \n                    action : \"DOORBELL_SNOOZE_B\",\n                    title  : \"Snooze: 1 Hour\"\n                }, \n                { \n                    action : \"DOORBELL_SNOOZE_C\",\n                    title  : \"Snooze: Today\"\n                }, \n                { \n                    action : \"DOORBELL_SNOOZE_D\",\n                    title  : \"Snooze: Indefinite\"\n                }\n            ]\n        }\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1590,"y":320,"wires":[["2bd12a1dd8e20657"]]},{"id":"2bd12a1dd8e20657","type":"link out","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"Motion at Frontdoor, Send Notification with Snapshot","mode":"link","links":["b5bf4f1d2a2db4f8","eb19baaad61d9a94"],"x":1715,"y":240,"wires":[]},{"id":"9695c9861fe197a3","type":"function","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"Setup Snapshot","func":"const timestamp = new Date().toISOString();\n\nconst snapshot_file = \"doorbell-motion-\" + timestamp + \".jpg\";\n\nmsg.snapshot = \"/local/snapshots/\" + snapshot_file;\n\nmsg.payload = {\n    data : {\n        \"filename\" : \"/config/www/snapshots/\" + snapshot_file\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1120,"y":320,"wires":[["b551f8302ee60639"]]},{"id":"5aa651de1c7f8f73","type":"api-current-state","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"Is Snoozed for Today?","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.doorbell_motion_snooze_today","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":860,"y":240,"wires":[[],["e97f90c8b6b8e055"]]},{"id":"e97f90c8b6b8e055","type":"api-current-state","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"Is Snoozed Indefinitely?","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.doorbell_motion_snooze_indefinite","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":870,"y":320,"wires":[[],["57e784ddeb4dd9f7"]]},{"id":"a3969ac01df45fed","type":"switch","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"ON or OFF","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"},{"t":"eq","v":"","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":430,"y":240,"wires":[["2e59f659b453aacb"],[],[]]},{"id":"57e784ddeb4dd9f7","type":"delay","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"allowrate":false,"outputs":1,"x":1110,"y":240,"wires":[["9695c9861fe197a3"]]},{"id":"2e59f659b453aacb","type":"delay","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"","pauseType":"delay","timeout":"2","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":620,"y":240,"wires":[["49caf1957641923a"]]},{"id":"66acd1847becf796","type":"api-current-state","z":"ccf4e5eced60ee19","g":"ac97a59aa0e054c4","name":"If Manual Override is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.manual_override_foyer_exterior_entryway","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":730,"y":700,"wires":[["2a9db556fe75a53e"],[]]},{"id":"5babcb06c7a4798c","type":"inject","z":"ccf4e5eced60ee19","g":"6f4459aaf422d31f","name":"Trigger: Motion STOP","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"off","payloadType":"str","x":200,"y":180,"wires":[["a3969ac01df45fed"]]},{"id":"bc55baeed9cde3d9","type":"comment","z":"75bda675505dd534","name":"----- IKEA Switch Button Press -----","info":"","x":200,"y":1700,"wires":[]},{"id":"2f432fce62092e59","type":"server-events","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"ZHA Event","server":"1040bb61.673d75","version":1,"event_type":"zha_event","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"},{"property":"event_type","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"}],"x":140,"y":460,"wires":[["ecaedb0332a56a66"]]},{"id":"ecaedb0332a56a66","type":"switch","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"Button","property":"payload.event.device_id","propertyType":"msg","rules":[{"t":"cont","v":"6e0d3bc392786ae305590c266ad4545a","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":130,"y":540,"wires":[["f3677166f9d4bf1f"]]},{"id":"f3677166f9d4bf1f","type":"switch","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"Button Routing","property":"payload.event.command","propertyType":"msg","rules":[{"t":"eq","v":"single","vt":"str"},{"t":"eq","v":"double","vt":"str"},{"t":"eq","v":"hold","vt":"str"},{"t":"eq","v":"release","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":320,"y":540,"wires":[["3edc04d189e93f7a"],["29000e8ed5d4d341"],["53629c3fbf37b8d9"],["6597a7f5542b62ca"]]},{"id":"3edc04d189e93f7a","type":"api-current-state","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"If Desk Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_4_desk_lamp","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":550,"y":460,"wires":[["3fdb42b5e9184596"],["0312c7401aa0e5d9"]]},{"id":"0312c7401aa0e5d9","type":"api-call-service","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"Turn Desk Light ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_desk_lamp"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":770,"y":520,"wires":[["adea0d6c350bdcaa"]]},{"id":"3fdb42b5e9184596","type":"api-call-service","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"Turn Desk Light OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_desk_lamp"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":780,"y":460,"wires":[["adea0d6c350bdcaa"]]},{"id":"29000e8ed5d4d341","type":"api-current-state","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"If Lightstrip is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_4_lightstrip","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":550,"y":580,"wires":[["fc1689bc6dcb068f"],["91ddff38f9f28f0e"]]},{"id":"fc1689bc6dcb068f","type":"api-call-service","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"Turn Lightstrip OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_lightstrip"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":770,"y":580,"wires":[["191741edefbc2879"]]},{"id":"91ddff38f9f28f0e","type":"api-call-service","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"Turn Lightstrip ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_lightstrip"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":770,"y":640,"wires":[["191741edefbc2879"]]},{"id":"adea0d6c350bdcaa","type":"debug","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":990,"y":460,"wires":[]},{"id":"f478cc2ddd156832","type":"switch","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"Button","property":"payload.event.device_id","propertyType":"msg","rules":[{"t":"cont","v":"77041364a8b0840358010d8d5cc562f4","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":130,"y":1040,"wires":[["aa395cef7eb28827"]]},{"id":"aa395cef7eb28827","type":"switch","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"Button Routing","property":"payload.event.command","propertyType":"msg","rules":[{"t":"eq","v":"single","vt":"str"},{"t":"eq","v":"double","vt":"str"},{"t":"eq","v":"hold","vt":"str"},{"t":"eq","v":"release","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":320,"y":1040,"wires":[["0c8aebd6101ee42a"],["4e657bd12f3da99e"],["2343f16b29502fdb"],["804006fe20f4ab7b"]]},{"id":"0c8aebd6101ee42a","type":"api-current-state","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"If Ceiling Ledge is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_ceiling_ledge","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":560,"y":980,"wires":[["bca1cbf60fec6762"],["a4d93a3fba41f377"]]},{"id":"4e657bd12f3da99e","type":"api-current-state","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"If Under Table Lightstrip is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_under_table","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":590,"y":1100,"wires":[["80c1fab30b054d93"],["1ede4d1e655b7797"]]},{"id":"bca1cbf60fec6762","type":"api-call-service","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"Turn Ceiling Ledge OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.foyer_ceiling_ledge"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":830,"y":980,"wires":[["541f985126d20172"]]},{"id":"a4d93a3fba41f377","type":"api-call-service","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"Turn Ceiling Ledge ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.foyer_ceiling_ledge"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":820,"y":1040,"wires":[["541f985126d20172"]]},{"id":"80c1fab30b054d93","type":"api-call-service","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"Turn Under Table Lightstrip OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.foyer_under_table"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":910,"y":1100,"wires":[["43099f1c296af873"]]},{"id":"1ede4d1e655b7797","type":"api-call-service","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"Turn Under Table Lightstrip ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.foyer_under_table"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":910,"y":1160,"wires":[["43099f1c296af873"]]},{"id":"541f985126d20172","type":"debug","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1050,"y":980,"wires":[]},{"id":"43099f1c296af873","type":"debug","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1150,"y":1100,"wires":[]},{"id":"0e0b319d3521efee","type":"api-current-state","z":"75bda675505dd534","g":"0b05817bb4d42102","name":"If Garage Door is CLOSED","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"closed","halt_if_type":"str","halt_if_compare":"is","entity_id":"cover.garage_door","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":580,"y":1520,"wires":[["3f4b62c2ba6c794c"],[]]},{"id":"4015279ee4d1fd11","type":"api-current-state","z":"75bda675505dd534","g":"0b05817bb4d42102","name":"If Garage Door is OPEN","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"open","halt_if_type":"str","halt_if_compare":"includes","entity_id":"cover.garage_door","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":570,"y":1580,"wires":[["16191e38c834bdf9"],[]]},{"id":"3f4b62c2ba6c794c","type":"api-call-service","z":"75bda675505dd534","g":"0b05817bb4d42102","name":"Make Garage Door OPEN","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"cover","service":"open_cover","areaId":[],"deviceId":[],"entityId":["cover.garage_door"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":870,"y":1520,"wires":[["cb339aea427179e6"]]},{"id":"16191e38c834bdf9","type":"api-call-service","z":"75bda675505dd534","g":"0b05817bb4d42102","name":"Make Garage Door CLOSE","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"cover","service":"close_cover","areaId":[],"deviceId":[],"entityId":["cover.garage_door"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":860,"y":1580,"wires":[["cb339aea427179e6"]]},{"id":"cb339aea427179e6","type":"debug","z":"75bda675505dd534","g":"0b05817bb4d42102","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1090,"y":1520,"wires":[]},{"id":"5621e03b3e92343a","type":"api-current-state","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"If Desk Light is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_4_desk_lamp","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":770,"y":700,"wires":[["c50afa0cb006d3a5"],["18a229de6692d719"]]},{"id":"17e4204a617c9394","type":"debug","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1790,"y":700,"wires":[]},{"id":"c50afa0cb006d3a5","type":"function","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"Get New Brightness Level","func":"var brightness = msg.data.attributes.brightness;\nconst brightness_min = 25;  // Do not make less than 1 (2.55%)\nconst brightness_max = 255; // Do not make greater than 255 (100%)\nconst brightness_step = 25;\n\nbrightness = parseInt( brightness );\n\nbrightness = Math.ceil( brightness + brightness_step );\n\n\nif( brightness < brightness_min )\n{ \n    brightness = brightness_max;\n\n} else if( brightness > brightness_max )\n{ \n    brightness = brightness_min;\n\n} // endif\n\nmsg.payload = brightness;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1270,"y":700,"wires":[["374b4d878013dcbf","0e97fb0b2de1df97"]]},{"id":"374b4d878013dcbf","type":"api-call-service","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"Adjust Desk Light Brightness","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_desk_lamp"],"data":"{ \"entity_id\":\"light.bedroom_4_desk_lamp\", \"brightness\":{{payload}} }","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1560,"y":700,"wires":[["17e4204a617c9394"]]},{"id":"53629c3fbf37b8d9","type":"trigger","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-1","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":540,"y":700,"wires":[["5621e03b3e92343a"]]},{"id":"6597a7f5542b62ca","type":"change","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":760,"wires":[["53629c3fbf37b8d9"]]},{"id":"8b0413d1be866efc","type":"server-events","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"ZHA Event","server":"1040bb61.673d75","version":1,"event_type":"zha_event","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"},{"property":"event_type","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"}],"x":140,"y":960,"wires":[["f478cc2ddd156832"]]},{"id":"6971f02eb5529462","type":"switch","z":"75bda675505dd534","g":"0b05817bb4d42102","name":"Button Routing","property":"payload.event.command","propertyType":"msg","rules":[{"t":"eq","v":"single","vt":"str"},{"t":"eq","v":"double","vt":"str"},{"t":"eq","v":"hold","vt":"str"},{"t":"eq","v":"release","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":320,"y":1560,"wires":[["0e0b319d3521efee"],["4015279ee4d1fd11"],[],[]]},{"id":"52d9e3956a90fe44","type":"switch","z":"75bda675505dd534","g":"0b05817bb4d42102","name":"Button","property":"payload.event.device_id","propertyType":"msg","rules":[{"t":"cont","v":"58c0784c57aa8985f53c66f355f6902f","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":130,"y":1560,"wires":[["6971f02eb5529462"]]},{"id":"b489e401f64c6561","type":"server-events","z":"75bda675505dd534","g":"0b05817bb4d42102","name":"ZHA Event","server":"1040bb61.673d75","version":1,"event_type":"zha_event","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"},{"property":"event_type","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"}],"x":140,"y":1480,"wires":[["52d9e3956a90fe44"]]},{"id":"0e97fb0b2de1df97","type":"api-call-service","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"Adjust Lightstrip Brightness","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_desk_lamp"],"data":"{ \"entity_id\":\"light.bedroom_4_lightstrip\", \"brightness\":{{payload}} }","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1560,"y":740,"wires":[["17e4204a617c9394"]]},{"id":"1a9e5b3d723fd043","type":"api-call-service","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"Adjust Ceiling Ledge Brightness","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.foyer_ceiling_ledge"],"data":"{ \"entity_id\":\"light.foyer_ceiling_ledge\", \"brightness\":{{payload}} }","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1610,"y":1220,"wires":[["49f92784cf7a09aa"]]},{"id":"3f9b5f430db4660b","type":"function","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"Get New Brightness Level","func":"var brightness = msg.data.attributes.brightness;\nconst brightness_min = 25;  // Do not make less than 1 (2.55%)\nconst brightness_max = 255; // Do not make greater than 255 (100%)\nconst brightness_step = 25;\n\nbrightness = parseInt( brightness );\n\nbrightness = Math.ceil( brightness + brightness_step );\n\n\nif( brightness < brightness_min )\n{ \n    brightness = brightness_max;\n\n} else if( brightness > brightness_max )\n{ \n    brightness = brightness_min;\n\n} // endif\n\nmsg.payload = brightness;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1310,"y":1220,"wires":[["1a9e5b3d723fd043"]]},{"id":"69db3d8a0e4cd78f","type":"api-current-state","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"If Ceiling Ledge is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.foyer_ceiling_ledge","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":780,"y":1220,"wires":[["3f9b5f430db4660b"],["ec1fccd358e40463"]]},{"id":"2343f16b29502fdb","type":"trigger","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-1","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":540,"y":1220,"wires":[["69db3d8a0e4cd78f"]]},{"id":"804006fe20f4ab7b","type":"change","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":1280,"wires":[["2343f16b29502fdb"]]},{"id":"49f92784cf7a09aa","type":"debug","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1850,"y":1220,"wires":[]},{"id":"b33f1b35912969e0","type":"server-state-changed","z":"75bda675505dd534","g":"bbdfd791e1227da1","name":"Doorbell Button Pressed","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.doorbell_ding","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"on","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":true,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":210,"y":200,"wires":[["9591d8a2bed75603"],[]]},{"id":"a96ca5ac6d732b08","type":"api-call-service","z":"75bda675505dd534","g":"bbdfd791e1227da1","name":"Take snapshot","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"camera","service":"snapshot","areaId":[],"deviceId":[],"entityId":["camera.foyer_doorbell_high"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":480,"y":200,"wires":[["17e0253cc7611cdd"]]},{"id":"7133d65cba709e01","type":"inject","z":"75bda675505dd534","g":"bbdfd791e1227da1","name":"Trigger: Button Press START","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"on","payloadType":"str","x":220,"y":140,"wires":[["9591d8a2bed75603"]]},{"id":"0180a8e0974cc07b","type":"function","z":"75bda675505dd534","g":"bbdfd791e1227da1","name":"Prepare iOS Notification","func":"msg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : \"Someone rang the doorbell\",\n        \"data\"    : { \n            \"subtitle\": false,\n            \"image\" : msg.snapshot,\n            \"push\" : { \n                \"sound\" : { \n                    \"name\"     : \"default\",\n                    \"sound\"    : 0,\n                    \"critical\" : 1\n                }\n            },\n            \n        }\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":200,"wires":[["1f3d679062bc9586"]]},{"id":"1f3d679062bc9586","type":"link out","z":"75bda675505dd534","g":"bbdfd791e1227da1","name":"Doorbell Pressed, Send Notification","mode":"link","links":["b5bf4f1d2a2db4f8","eb19baaad61d9a94"],"x":1115,"y":200,"wires":[]},{"id":"f7a0be51b3cf53de","type":"comment","z":"75bda675505dd534","g":"bbdfd791e1227da1","name":"----- Doorbell Button Pressed, Send Notification with Image -----","info":"","x":330,"y":80,"wires":[]},{"id":"9591d8a2bed75603","type":"function","z":"75bda675505dd534","g":"bbdfd791e1227da1","name":"Setup Snapshot","func":"const timestamp = new Date().toISOString();\n\nconst snapshot_file = \"doorbell-press-\" + timestamp + \".jpg\";\n\nmsg.snapshot = \"/local/snapshots/\" + snapshot_file;\n\nmsg.payload = {\n    data : {\n        \"filename\" : \"/config/www/snapshots/\" + snapshot_file\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":480,"y":140,"wires":[["a96ca5ac6d732b08"]]},{"id":"17e0253cc7611cdd","type":"delay","z":"75bda675505dd534","g":"bbdfd791e1227da1","name":"","pauseType":"delay","timeout":"750","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":690,"y":200,"wires":[["0180a8e0974cc07b"]]},{"id":"191741edefbc2879","type":"debug","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":970,"y":580,"wires":[]},{"id":"ec1fccd358e40463","type":"api-call-service","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"Turn Ceiling Ledge ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.foyer_ceiling_ledge"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1040,"y":1260,"wires":[["3f9b5f430db4660b"]]},{"id":"18a229de6692d719","type":"api-call-service","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"Turn Desk Light ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_desk_lamp"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1010,"y":740,"wires":[["c50afa0cb006d3a5"]]},{"id":"7cfee9bcaadde84f","type":"comment","z":"75bda675505dd534","g":"33bd061414ad5b40","name":"----- His Office for His Office -----","info":"","x":210,"y":400,"wires":[]},{"id":"b2a7b37874b4b0fb","type":"comment","z":"75bda675505dd534","g":"3c888c1f5a7f12b2","name":"----- Foyer for Foyer -----","info":"","x":190,"y":900,"wires":[]},{"id":"807a15bf46fb8d0b","type":"comment","z":"75bda675505dd534","g":"0b05817bb4d42102","name":"----- Kitchen for Garage -----","info":"","x":200,"y":1420,"wires":[]},{"id":"4c382fd7d8a1471f","type":"server-events","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"ZHA Event","server":"1040bb61.673d75","version":1,"event_type":"zha_event","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"},{"property":"event_type","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"}],"x":140,"y":2260,"wires":[["c59048d23c7e78c2"]]},{"id":"c59048d23c7e78c2","type":"switch","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"2-Button Remote","property":"payload.event.device_id","propertyType":"msg","rules":[{"t":"cont","v":"2dc0139c1c451758a62d03ca6599c827","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":170,"y":2340,"wires":[["52b14ca87346ef0d"]]},{"id":"ac6478947365b072","type":"switch","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"Button Press Type","property":"button_press","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"},{"t":"eq","v":"on_hold","vt":"str"},{"t":"eq","v":"off_hold","vt":"str"},{"t":"eq","v":"stop","vt":"str"}],"checkall":"true","repair":false,"outputs":5,"x":410,"y":2340,"wires":[["41a8c88062ca01cd"],["d344f2a97433832f"],["8b379f210d5b55fd"],["8b379f210d5b55fd"],["b6465fd896443869"]]},{"id":"d344f2a97433832f","type":"api-current-state","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"If Bedside Lamps are ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_1_bedside_lamps","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":690,"y":2340,"wires":[["36f68ebfdafa41a2"],[]]},{"id":"b6465fd896443869","type":"change","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":2480,"wires":[["8b379f210d5b55fd"]]},{"id":"36f68ebfdafa41a2","type":"api-call-service","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"Turn Bedside Lamps OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.bedroom_1_bedside_lamps"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":970,"y":2340,"wires":[["a53a26265673939a"]]},{"id":"a53a26265673939a","type":"debug","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1210,"y":2280,"wires":[]},{"id":"2230bd4ab26cc017","type":"function","z":"75bda675505dd534","name":"Brightness Level, Decrease","func":"var brightness = msg.data.attributes.brightness;\nconst brightness_min = 25;  // Do not make less than 1 (2.55%)\nconst brightness_max = 255; // Do not make greater than 255 (100%)\nconst brightness_step = 25;\n\nbrightness = parseInt( brightness );\n\nbrightness = Math.ceil( brightness - brightness_step );\n\n\nif( brightness < brightness_min )\n{ \n    brightness = brightness_max;\n\n} else if( brightness > brightness_max )\n{ \n    brightness = brightness_min;\n\n} // endif\n\nmsg.brightness = brightness;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":2660,"wires":[["8ed7421a294df81f"]]},{"id":"c96cb06fce36d315","type":"api-call-service","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"Turn Bedside Lamps ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_1_bedside_lamps"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":990,"y":2280,"wires":[["a53a26265673939a"]]},{"id":"8b379f210d5b55fd","type":"trigger","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-1","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":660,"y":2400,"wires":[["4054e2fe3d389c8c"]]},{"id":"8ed7421a294df81f","type":"api-current-state","z":"75bda675505dd534","name":"If Bedside Lamps are ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_1_bedside_lamps","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":730,"y":2620,"wires":[["923885fc102f8883"],["ed89776dc7f4d798"]]},{"id":"a80bf6a17c3a0298","type":"function","z":"75bda675505dd534","name":"Brightness Level, Increase","func":"var brightness = msg.data.attributes.brightness;\nconst brightness_min = 25;  // Do not make less than 1 (2.55%)\nconst brightness_max = 255; // Do not make greater than 255 (100%)\nconst brightness_step = 25;\n\nbrightness = parseInt( brightness );\n\nbrightness = Math.ceil( brightness + brightness_step );\n\n\nif( brightness < brightness_min )\n{ \n    brightness = brightness_max;\n\n} else if( brightness > brightness_max )\n{ \n    brightness = brightness_min;\n\n} // endif\n\nmsg.brightness = brightness;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":440,"y":2600,"wires":[["8ed7421a294df81f"]]},{"id":"ed89776dc7f4d798","type":"api-call-service","z":"75bda675505dd534","name":"Turn Bedside Lamps ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_1_bedside_lamps"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1010,"y":2660,"wires":[["923885fc102f8883"]]},{"id":"923885fc102f8883","type":"api-call-service","z":"75bda675505dd534","name":"Adjust Bedside Lamps Brightness","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_desk_lamp"],"data":"{ \"entity_id\":\"light.bedroom_1_bedside_lamps\", \"brightness\":{{brightness}} }","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1320,"y":2620,"wires":[["5511180dfc739fe5"]]},{"id":"5511180dfc739fe5","type":"debug","z":"75bda675505dd534","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1570,"y":2620,"wires":[]},{"id":"84633d1b9b6b96b9","type":"switch","z":"75bda675505dd534","name":"Button Press Type","property":"payload.event.command","propertyType":"msg","rules":[{"t":"eq","v":"move_with_on_off","vt":"str"},{"t":"eq","v":"move","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":170,"y":2600,"wires":[["a80bf6a17c3a0298"],["2230bd4ab26cc017"]]},{"id":"d62c5c9d.ef6d18","type":"switch","z":"75bda675505dd534","g":"d46092dab47821af","name":"Button Routing","property":"button_press","propertyType":"msg","rules":[{"t":"eq","v":"power","vt":"str"},{"t":"eq","v":"up","vt":"str"},{"t":"eq","v":"right","vt":"str"},{"t":"eq","v":"down","vt":"str"},{"t":"eq","v":"left","vt":"str"},{"t":"eq","v":"up_hold","vt":"str"},{"t":"eq","v":"right_hold","vt":"str"},{"t":"eq","v":"down_hold","vt":"str"},{"t":"eq","v":"left_hold","vt":"str"},{"t":"eq","v":"stop","vt":"str"}],"checkall":"true","repair":false,"outputs":10,"x":400,"y":1960,"wires":[["259e2ad8042c16d9"],["2a0d77fade2710e7"],[],["2a0d77fade2710e7"],[],["a9ee4724c66e2f19"],[],["a9ee4724c66e2f19"],[],["0a38f536b463b6b0"]],"inputLabels":["Command In"],"outputLabels":["Power Button","Up Button","Right Button","Down Button","Left Button","","","","",""]},{"id":"f67b163fc0dca4a8","type":"switch","z":"75bda675505dd534","g":"d46092dab47821af","name":"5-Button Remote","property":"payload.event.device_id","propertyType":"msg","rules":[{"t":"cont","v":"6eb2c62e0318bc0440533a8757563b4b","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":170,"y":1920,"wires":[["7b2b261b.83d72"]]},{"id":"01a357c9b63832ae","type":"server-events","z":"75bda675505dd534","g":"d46092dab47821af","name":"ZHA Event","server":"1040bb61.673d75","version":1,"event_type":"zha_event","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"},{"property":"event_type","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"}],"x":140,"y":1840,"wires":[["f67b163fc0dca4a8"]]},{"id":"609ab88c0c8f076c","type":"api-call-service","z":"75bda675505dd534","g":"d46092dab47821af","name":"Turn Office Lights OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_lights"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":920,"y":1840,"wires":[["259405adc493c6cc"]]},{"id":"259e2ad8042c16d9","type":"api-current-state","z":"75bda675505dd534","g":"d46092dab47821af","name":"If Office Lights are ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_4_lights","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":650,"y":1900,"wires":[["609ab88c0c8f076c"],["ca4892a8c0470bd9"]]},{"id":"ca4892a8c0470bd9","type":"api-call-service","z":"75bda675505dd534","g":"d46092dab47821af","name":"Turn Office Lights ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_lights"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":920,"y":1900,"wires":[["259405adc493c6cc"]]},{"id":"259405adc493c6cc","type":"debug","z":"75bda675505dd534","g":"d46092dab47821af","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1130,"y":1840,"wires":[]},{"id":"a9ee4724c66e2f19","type":"trigger","z":"75bda675505dd534","g":"d46092dab47821af","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-1","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":640,"y":1980,"wires":[["2a0d77fade2710e7"]]},{"id":"0a38f536b463b6b0","type":"change","z":"75bda675505dd534","g":"d46092dab47821af","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":640,"y":2060,"wires":[["a9ee4724c66e2f19"]]},{"id":"2a0d77fade2710e7","type":"api-current-state","z":"75bda675505dd534","g":"d46092dab47821af","name":"If Desk Lamp is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_4_desk_lamp","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":870,"y":1980,"wires":[["b9a4464ae5baee1b"],["bfe8b62aa101afa1"]]},{"id":"bfe8b62aa101afa1","type":"api-call-service","z":"75bda675505dd534","g":"d46092dab47821af","name":"Turn Desk Lamp ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_desk_lamp"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":1120,"y":2060,"wires":[["0998685f26fc6907"]]},{"id":"dc9e9ba0c3926658","type":"api-call-service","z":"75bda675505dd534","g":"d46092dab47821af","name":"Adjust Brightness","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_4_desk_lamp"],"data":"{ \"brightness\":{{brightness}} }","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1630,"y":2060,"wires":[["bcca83e51de327bb"]]},{"id":"bcca83e51de327bb","type":"debug","z":"75bda675505dd534","g":"d46092dab47821af","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1870,"y":1980,"wires":[]},{"id":"577628db0a3600cf","type":"function","z":"75bda675505dd534","g":"d46092dab47821af","name":"Set Brightness Level","func":"const btn_press = msg.button_press;\n\nvar brightness = msg.data.attributes.brightness;\nconst brightness_min = 25;  // Do not make less than 1 (2.55%)\nconst brightness_max = 255; // Do not make greater than 255 (100%)\nconst brightness_step = 25;\n\nbrightness = parseInt( brightness );\n\n\n//brightness = Math.ceil( brightness + brightness_step );\nif( 'up' == btn_press || 'up_hold' == btn_press )\n{ \n    brightness = Math.ceil( brightness + brightness_step );\n\n} else\n{ \n    brightness = Math.ceil( brightness - brightness_step );\n\n} // endif\n\n\nif( brightness < brightness_min )\n{ \n    brightness = brightness_max;\n\n} else if( brightness > brightness_max )\n{ \n    brightness = brightness_min;\n\n} // endif\n\nmsg.brightness = brightness;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1640,"y":1980,"wires":[["dc9e9ba0c3926658"]]},{"id":"b9a4464ae5baee1b","type":"api-current-state","z":"75bda675505dd534","g":"d46092dab47821af","name":"Get Current Brightness","server":"1040bb61.673d75","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_4_desk_lamp","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1380,"y":1980,"wires":[["577628db0a3600cf"]]},{"id":"0998685f26fc6907","type":"delay","z":"75bda675505dd534","g":"d46092dab47821af","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":1340,"y":2060,"wires":[["b9a4464ae5baee1b"]]},{"id":"f40dfb419f1e9e22","type":"comment","z":"75bda675505dd534","name":"----- Aqara Mini-Switch Button Press -----","info":"","x":220,"y":320,"wires":[]},{"id":"fe173d11a4227841","type":"comment","z":"75bda675505dd534","g":"d46092dab47821af","name":"----- His Office for His Office -----","info":"","x":210,"y":1780,"wires":[]},{"id":"ebab4eaf662659a7","type":"comment","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"----- Main Bedroom for Main Bedroom -----","info":"","x":250,"y":2200,"wires":[]},{"id":"7b2b261b.83d72","type":"function","z":"75bda675505dd534","g":"d46092dab47821af","name":"Get Button Press Type ","func":"const payload = msg.payload.event.command;\nconst eventarg = msg.payload.event.args[0];\n\nif( payload == \"toggle\" )\n{ \n\tmsg.button_press = \"power\";\n\n} // endif\n\n// Single Press Buttons\nif( payload == \"step_with_on_off\" )\n{ \n\tmsg.button_press = \"up\";\n\n} // endif\n\n\nif( payload == \"step\" )\n{ \n\tmsg.button_press = \"down\";\n\n} // endif\n\n\nif( eventarg == \"256\" )\n{ \n\tmsg.button_press = \"right\";\n\n} // endif\n\n\nif( eventarg == \"257\" )\n{ \n\tmsg.button_press = \"left\";\n\n    \n} // endif\n\n\n// Press & Hold Buttons\nif( payload == \"move_with_on_off\" )\n{ \n\tmsg.button_press = \"up_hold\";\n\n} // endif\n\n\nif( payload == \"move\" )\n{ \n\tmsg.button_press = \"down_hold\";\n\n} // endif\n\n\nif( eventarg == \"3328\" )\n{ \n\tmsg.button_press = \"right_hold\";\n\n} // endif\n\n\nif( eventarg == \"3329\" )\n{ \n\tmsg.button_press = \"left_hold\";\n\n} // endif\n\n\n// On Release\nif( payload == \"stop\" )\n{ \n\tmsg.button_press = \"stop\";\n\n} // endif\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":420,"y":1840,"wires":[["d62c5c9d.ef6d18"]]},{"id":"52b14ca87346ef0d","type":"function","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"Get Button Press Type ","func":"const payload = msg.payload.event.command;\n\n// Single Press Buttons\nif( payload == \"on\" )\n{ \n\tmsg.button_press = \"on\";\n\n} // endif\n\n\nif( payload == \"off\" )\n{ \n\tmsg.button_press = \"off\";\n\n} // endif\n\n\n// Press & Hold Buttons\nif( payload == \"move_with_on_off\" )\n{ \n\tmsg.button_press = \"on_hold\";\n\n} // endif\n\n\nif( payload == \"move\" )\n{ \n\tmsg.button_press = \"off_hold\";\n\n} // endif\n\n\n// On Release\nif( payload == \"stop\" )\n{ \n\tmsg.button_press = \"stop\";\n\n} // endif\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":420,"y":2260,"wires":[["ac6478947365b072"]]},{"id":"4054e2fe3d389c8c","type":"api-current-state","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"If Bedside Lamps is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_1_bedside_lamps","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":910,"y":2400,"wires":[["dee03074ae00cbdc"],["a418271732700c61"]]},{"id":"a418271732700c61","type":"api-call-service","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"Turn Bedside Lamps ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_1_bedside_lamps"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":1190,"y":2480,"wires":[["3142b021887873dc"]]},{"id":"3142b021887873dc","type":"delay","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":1420,"y":2480,"wires":[["dee03074ae00cbdc"]]},{"id":"dee03074ae00cbdc","type":"api-current-state","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"Get Current Brightness","server":"1040bb61.673d75","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_1_bedside_lamps","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1460,"y":2400,"wires":[["3ca1851b424cb660"]]},{"id":"46724618b7510644","type":"api-call-service","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"Adjust Brightness","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.bedroom_1_bedside_lamps"],"data":"{ \"brightness\":{{brightness}} }","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1710,"y":2480,"wires":[["bae6b195750d5204"]]},{"id":"3ca1851b424cb660","type":"function","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"Set Brightness Level","func":"const btn_press = msg.button_press;\n\nvar brightness = msg.data.attributes.brightness;\nconst brightness_min = 25;  // Do not make less than 1 (2.55%)\nconst brightness_max = 255; // Do not make greater than 255 (100%)\nconst brightness_step = 25;\n\nbrightness = parseInt( brightness );\n\n\n//brightness = Math.ceil( brightness + brightness_step );\nif( 'on' == btn_press || 'on_hold' == btn_press )\n{ \n    brightness = Math.ceil( brightness + brightness_step );\n\n} else\n{ \n    brightness = Math.ceil( brightness - brightness_step );\n\n} // endif\n\n\nif( brightness < brightness_min )\n{ \n    brightness = brightness_max;\n\n} else if( brightness > brightness_max )\n{ \n    brightness = brightness_min;\n\n} // endif\n\nmsg.brightness = brightness;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1720,"y":2400,"wires":[["46724618b7510644"]]},{"id":"bae6b195750d5204","type":"debug","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1950,"y":2400,"wires":[]},{"id":"41a8c88062ca01cd","type":"api-current-state","z":"75bda675505dd534","g":"abb2809c73c9bf16","name":"If Bedside Lamps are OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.bedroom_1_bedside_lamps","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":700,"y":2280,"wires":[["c96cb06fce36d315"],[]]},{"id":"2e1848ed47ecc384","type":"server-events","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"ZHA Event","server":"1040bb61.673d75","version":1,"event_type":"zha_event","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"},{"property":"event_type","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"}],"x":140,"y":2860,"wires":[["fdde1db1d040cd66"]]},{"id":"fdde1db1d040cd66","type":"switch","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"2-Button Remote","property":"payload.event.device_id","propertyType":"msg","rules":[{"t":"cont","v":"2c46a58ebc234a3ec6de71ffc94526e5","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":170,"y":2940,"wires":[["7fc118dbaef58868"]]},{"id":"37c59db0675968bb","type":"switch","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"Button Press Type","property":"button_press","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"},{"t":"eq","v":"on_hold","vt":"str"},{"t":"eq","v":"off_hold","vt":"str"},{"t":"eq","v":"stop","vt":"str"}],"checkall":"true","repair":false,"outputs":5,"x":410,"y":2940,"wires":[["cead0db4e8f2ec05"],["d82e0b86dafd432e"],["b5da29cab8251554"],["b5da29cab8251554"],["f097b40a4e67e02c"]]},{"id":"d82e0b86dafd432e","type":"api-current-state","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"If Corner Lamp are ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.living_room_corner_lamp","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":680,"y":2940,"wires":[["c509db097f261da3"],[]]},{"id":"f097b40a4e67e02c","type":"change","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":3080,"wires":[["b5da29cab8251554"]]},{"id":"c509db097f261da3","type":"api-call-service","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"Turn Corner Lamp OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_off","areaId":[],"deviceId":[],"entityId":["light.living_room_corner_lamp"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":970,"y":2940,"wires":[["d26830d4bca97ec7"]]},{"id":"d26830d4bca97ec7","type":"debug","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1210,"y":2880,"wires":[]},{"id":"17cadfe8639999ee","type":"api-call-service","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"Turn Corner Lamp ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.living_room_corner_lamp"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":980,"y":2880,"wires":[["d26830d4bca97ec7"]]},{"id":"b5da29cab8251554","type":"trigger","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"-1","extend":false,"overrideDelay":false,"units":"s","reset":"","bytopic":"all","topic":"topic","outputs":1,"x":660,"y":3000,"wires":[["2ab6688cb35abf93"]]},{"id":"a1c3525f3b4e549e","type":"comment","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"----- Living Room for Living Room -----","info":"","x":240,"y":2800,"wires":[]},{"id":"7fc118dbaef58868","type":"function","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"Get Button Press Type ","func":"const payload = msg.payload.event.command;\n\n// Single Press Buttons\nif( payload == \"on\" )\n{ \n\tmsg.button_press = \"on\";\n\n} // endif\n\n\nif( payload == \"off\" )\n{ \n\tmsg.button_press = \"off\";\n\n} // endif\n\n\n// Press & Hold Buttons\nif( payload == \"move_with_on_off\" )\n{ \n\tmsg.button_press = \"on_hold\";\n\n} // endif\n\n\nif( payload == \"move\" )\n{ \n\tmsg.button_press = \"off_hold\";\n\n} // endif\n\n\n// On Release\nif( payload == \"stop\" )\n{ \n\tmsg.button_press = \"stop\";\n\n} // endif\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":420,"y":2860,"wires":[["37c59db0675968bb"]]},{"id":"2ab6688cb35abf93","type":"api-current-state","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"If Corner Lamp is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.living_room_corner_lamp","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":900,"y":3000,"wires":[["1077480807cb92d0"],["70761485952b920a"]]},{"id":"70761485952b920a","type":"api-call-service","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"Turn Corner Lamp ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.living_room_corner_lamp"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":1180,"y":3080,"wires":[["9a64656fdea0d925"]]},{"id":"9a64656fdea0d925","type":"delay","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":1420,"y":3080,"wires":[["1077480807cb92d0"]]},{"id":"1077480807cb92d0","type":"api-current-state","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"Get Current Brightness","server":"1040bb61.673d75","version":3,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.living_room_corner_lamp","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1460,"y":3000,"wires":[["191db3f4aacd4f54"]]},{"id":"60967315f0040565","type":"api-call-service","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"Adjust Brightness","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["light.living_room_corner_lamp"],"data":"{ \"brightness\":{{brightness}} }","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1710,"y":3080,"wires":[["e652e8beb2243482"]]},{"id":"191db3f4aacd4f54","type":"function","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"Set Brightness Level","func":"const btn_press = msg.button_press;\n\nvar brightness = msg.data.attributes.brightness;\nconst brightness_min = 25;  // Do not make less than 1 (2.55%)\nconst brightness_max = 255; // Do not make greater than 255 (100%)\nconst brightness_step = 25;\n\nbrightness = parseInt( brightness );\n\n\n//brightness = Math.ceil( brightness + brightness_step );\nif( 'on' == btn_press || 'on_hold' == btn_press )\n{ \n    brightness = Math.ceil( brightness + brightness_step );\n\n} else\n{ \n    brightness = Math.ceil( brightness - brightness_step );\n\n} // endif\n\n\nif( brightness < brightness_min )\n{ \n    brightness = brightness_max;\n\n} else if( brightness > brightness_max )\n{ \n    brightness = brightness_min;\n\n} // endif\n\nmsg.brightness = brightness;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1720,"y":3000,"wires":[["60967315f0040565"]]},{"id":"e652e8beb2243482","type":"debug","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1950,"y":3000,"wires":[]},{"id":"cead0db4e8f2ec05","type":"api-current-state","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"If Corner Lamp are OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"light.living_room_corner_lamp","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":690,"y":2880,"wires":[["17cadfe8639999ee"],[]]},{"id":"d26499c9fabd5eb0","type":"debug","z":"75bda675505dd534","g":"8953653722b0a6b2","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":650,"y":2800,"wires":[]},{"id":"0d46746ba8440730","type":"comment","z":"948139bb1964bc5a","g":"ced32fcc854281a5","name":"----- Doors Open or Close, Send Notification -----","info":"","x":260,"y":80,"wires":[]},{"id":"b963a2ee377d2e71","type":"comment","z":"948139bb1964bc5a","g":"5df1c59ae220dac5","name":"----- Garage Door in Use, Send Notification -----","info":"","x":280,"y":580,"wires":[]},{"id":"66022fb5265778ed","type":"switch","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"On or Off?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":510,"y":940,"wires":[["539dc1c9d7a3b1eb","7aea4a101153a0b6","848ffb410d7e4f62"],[]]},{"id":"539dc1c9d7a3b1eb","type":"function","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Prepare Alexa Notification","func":"const entity_id = msg.data.entity_id;\nconst gHomeAssistant = global.get(\"homeassistant\").homeAssistant;\n\nconst name = gHomeAssistant.states[ entity_id ].attributes.friendly_name;\n\nmsg.notification = \"The \" + name + \" has detected the presence of water\";\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":750,"y":1060,"wires":[["8be476363dfd33d3"]]},{"id":"8d26ab37046c1f9a","type":"server-state-changed","z":"948139bb1964bc5a","g":"5df1c59ae220dac5","name":"Door, Garage","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"cover.garage_door","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"opening, closing","halt_if_type":"str","halt_if_compare":"includes","outputs":2,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":true,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":170,"y":740,"wires":[["7cce35452bc5c875"],[]]},{"id":"7cce35452bc5c875","type":"switch","z":"948139bb1964bc5a","g":"5df1c59ae220dac5","name":"Open or Closed?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"opening","vt":"str"},{"t":"eq","v":"closing","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":390,"y":740,"wires":[["68a78ab1a08de10a"],["68a78ab1a08de10a"]]},{"id":"0952a2ee0d589e03","type":"comment","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"----- Leak/Water is Detected, Send Notification -----","info":"","x":270,"y":880,"wires":[]},{"id":"c779d0a765e3d78d","type":"comment","z":"948139bb1964bc5a","g":"a2caccdf611fb758","name":"----- Garage Door Left Open, Send Notification -----","info":"","x":290,"y":1440,"wires":[]},{"id":"3a4231a2e53f04e3","type":"inject","z":"948139bb1964bc5a","g":"a2caccdf611fb758","name":"Trigger: ACTIVE","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"1","payloadType":"num","x":200,"y":1500,"wires":[["aaf36abb2aa6af60"]]},{"id":"16cc91349e008901","type":"bigtimer","z":"948139bb1964bc5a","g":"a2caccdf611fb758","outtopic":"","outpayload1":"active","outpayload2":"inactive","name":"Sunset to Sunrise","comment":"","lat":"26.305080","lon":"-80.197180","starttime":"5004","endtime":"5003","starttime2":0,"endtime2":0,"startoff":"0","endoff":"0","startoff2":0,"endoff2":0,"offs":0,"outtext1":"","outtext2":"","timeout":"2","sun":true,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":true,"jan":true,"feb":true,"mar":true,"apr":true,"may":true,"jun":true,"jul":true,"aug":true,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"day6":0,"month6":0,"day7":0,"month7":0,"day8":0,"month8":0,"day9":0,"month9":0,"day10":0,"month10":0,"day11":0,"month11":0,"day12":0,"month12":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"d6":0,"w6":0,"xday1":0,"xmonth1":0,"xday2":0,"xmonth2":0,"xday3":0,"xmonth3":0,"xday4":0,"xmonth4":0,"xday5":0,"xmonth5":0,"xday6":0,"xmonth6":0,"xday7":0,"xmonth7":0,"xday8":0,"xmonth8":0,"xday9":0,"xmonth9":0,"xday10":0,"xmonth10":0,"xday11":0,"xmonth11":0,"xday12":0,"xmonth12":0,"xd1":0,"xw1":0,"xd2":0,"xw2":0,"xd3":0,"xw3":0,"xd4":0,"xw4":0,"xd5":0,"xw5":0,"xd6":0,"xw6":0,"suspend":false,"random":false,"randon1":false,"randoff1":false,"randon2":false,"randoff2":false,"repeat":true,"atstart":true,"odd":false,"even":false,"x":190,"y":1600,"wires":[[],["aaf36abb2aa6af60"],[]]},{"id":"b6a048bf5769c8cf","type":"api-current-state","z":"948139bb1964bc5a","g":"a2caccdf611fb758","name":"Is Garage Door Open?","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"open","halt_if_type":"str","halt_if_compare":"is","entity_id":"cover.garage_door","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":1140,"y":1600,"wires":[["56e812d6e0542d72"],[]]},{"id":"2b7b1e49e0f35dad","type":"inject","z":"948139bb1964bc5a","g":"a2caccdf611fb758","name":"Trigger: INACTIVE","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"0","payloadType":"num","x":190,"y":1540,"wires":[["aaf36abb2aa6af60"]]},{"id":"2449ad9639bf3f31","type":"delay","z":"948139bb1964bc5a","g":"a2caccdf611fb758","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"20","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"allowrate":false,"outputs":1,"x":900,"y":1600,"wires":[["b6a048bf5769c8cf"]]},{"id":"23c6f469513289a8","type":"link out","z":"948139bb1964bc5a","g":"5df1c59ae220dac5","name":"Garage Door Activity, Send Notification","mode":"link","links":["b5bf4f1d2a2db4f8"],"x":835,"y":740,"wires":[]},{"id":"8519b53052fc2bae","type":"link out","z":"948139bb1964bc5a","g":"a2caccdf611fb758","name":"Garage Door Left Open, Send Notification","mode":"link","links":["b5bf4f1d2a2db4f8","eb19baaad61d9a94"],"x":1595,"y":1600,"wires":[]},{"id":"a8e6cda928e350b6","type":"link out","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Leak Detected, Send Notification (iOS)","mode":"link","links":["b5bf4f1d2a2db4f8","eb19baaad61d9a94"],"x":935,"y":940,"wires":[]},{"id":"6b22269b5e8e1a2c","type":"server-state-changed","z":"948139bb1964bc5a","g":"ced32fcc854281a5","name":"Door, Bedroom 1 (Main)","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.door_bedroom_1","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"on, off","halt_if_type":"str","halt_if_compare":"includes","outputs":2,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":true,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":180,"y":260,"wires":[["5bc0b18a1d357024"],[]]},{"id":"5bc0b18a1d357024","type":"switch","z":"948139bb1964bc5a","g":"ced32fcc854281a5","name":"Open or Closed?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":470,"y":140,"wires":[["c6d8e1b43823a5dc"],["c6d8e1b43823a5dc"]]},{"id":"74378d9b29e099d4","type":"server-state-changed","z":"948139bb1964bc5a","g":"ced32fcc854281a5","name":"Door, Bedroom 2 (Guest)","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.door_bedroom_2","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"on, off","halt_if_type":"str","halt_if_compare":"includes","outputs":2,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":true,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":190,"y":320,"wires":[["5bc0b18a1d357024"],[]]},{"id":"5f9dcdce99752d51","type":"server-state-changed","z":"948139bb1964bc5a","g":"ced32fcc854281a5","name":"Door, Bedroom 3 (Office, Hers)","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.door_bedroom_3","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"on, off","halt_if_type":"str","halt_if_compare":"includes","outputs":2,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":true,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":210,"y":380,"wires":[["5bc0b18a1d357024"],[]]},{"id":"177426a8bad398f7","type":"server-state-changed","z":"948139bb1964bc5a","g":"ced32fcc854281a5","name":"Door, Bedroom 4 (Office, His)","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.door_bedroom_4","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"on, off","halt_if_type":"str","halt_if_compare":"includes","outputs":2,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":true,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":200,"y":440,"wires":[["5bc0b18a1d357024"],[]]},{"id":"6af15fa1cd2941e5","type":"server-state-changed","z":"948139bb1964bc5a","g":"ced32fcc854281a5","name":"Sliding Door, Living Room","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.door_living","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"on, off","halt_if_type":"str","halt_if_compare":"includes","outputs":2,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":true,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":190,"y":140,"wires":[["5bc0b18a1d357024"],[]]},{"id":"0e1fa1181fbfbb95","type":"server-state-changed","z":"948139bb1964bc5a","g":"ced32fcc854281a5","name":"Door, Laundry Room","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.door_laundry","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"on, off","halt_if_type":"str","halt_if_compare":"includes","outputs":2,"output_only_on_state_change":true,"for":"0","forType":"num","forUnits":"minutes","ignorePrevStateNull":true,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":170,"y":200,"wires":[["5bc0b18a1d357024"],[]]},{"id":"6b25673ada107590","type":"link out","z":"948139bb1964bc5a","g":"ced32fcc854281a5","name":"Household Door Activity, Send Notification","mode":"link","links":["b5bf4f1d2a2db4f8"],"x":915,"y":140,"wires":[]},{"id":"aaf36abb2aa6af60","type":"switch","z":"948139bb1964bc5a","g":"a2caccdf611fb758","name":"Is Active?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"active","vt":"str"},{"t":"eq","v":"inactive","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":400,"y":1600,"wires":[["da2b881343195e9c"],[]]},{"id":"7aea4a101153a0b6","type":"function","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Prepare Persistant Notification","func":"const entity_id = msg.data.entity_id;\nconst gHomeAssistant = global.get(\"homeassistant\").homeAssistant;\n\nconst name = gHomeAssistant.states[ entity_id ].attributes.friendly_name;\n\nmsg.notification = { \n    data : {\n        \"title\"   : \"Water Leak Detected\",\n        \"message\" : \"The \" + name + \" has detected the presence of water\"\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":1000,"wires":[["e0b6b365e87fb6b5"]]},{"id":"e0b6b365e87fb6b5","type":"link out","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Leak Detected, Send Notification (Home Assistant)","mode":"link","links":["a2729e8ee4af65f5"],"x":975,"y":1000,"wires":[]},{"id":"beee4018748b4637","type":"inject","z":"948139bb1964bc5a","g":"5df1c59ae220dac5","name":"Trigger: OPENING","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"opening","payloadType":"str","x":190,"y":640,"wires":[["7cce35452bc5c875"]]},{"id":"2172116495b4ee20","type":"inject","z":"948139bb1964bc5a","g":"5df1c59ae220dac5","name":"Trigger: CLOSING","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"closing","payloadType":"str","x":190,"y":680,"wires":[["7cce35452bc5c875"]]},{"id":"8be476363dfd33d3","type":"link out","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Leak Detected, Send Notification (Alexa)","mode":"link","links":["064a1785b9c6a8a0","e3f52efe96ae8364","f9e0b7ba2c681f39","fa75df9d99a78852","be632de7dd78d7db"],"x":935,"y":1060,"wires":[]},{"id":"c6d8e1b43823a5dc","type":"function","z":"948139bb1964bc5a","g":"ced32fcc854281a5","name":"Prepare iOS Notification","func":"const name = msg.data.new_state.attributes.friendly_name;\nconst state = ( msg.payload === \"on\" ) ? \"opened\" : \"closed\";\n\nmsg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : name + \" has been \" + state\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":730,"y":140,"wires":[["6b25673ada107590"]]},{"id":"68a78ab1a08de10a","type":"function","z":"948139bb1964bc5a","g":"5df1c59ae220dac5","name":"Prepare iOS Notification","func":"const name = msg.data.new_state.attributes.friendly_name;\nconst state = ( msg.payload === \"opening\" ) ? \"opening\" : \"closing\";\n\nmsg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : \"The \" + name + \" is \" + state\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":650,"y":740,"wires":[["23c6f469513289a8"]]},{"id":"56e812d6e0542d72","type":"function","z":"948139bb1964bc5a","g":"a2caccdf611fb758","name":"Prepare iOS Notification","func":"msg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : \"Oops! Your garage door was left open\",\n        \"data\"    : { \n            \"subtitle\": false,\n            \"push\" : { \n                \"sound\" : { \n                    \"name\"   : \"US-EN-Daisy-Garage-Door-Open.wav\",\n                    \"volume\" : 1\n                }\n            },\n            \"actions\" : [\n                { \n                    action : \"GARAGE_DOOR_CLOSE\",\n                    title  : \"Close Garage Door\"\n                },\n                { \n                    action : \"GARAGE_DOOR_SNOOZE_TODAY\",\n                    title  : \"Snooze: Reminders Today\"\n                }\n            ]\n        }\n            \n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1410,"y":1600,"wires":[["8519b53052fc2bae"]]},{"id":"848ffb410d7e4f62","type":"function","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Prepare iOS Notification","func":"const entity_id = msg.data.entity_id;\nconst gHomeAssistant = global.get(\"homeassistant\").homeAssistant;\n\nconst name = gHomeAssistant.states[ entity_id ].attributes.friendly_name;\n\nmsg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : \"The \" + name + \" has detected the presence of water\",\n        \"data\"    : { \n            \"subtitle\": false,\n            \"push\" : { \n                \"sound\" : { \n                    \"name\"     : \"US-EN-Alexa-Water-Detected-Generic.wav\",\n                    \"critical\" : 1,\n                    \"volume\"   : 1\n                }\n            }\n        }\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":750,"y":940,"wires":[["a8e6cda928e350b6"]]},{"id":"3d319eb43635c372","type":"comment","z":"948139bb1964bc5a","g":"931f2c0cfb587811","name":"----- When Arriving at Borgata, Send Notification -----","info":"","x":280,"y":2960,"wires":[]},{"id":"fd147829f79e871a","type":"trigger-state","z":"948139bb1964bc5a","g":"2a7a5bd2ac8e1c46","name":"Stale Backups","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"binary_sensor.backups_stale","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":160,"y":3440,"wires":[["cbabbdf4c0ece489","1f6a899ad824a749"],[]]},{"id":"cbabbdf4c0ece489","type":"function","z":"948139bb1964bc5a","g":"2a7a5bd2ac8e1c46","name":"Prepare iOS Notification","func":"msg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : \"An error occurred while running backups\"\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":410,"y":3440,"wires":[["8ccc6e2bce0ab81f"]]},{"id":"8ccc6e2bce0ab81f","type":"link out","z":"948139bb1964bc5a","g":"2a7a5bd2ac8e1c46","name":"Battery Level Low, Send Notification","mode":"link","links":["b5bf4f1d2a2db4f8"],"x":615,"y":3440,"wires":[]},{"id":"1f6a899ad824a749","type":"function","z":"948139bb1964bc5a","g":"2a7a5bd2ac8e1c46","name":"Prepare/Store Persistant Notification","func":"msg.notification = { \n    data : {\n        \"title\"   : \"Backup Have Gone Stale\",\n        \"message\" : \"An error occurred while running backups. This should be resolved as soon as possible.\"\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":450,"y":3500,"wires":[["b9a65f55c429fd35"]]},{"id":"b9a65f55c429fd35","type":"link out","z":"948139bb1964bc5a","g":"2a7a5bd2ac8e1c46","name":"Leak Detected, Send Notification (Home Assistant)","mode":"link","links":["a2729e8ee4af65f5"],"x":685,"y":3500,"wires":[]},{"id":"d30a428d728762dd","type":"trigger-state","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Air Conditioner, Foyer","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"binary_sensor.leak_air_conditioner","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":180,"y":940,"wires":[["66022fb5265778ed"],[]]},{"id":"24c1d189ac8d12bd","type":"trigger-state","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Washing Machine, Laundry Room","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"binary_sensor.leak_washing_machine_laundry","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":210,"y":1000,"wires":[["66022fb5265778ed"],[]]},{"id":"fb7e0dafa51b5d69","type":"trigger-state","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Sink, Kitchen","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"binary_sensor.leak_sink_kitchen","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":150,"y":1060,"wires":[["66022fb5265778ed"],[]]},{"id":"d8c5e8e094766b97","type":"trigger-state","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Sink, Main Bathroom (His)","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"binary_sensor.leak_sink_main_bathroom_his","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":190,"y":1120,"wires":[["66022fb5265778ed"],[]]},{"id":"f1c151b5836bc3ae","type":"trigger-state","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Sink, Main Bathroom (Hers)","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"binary_sensor.leak_sink_main_bathroom_hers","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":200,"y":1180,"wires":[["66022fb5265778ed"],[]]},{"id":"5b4d341efd689529","type":"trigger-state","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Sink, Guest Bathroom","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"binary_sensor.leak_sink_guest_bathroom","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":180,"y":1240,"wires":[["66022fb5265778ed"],[]]},{"id":"a3a6997c7dba4a4c","type":"trigger-state","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Sink, Half Bathroom","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"binary_sensor.leak_sink_half_bathroom","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":170,"y":1300,"wires":[["66022fb5265778ed"],[]]},{"id":"11f8bc649bee4ded","type":"e-mail","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","server":"smtp.gmail.com","port":"465","secure":true,"tls":true,"name":"casamaxson+homeassistant@gmail.com","dname":"","x":1080,"y":1120,"wires":[]},{"id":"17e807837ca65f6b","type":"function","z":"948139bb1964bc5a","g":"931f2c0cfb587811","name":"Prepare iOS Notification","func":"msg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : \"Gate access code: 1845\\nPress 9 when your telephone rings\"\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":450,"y":3080,"wires":[["cf5b15aa2245e096"]]},{"id":"cf5b15aa2245e096","type":"link out","z":"948139bb1964bc5a","g":"931f2c0cfb587811","name":"Tom Arrives at Borgata, Send Notification","mode":"link","links":["b5bf4f1d2a2db4f8"],"x":635,"y":3080,"wires":[]},{"id":"a7d7b0b570ba854d","type":"inject","z":"948139bb1964bc5a","g":"931f2c0cfb587811","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":220,"y":3020,"wires":[["17e807837ca65f6b"]]},{"id":"bf8f7ff097449bb7","type":"comment","z":"948139bb1964bc5a","g":"2a7a5bd2ac8e1c46","name":"----- Backups Gone Stale, Send Notification -----","info":"","x":260,"y":3380,"wires":[]},{"id":"d61cb9f373232fee","type":"function","z":"948139bb1964bc5a","g":"931f2c0cfb587811","name":"Prepare iOS Notification","func":"msg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : \"Gate access code: 1844\\nPress 9 when your telephone rings\"\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":450,"y":3240,"wires":[["f26119da3f5552c2"]]},{"id":"4e4f06733134eff5","type":"inject","z":"948139bb1964bc5a","g":"931f2c0cfb587811","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":220,"y":3180,"wires":[["d61cb9f373232fee"]]},{"id":"f26119da3f5552c2","type":"link out","z":"948139bb1964bc5a","g":"931f2c0cfb587811","name":"Jess Arrives at Borgata, Send Notification","mode":"link","links":["eb19baaad61d9a94"],"x":635,"y":3240,"wires":[]},{"id":"444f17c4a559c495","type":"ha-zone","z":"948139bb1964bc5a","g":"931f2c0cfb587811","name":"Tom Arrives at Borgata","server":"1040bb61.673d75","version":0,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entities":["person.thomas"],"event":"enter","zones":["zone.borgata"],"x":180,"y":3080,"wires":[["17e807837ca65f6b"]]},{"id":"066e5bd8f0eb8948","type":"ha-zone","z":"948139bb1964bc5a","g":"931f2c0cfb587811","name":"Jess Arrives at Borgata","server":"1040bb61.673d75","version":0,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entities":["person.jessica"],"event":"enter","zones":["zone.borgata"],"x":180,"y":3240,"wires":[["d61cb9f373232fee"]]},{"id":"f69152fd9615e388","type":"function","z":"948139bb1964bc5a","g":"b4dea0a7c8b7a32a","name":"Prepare Email Notification","func":"const d = new Date();\nconst h = d.getHours();\nconst m = d.getMinutes();\n \nconst entity_id = msg.data.entity_id;\nconst gHomeAssistant = global.get(\"homeassistant\").homeAssistant;\n\nconst name = gHomeAssistant.states[ entity_id ].attributes.friendly_name;\n\nmsg = { \n    \"topic\"   : \"WARNING! Water Detected at Home.\",\n    \"payload\" : \"The \" + name + \" has detected the presence of water at\" + h + \":\" + m,\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":750,"y":1120,"wires":[["11f8bc649bee4ded"]]},{"id":"7118a48e68688bb8","type":"comment","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"----- Temperature to High for Device -----","info":"","x":260,"y":2420,"wires":[]},{"id":"b365d449119baa70","type":"server-state-changed","z":"948139bb1964bc5a","d":true,"g":"7fbcda953d53c56b","name":"Freezer Temperature OVER 10°, for Greater Than 15 Minutes","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.temp_freezer_temperature","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"10","halt_if_type":"num","halt_if_compare":"gte","outputs":2,"output_only_on_state_change":true,"for":"15","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":320,"y":2480,"wires":[["2882055dd098430e"],[]]},{"id":"932e85ab244d80e2","type":"function","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Prepare iOS Notification","func":"const degrees = msg.payload;\n\nmsg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : \"The kitchen freezer is currently at \" + degrees + \"°, and has been over 10° for longer than 15 minutes.\"\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":2480,"wires":[["df33dbf3fdbae692"]]},{"id":"df33dbf3fdbae692","type":"link out","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Battery Level Low, Send Notification","mode":"link","links":["b5bf4f1d2a2db4f8","eb19baaad61d9a94"],"x":1115,"y":2480,"wires":[]},{"id":"6a042d145daea3b0","type":"function","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Prepare iOS Notification","func":"const degrees = msg.payload;\n\nmsg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : \"The kitchen refrigerator is currently at \" + degrees + \"°, and has been over 50° for longer than 15 minutes.\"\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":2700,"wires":[["36bdebec6ee91fe3"]]},{"id":"36bdebec6ee91fe3","type":"link out","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Battery Level Low, Send Notification","mode":"link","links":["b5bf4f1d2a2db4f8","eb19baaad61d9a94"],"x":1115,"y":2700,"wires":[]},{"id":"e975ca0adb158f5f","type":"inject","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Trigger: 16°","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"16","payloadType":"num","x":470,"y":2540,"wires":[["932e85ab244d80e2","ee5f7ac9c43720cd","0854fbd251b10ead"]]},{"id":"da23c347ee0484dc","type":"inject","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Trigger: 51°","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"51","payloadType":"num","x":470,"y":2760,"wires":[["6a042d145daea3b0","e288d2c91c14a96e","fe61967bf161f58f"]]},{"id":"f5810ad2a121d7f5","type":"server-state-changed","z":"948139bb1964bc5a","d":true,"g":"7fbcda953d53c56b","name":"Refrigerator Temperature OVER 50°, for Greater Than 15 Minutes","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.temp_refrigerator_temperature","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"50","halt_if_type":"num","halt_if_compare":"gte","outputs":2,"output_only_on_state_change":true,"for":"15","forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":310,"y":2700,"wires":[["4cfb653c1f115c2c"],[]]},{"id":"ee5f7ac9c43720cd","type":"function","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Prepare/Store Persistant Notification","func":"const degrees = msg.payload;\n\nmsg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : \"Warning! The kitchen freezer temperature is on the rise. It is currently at \" + degrees + \"°, and has been over 10° for longer than 15 minutes.\"\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":970,"y":2540,"wires":[["e641a7b231760ed2"]]},{"id":"e641a7b231760ed2","type":"link out","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Leak Detected, Send Notification (Home Assistant)","mode":"link","links":["a2729e8ee4af65f5"],"x":1205,"y":2540,"wires":[]},{"id":"e288d2c91c14a96e","type":"function","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Prepare/Store Persistant Notification","func":"const degrees = msg.payload;\n\nmsg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : \"Warning! The kitchen refrigerator temperature is on the rise. It is currently at \" + degrees + \"°, and has been over 50° for longer longer than 15 minutes.\"\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":970,"y":2760,"wires":[["189c2f3c3581250e"]]},{"id":"189c2f3c3581250e","type":"link out","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Leak Detected, Send Notification (Home Assistant)","mode":"link","links":["a2729e8ee4af65f5"],"x":1205,"y":2760,"wires":[]},{"id":"2882055dd098430e","type":"delay","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"20","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"allowrate":false,"outputs":1,"x":680,"y":2480,"wires":[["932e85ab244d80e2","ee5f7ac9c43720cd","0854fbd251b10ead"]]},{"id":"4cfb653c1f115c2c","type":"delay","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"20","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"allowrate":false,"outputs":1,"x":680,"y":2700,"wires":[["6a042d145daea3b0","e288d2c91c14a96e","fe61967bf161f58f"]]},{"id":"0854fbd251b10ead","type":"function","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Prepare Alexa Notification","func":"const degrees = msg.payload;\n\nmsg.notification = \"Warning! The kitchen freezer temperature is on the rise. It is currently at \" + degrees + \"°, and has been over 10° for longer than 15 minutes.\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":2600,"wires":[["b8f60790ac1aa5c6"]]},{"id":"b8f60790ac1aa5c6","type":"link out","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Leak Detected, Send Notification (Alexa)","mode":"link","links":["064a1785b9c6a8a0","e3f52efe96ae8364","f9e0b7ba2c681f39","fa75df9d99a78852","be632de7dd78d7db"],"x":1115,"y":2600,"wires":[]},{"id":"fe61967bf161f58f","type":"function","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Prepare Alexa Notification","func":"const degrees = msg.payload;\n\nmsg.notification = \"Warning! The kitchen refrigerator temperature is on the rise. It is currently at \" + degrees + \"°, and has been over 50° for longer than 15 minutes.\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":2820,"wires":[["1d4347f55d10d1e9"]]},{"id":"1d4347f55d10d1e9","type":"link out","z":"948139bb1964bc5a","g":"7fbcda953d53c56b","name":"Leak Detected, Send Notification (Alexa)","mode":"link","links":["064a1785b9c6a8a0","e3f52efe96ae8364","f9e0b7ba2c681f39","fa75df9d99a78852"],"x":1115,"y":2820,"wires":[]},{"id":"da2b881343195e9c","type":"api-current-state","z":"948139bb1964bc5a","g":"a2caccdf611fb758","name":"Is Snoozed for Today?","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.garage_left_open_snooze_today","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":640,"y":1520,"wires":[[],["8418555f93c7b98a"]]},{"id":"8418555f93c7b98a","type":"api-current-state","z":"948139bb1964bc5a","g":"a2caccdf611fb758","name":"Is Snoozed Indefinite?","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.garage_left_open_snooze_indefinite","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":640,"y":1600,"wires":[[],["2449ad9639bf3f31"]]},{"id":"448dbe97f92029d7","type":"link out","z":"948139bb1964bc5a","g":"40c745f7fabb9975","name":"Away Mode, Send Notification","mode":"link","links":["b5bf4f1d2a2db4f8"],"x":1135,"y":2140,"wires":[]},{"id":"6a929669d7f2694b","type":"comment","z":"948139bb1964bc5a","g":"40c745f7fabb9975","name":"----- Away Mode, Send Notification -----","info":"","x":250,"y":2020,"wires":[]},{"id":"721da16ca3f82f0d","type":"server-state-changed","z":"948139bb1964bc5a","d":true,"g":"40c745f7fabb9975","name":"Tom AWAY > 3 Hours","server":"1040bb61.673d75","version":4,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"person.thomas","entityidfiltertype":"exact","outputinitially":false,"state_type":"str","haltifstate":"not_home","halt_if_type":"str","halt_if_compare":"is","outputs":2,"output_only_on_state_change":true,"for":"3","forType":"num","forUnits":"hours","ignorePrevStateNull":false,"ignorePrevStateUnknown":true,"ignorePrevStateUnavailable":true,"ignoreCurrentStateUnknown":true,"ignoreCurrentStateUnavailable":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":380,"y":2220,"wires":[["c477dd8f123cf4b4"],[]]},{"id":"a0837a18db1ac99b","type":"function","z":"948139bb1964bc5a","g":"40c745f7fabb9975","name":"Prepare iOS Notification","func":"msg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : \"It looks like you're away from home.\\nWould you like to enable Away Mode?\",\n        \"data\"    : { \n            \"subtitle\": false,\n            \"actions\" : [\n                { \n                    action : \"VACATION_MODE_ON\",\n                    title  : \"Enable Away Mode\"\n                }\n            ]\n        }\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":950,"y":2140,"wires":[["448dbe97f92029d7"]]},{"id":"959662168f83597b","type":"bigtimer","z":"948139bb1964bc5a","d":true,"g":"40c745f7fabb9975","outtopic":"","outpayload1":"active","outpayload2":"inactive","name":"1 Hour Before Sunset","comment":"","lat":"26.305080","lon":"-80.197180","starttime":"5004","endtime":"10005","starttime2":0,"endtime2":0,"startoff":"-60","endoff":"-60","startoff2":0,"endoff2":0,"offs":0,"outtext1":"","outtext2":"","timeout":"2","sun":true,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":true,"jan":true,"feb":true,"mar":true,"apr":true,"may":true,"jun":true,"jul":true,"aug":true,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"day6":0,"month6":0,"day7":0,"month7":0,"day8":0,"month8":0,"day9":0,"month9":0,"day10":0,"month10":0,"day11":0,"month11":0,"day12":0,"month12":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"d6":0,"w6":0,"xday1":0,"xmonth1":0,"xday2":0,"xmonth2":0,"xday3":0,"xmonth3":0,"xday4":0,"xmonth4":0,"xday5":0,"xmonth5":0,"xday6":0,"xmonth6":0,"xday7":0,"xmonth7":0,"xday8":0,"xmonth8":0,"xday9":0,"xmonth9":0,"xday10":0,"xmonth10":0,"xday11":0,"xmonth11":0,"xday12":0,"xmonth12":0,"xd1":0,"xw1":0,"xd2":0,"xw2":0,"xd3":0,"xw3":0,"xd4":0,"xw4":0,"xd5":0,"xw5":0,"xd6":0,"xw6":0,"suspend":false,"random":false,"randon1":false,"randoff1":false,"randon2":false,"randoff2":false,"repeat":true,"atstart":true,"odd":false,"even":false,"x":200,"y":2140,"wires":[["3bce4a7095a297c0"],[],[]]},{"id":"a3d6a6fd4691c143","type":"inject","z":"948139bb1964bc5a","d":true,"g":"40c745f7fabb9975","name":"Trigger: ON","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":410,"y":2080,"wires":[["c477dd8f123cf4b4"]]},{"id":"ead72e2a1c648d87","type":"inject","z":"948139bb1964bc5a","g":"40c745f7fabb9975","name":"Trigger: OFF","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payloadType":"date","x":170,"y":2280,"wires":[["dc98c779025e2587"]]},{"id":"dc98c779025e2587","type":"api-current-state","z":"948139bb1964bc5a","g":"40c745f7fabb9975","name":"If Away Mode Flag is ON","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.home_away_mode","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":420,"y":2280,"wires":[["b837268a0c564ed7"],[]]},{"id":"b837268a0c564ed7","type":"api-call-service","z":"948139bb1964bc5a","g":"40c745f7fabb9975","name":"Turn Away Mode OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_off","areaId":[],"deviceId":[],"entityId":["input_boolean.home_away_mode"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":710,"y":2280,"wires":[[]]},{"id":"3bce4a7095a297c0","type":"api-current-state","z":"948139bb1964bc5a","g":"40c745f7fabb9975","name":"AWAY > 1","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"not_home","halt_if_type":"str","halt_if_compare":"is","entity_id":"person.thomas","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":"1","forType":"num","forUnits":"hours","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":420,"y":2140,"wires":[["c477dd8f123cf4b4"],[]]},{"id":"c477dd8f123cf4b4","type":"api-current-state","z":"948139bb1964bc5a","g":"40c745f7fabb9975","name":"If Away Mode Flag is OFF","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"off","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.home_away_mode","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","x":660,"y":2140,"wires":[["a0837a18db1ac99b"],[]]},{"id":"26970241b0954a94","type":"comment","z":"948139bb1964bc5a","g":"52a2267cd3f77359","name":"----- Low Battery Level for Devices, Send Notification -----","info":"","x":290,"y":1760,"wires":[]},{"id":"9b8508b0edc4f55a","type":"inject","z":"948139bb1964bc5a","g":"52a2267cd3f77359","name":"Trigger: START","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payloadType":"date","x":380,"y":1820,"wires":[["81582b29.b2e13"]]},{"id":"5d4cdfd4257f70e7","type":"link out","z":"948139bb1964bc5a","g":"52a2267cd3f77359","name":"Battery Level Low, Send Notification","mode":"link","links":["b5bf4f1d2a2db4f8","eb19baaad61d9a94"],"x":1195,"y":1880,"wires":[]},{"id":"293b8bc84ea48dde","type":"bigtimer","z":"948139bb1964bc5a","g":"52a2267cd3f77359","outtopic":"","outpayload1":"active","outpayload2":"inactive","name":"Twice Daily (8 am/pm)","comment":"","lat":"26.305080","lon":"-80.197180","starttime":"480","endtime":"10001","starttime2":"1200","endtime2":"10001","startoff":"0","endoff":"0","startoff2":0,"endoff2":0,"offs":0,"outtext1":"","outtext2":"","timeout":"2","sun":true,"mon":true,"tue":true,"wed":true,"thu":true,"fri":true,"sat":true,"jan":true,"feb":true,"mar":true,"apr":true,"may":true,"jun":true,"jul":true,"aug":true,"sep":true,"oct":true,"nov":true,"dec":true,"day1":0,"month1":0,"day2":0,"month2":0,"day3":0,"month3":0,"day4":0,"month4":0,"day5":0,"month5":0,"day6":0,"month6":0,"day7":0,"month7":0,"day8":0,"month8":0,"day9":0,"month9":0,"day10":0,"month10":0,"day11":0,"month11":0,"day12":0,"month12":0,"d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"d6":0,"w6":0,"xday1":0,"xmonth1":0,"xday2":0,"xmonth2":0,"xday3":0,"xmonth3":0,"xday4":0,"xmonth4":0,"xday5":0,"xmonth5":0,"xday6":0,"xmonth6":0,"xday7":0,"xmonth7":0,"xday8":0,"xmonth8":0,"xday9":0,"xmonth9":0,"xday10":0,"xmonth10":0,"xday11":0,"xmonth11":0,"xday12":0,"xmonth12":0,"xd1":0,"xw1":0,"xd2":0,"xw2":0,"xd3":0,"xw3":0,"xd4":0,"xw4":0,"xd5":0,"xw5":0,"xd6":0,"xw6":0,"suspend":false,"random":false,"randon1":false,"randoff1":false,"randon2":false,"randoff2":false,"repeat":true,"atstart":true,"odd":false,"even":false,"x":180,"y":1880,"wires":[["aac23615626ff38d"],[],[]]},{"id":"aac23615626ff38d","type":"switch","z":"948139bb1964bc5a","g":"52a2267cd3f77359","name":"Is Active?","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"active","vt":"str"},{"t":"eq","v":"inactive","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":400,"y":1880,"wires":[[],[]]},{"id":"c8f53c61458fb9a4","type":"function","z":"948139bb1964bc5a","g":"52a2267cd3f77359","name":"Prepare iOS Notification","func":"const name = msg.payload.attributes.friendly_name;\nconst percent = msg.battery_level;\n\nmsg.notification = { \n    data : {\n        \"title\"   : \"Home Assistant\",\n        \"message\" : name + \" has dropped to \" + percent + \"%\"\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1010,"y":1880,"wires":[["5d4cdfd4257f70e7"]]},{"id":"aa0f8898cfe55c10","type":"function","z":"948139bb1964bc5a","g":"52a2267cd3f77359","name":"Prepare Battery Level","func":"const batteryLevelAttr = msg.payload.attributes && msg.payload.attributes['Battery Level'];\n\nconst state = !isNaN( batteryLevelAttr ) ? batteryLevelAttr : msg.payload.state;\n\nmsg.battery_level = parseInt( state );\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":840,"y":1800,"wires":[["611774d0fbc82adc"]]},{"id":"611774d0fbc82adc","type":"switch","z":"948139bb1964bc5a","g":"52a2267cd3f77359","name":"","property":"battery_level","propertyType":"msg","rules":[{"t":"lte","v":"40","vt":"str"},{"t":"gt","v":"40","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":790,"y":1880,"wires":[["c8f53c61458fb9a4"],[]]},{"id":"81582b29.b2e13","type":"ha-get-entities","z":"948139bb1964bc5a","g":"52a2267cd3f77359","name":"Get Batteries","server":"1040bb61.673d75","version":0,"rules":[{"property":"attributes.device_class","logic":"is","value":"battery","valueType":"str"},{"property":"entity_id","logic":"is_not","value":"sensor.iphone_tom_battery_level","valueType":"str"},{"property":"entity_id","logic":"is_not","value":"sensor.jessica_maxson_s_iphone_battery_level","valueType":"str"},{"property":"entity_id","logic":"is_not","value":"sensor.fire_tablet_battery_level","valueType":"str"}],"output_type":"split","output_empty_results":false,"output_location_type":"msg","output_location":"payload","output_results_count":1,"x":590,"y":1880,"wires":[["aa0f8898cfe55c10"]]},{"id":"046f6c6c85c10a7a","type":"comment","z":"4e1d02e135536c14","name":"----- Send iOS Notification -----","info":"","x":210,"y":260,"wires":[]},{"id":"b5bf4f1d2a2db4f8","type":"link in","z":"4e1d02e135536c14","g":"f7b26ea9f0e17e65","name":"Send Tom Notification","links":["23c6f469513289a8","397ff9e3b9d07cce","5d4cdfd4257f70e7","6b25673ada107590","8519b53052fc2bae","a31261dfa8eb55bc","a8e6cda928e350b6","9a58ea725bad51e8","8ccc6e2bce0ab81f","1f3d679062bc9586","2bd12a1dd8e20657","cf5b15aa2245e096","d65a5827c0ebf8ea","94b951beea382203","d7fe738ca8eec46e","c7d5193aab28b69c","df33dbf3fdbae692","36bdebec6ee91fe3","3d43058192ab614d","eb1c9f2fdfe9dc38","448dbe97f92029d7","2781722cd1505d5c"],"x":115,"y":680,"wires":[["92896d09a2191b53"]]},{"id":"9aa3882e80e1b6ad","type":"api-current-state","z":"4e1d02e135536c14","g":"f7b26ea9f0e17e65","name":"Check: HE Can Recieve","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.app_notify_tom","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":310,"y":760,"wires":[["acaaaba2e5cf897f"],[]]},{"id":"5cf6c389a5ca2ed2","type":"api-call-service","z":"4e1d02e135536c14","g":"f7b26ea9f0e17e65","name":"Send Notification","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"notify","service":"mobile_app_ckretajints_iphone","areaId":[],"deviceId":[],"entityId":[],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":590,"y":760,"wires":[["2906bc08a146bc76"]]},{"id":"2906bc08a146bc76","type":"debug","z":"4e1d02e135536c14","g":"f7b26ea9f0e17e65","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":810,"y":680,"wires":[]},{"id":"eb19baaad61d9a94","type":"link in","z":"4e1d02e135536c14","g":"a7d2737d0af97dc5","name":"Send Jess Notification","links":["213badb99c2e4697","5d4cdfd4257f70e7","397ff9e3b9d07cce","a31261dfa8eb55bc","8519b53052fc2bae","c22b1370e1f46261","55209416c152f1d4","a8e6cda928e350b6","ee06a6e23d816727","9a58ea725bad51e8","1f3d679062bc9586","2bd12a1dd8e20657","f26119da3f5552c2","d65a5827c0ebf8ea","94b951beea382203","c7d5193aab28b69c","df33dbf3fdbae692","36bdebec6ee91fe3","3d43058192ab614d","eb1c9f2fdfe9dc38"],"x":95,"y":400,"wires":[["31f547857960080c"]]},{"id":"31f547857960080c","type":"api-current-state","z":"4e1d02e135536c14","g":"a7d2737d0af97dc5","name":"Check: ALL Can Recieve","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.app_notify","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":290,"y":400,"wires":[["b9e3518ae89a2aa3"],[]]},{"id":"b9e3518ae89a2aa3","type":"api-current-state","z":"4e1d02e135536c14","g":"a7d2737d0af97dc5","name":"Check: SHE Can Recieve","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.app_notify_jess","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":290,"y":480,"wires":[["c27893a6aa3d06a5"],[]]},{"id":"2a99f9bbd9a83d47","type":"api-call-service","z":"4e1d02e135536c14","g":"a7d2737d0af97dc5","name":"Send Notification","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"notify","service":"mobile_app_jess_iphone","areaId":[],"deviceId":[],"entityId":[],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":570,"y":480,"wires":[["44b0cb3beaf052c5"]]},{"id":"44b0cb3beaf052c5","type":"debug","z":"4e1d02e135536c14","g":"a7d2737d0af97dc5","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":790,"y":400,"wires":[]},{"id":"e4754a95609a8baa","type":"server-events","z":"4e1d02e135536c14","g":"0d3a64265ec09852","name":"Garage Door iOS Actions","server":"1040bb61.673d75","version":1,"event_type":"ios.notification_action_fired","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"},{"property":"event_type","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"}],"x":190,"y":1740,"wires":[["4c5fa8f19276f614"]]},{"id":"4c5fa8f19276f614","type":"switch","z":"4e1d02e135536c14","g":"0d3a64265ec09852","name":"Action Selected","property":"payload.event.actionName","propertyType":"msg","rules":[{"t":"eq","v":"GARAGE_DOOR_OPEN","vt":"str"},{"t":"eq","v":"GARAGE_DOOR_CLOSE","vt":"str"},{"t":"eq","v":"GARAGE_DOOR_SNOOZE_TODAY","vt":"str"},{"t":"eq","v":"GARAGE_DOOR_SNOOZE_INDEFINITE","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":440,"y":1740,"wires":[["a4c20c7ee5f47897"],["7b53b32ba035cdb3"],["e08ed68555da4b82"],["9842fe79057cd998"]]},{"id":"a4c20c7ee5f47897","type":"api-call-service","z":"4e1d02e135536c14","g":"0d3a64265ec09852","name":"Garage Door: OPEN","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"cover","service":"close_cover","areaId":[],"deviceId":[],"entityId":["cover.garage_door"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":680,"y":1740,"wires":[["6e24d360031a0fbd"]]},{"id":"7b53b32ba035cdb3","type":"api-call-service","z":"4e1d02e135536c14","g":"0d3a64265ec09852","name":"Garage Door: CLOSE","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"cover","service":"close_cover","areaId":[],"deviceId":[],"entityId":["cover.garage_door"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":680,"y":1800,"wires":[["6e24d360031a0fbd"]]},{"id":"6e24d360031a0fbd","type":"debug","z":"4e1d02e135536c14","g":"0d3a64265ec09852","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":910,"y":1740,"wires":[]},{"id":"2248c3bddab232ab","type":"server-events","z":"4e1d02e135536c14","g":"c27b37bacfd81b8e","name":"Doorbell Motion iOS Actions","server":"1040bb61.673d75","version":1,"event_type":"ios.notification_action_fired","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"},{"property":"event_type","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"}],"x":200,"y":2120,"wires":[["daef73369d61fe35"]]},{"id":"daef73369d61fe35","type":"switch","z":"4e1d02e135536c14","g":"c27b37bacfd81b8e","name":"Action Selected","property":"payload.event.actionName","propertyType":"msg","rules":[{"t":"eq","v":"DOORBELL_SNOOZE_A","vt":"str"},{"t":"eq","v":"DOORBELL_SNOOZE_B","vt":"str"},{"t":"eq","v":"DOORBELL_SNOOZE_C","vt":"str"},{"t":"eq","v":"DOORBELL_SNOOZE_D","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":460,"y":2120,"wires":[["abc34d2a8e6579a2"],["331ce6dccb637eac"],["e4a57b73ba4e22dd"],["46ebda7d20107695"]]},{"id":"abc34d2a8e6579a2","type":"api-call-service","z":"4e1d02e135536c14","g":"c27b37bacfd81b8e","name":"Snooze: 30 MINUTES","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"timer","service":"start","areaId":[],"deviceId":[],"entityId":["timer.doorbell_motion_snooze"],"data":"{\"duration\":\"00:00:30\"}","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":700,"y":2120,"wires":[["cfa47ef66a12662e"]]},{"id":"331ce6dccb637eac","type":"api-call-service","z":"4e1d02e135536c14","g":"c27b37bacfd81b8e","name":"Snooze: 1 HOUR","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"timer","service":"start","areaId":[],"deviceId":[],"entityId":["timer.doorbell_motion_snooze"],"data":"{\"duration\":\"01:00:00\"}","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":2180,"wires":[["cfa47ef66a12662e"]]},{"id":"9802069d87a1a750","type":"comment","z":"4e1d02e135536c14","g":"c27b37bacfd81b8e","name":"----- Doorbell Motion iOS Actions -----","info":"","x":230,"y":2060,"wires":[]},{"id":"e4a57b73ba4e22dd","type":"api-call-service","z":"4e1d02e135536c14","g":"c27b37bacfd81b8e","name":"Snooze: TODAY","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_on","areaId":[],"deviceId":[],"entityId":["input_boolean.doorbell_motion_snooze_today"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":680,"y":2240,"wires":[["cfa47ef66a12662e"]]},{"id":"92896d09a2191b53","type":"api-current-state","z":"4e1d02e135536c14","g":"f7b26ea9f0e17e65","name":"Check: ALL Can Recieve","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.app_notify","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":310,"y":680,"wires":[["9aa3882e80e1b6ad"],[]]},{"id":"cfa47ef66a12662e","type":"debug","z":"4e1d02e135536c14","g":"c27b37bacfd81b8e","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":930,"y":2120,"wires":[]},{"id":"a2729e8ee4af65f5","type":"link in","z":"4e1d02e135536c14","g":"ac8b5c16b46e9c89","name":"Send Persistant Home Assistant Notification","links":["e0b6b365e87fb6b5","b9a65f55c429fd35","e641a7b231760ed2","189c2f3c3581250e","efebe7b287125af2"],"x":95,"y":140,"wires":[["34c20fee04f5acb2"]]},{"id":"634407b9c4245106","type":"api-call-service","z":"4e1d02e135536c14","g":"ac8b5c16b46e9c89","name":"Send Persistant Notification","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"persistent_notification","service":"create","areaId":[],"deviceId":[],"entityId":[],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":540,"y":140,"wires":[["e9187377527269cb"]]},{"id":"e9187377527269cb","type":"debug","z":"4e1d02e135536c14","g":"ac8b5c16b46e9c89","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":770,"y":140,"wires":[]},{"id":"23bf231d5f92d898","type":"link in","z":"4e1d02e135536c14","g":"09e750898cfc8b60","name":"Send Audible Notification, RECIEVER (DO NOT SEND TO)","links":["06d2f5e90b465001","3a01748301fe8498","915f38fb1e724141","d892463cc91098f1","e4967201c6355ab0","e6130a39a2ab366a"],"x":115,"y":1000,"wires":[["5c045c6f71cafd52"]]},{"id":"8a0b2594a3296c88","type":"comment","z":"4e1d02e135536c14","g":"09e750898cfc8b60","name":"----- Send Alexa Notification -----","info":"","x":230,"y":940,"wires":[]},{"id":"a62008d8914b95a2","type":"comment","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"----- Echo, Kitchen -----","info":"","x":200,"y":1120,"wires":[]},{"id":"1d6d45ce35d1f8fb","type":"comment","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"----- Echo Dot, Bedroom 1 (Main) -----","info":"","x":250,"y":1280,"wires":[]},{"id":"fa75df9d99a78852","type":"link in","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Send Audible Notification, KITCHEN","links":["8be476363dfd33d3","2d78febda41962f1","b8f60790ac1aa5c6","1d4347f55d10d1e9"],"x":115,"y":1180,"wires":[["d86681ccbd79c9f3"]]},{"id":"8363ca529c5b4620","type":"comment","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"----- Echo Dot, Bedroom 2 (Guest) -----","info":"","x":730,"y":1280,"wires":[]},{"id":"a425ce3a062da4e5","type":"comment","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"----- Echo Dot, Bedroom 3 (Office, Hers) -----","info":"","x":270,"y":1440,"wires":[]},{"id":"d717b7d40b9afdf5","type":"comment","z":"4e1d02e135536c14","g":"a7d2737d0af97dc5","name":"----- Jessica iPhone App Notifcation -----","info":"","x":240,"y":340,"wires":[]},{"id":"79cffc2277e844a8","type":"comment","z":"4e1d02e135536c14","g":"f7b26ea9f0e17e65","name":"----- iPhone App Notifcation -----","info":"","x":220,"y":620,"wires":[]},{"id":"acaaaba2e5cf897f","type":"change","z":"4e1d02e135536c14","g":"f7b26ea9f0e17e65","name":"Setup Notification","rules":[{"t":"delete","p":"payload","pt":"msg"},{"t":"set","p":"payload","pt":"msg","to":"notification","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":590,"y":680,"wires":[["5cf6c389a5ca2ed2"]]},{"id":"c27893a6aa3d06a5","type":"change","z":"4e1d02e135536c14","g":"a7d2737d0af97dc5","name":"Setup Notification","rules":[{"t":"delete","p":"payload","pt":"msg"},{"t":"set","p":"payload","pt":"msg","to":"notification","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":570,"y":400,"wires":[["2a99f9bbd9a83d47"]]},{"id":"8a1a871a9a68c76c","type":"function","z":"4e1d02e135536c14","g":"09e750898cfc8b60","name":"Setup Notification","func":"msg.payload = {\n    data : {\n        \"message\"      : msg.notification,\n        \"data\"         : { \n            \"type\" : \"announce\",\n            \"volume_level\" : msg.volume_level.new\n        },\n        \"target\"       : [ msg.alexa_device ]\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":570,"y":940,"wires":[["dddf15f421481e85"]]},{"id":"dddf15f421481e85","type":"api-call-service","z":"4e1d02e135536c14","g":"09e750898cfc8b60","name":"Send Notification","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"notify","service":"alexa_media","areaId":[],"deviceId":[],"entityId":[],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"data"}],"queue":"none","x":590,"y":1000,"wires":[["9a29585104596ba7"]]},{"id":"9a29585104596ba7","type":"delay","z":"4e1d02e135536c14","g":"09e750898cfc8b60","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"allowrate":false,"outputs":1,"x":800,"y":1000,"wires":[["17b416995544c0ca"]]},{"id":"05df8139c9f6130f","type":"api-call-service","z":"4e1d02e135536c14","g":"09e750898cfc8b60","name":"MODIFY Volume Level","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"media_player","service":"volume_set","areaId":[],"deviceId":[],"entityId":["{{alexa_device}}"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1040,"y":1000,"wires":[["914500a98f1597b0"]]},{"id":"914500a98f1597b0","type":"debug","z":"4e1d02e135536c14","g":"09e750898cfc8b60","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1250,"y":1000,"wires":[]},{"id":"fd82a36789e9f0fd","type":"function","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Setup Device Data","func":"const gHomeAssistant = global.get(\"homeassistant\").homeAssistant;\nconst device = \"media_player.echo_dot_bedroom_3\";\n\nmsg.alexa_device = device;\nmsg.volume_level = { \n    \"old\" : gHomeAssistant.states[ device ].attributes.volume_level,\n    \"new\" :  0.5\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":290,"y":1500,"wires":[["3a01748301fe8498"]]},{"id":"f9e0b7ba2c681f39","type":"link in","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Send Audible Notification, BEDROOM 1 (MAIN)","links":["8be476363dfd33d3","2d78febda41962f1","b8f60790ac1aa5c6","1d4347f55d10d1e9"],"x":115,"y":1340,"wires":[["85de72e04aaa2de6"]]},{"id":"3a01748301fe8498","type":"link out","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Send Audible Notification","mode":"link","links":["23bf231d5f92d898"],"x":455,"y":1500,"wires":[]},{"id":"c722151add88f640","type":"function","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Setup Device Data","func":"const gHomeAssistant = global.get(\"homeassistant\").homeAssistant;\nconst device = \"media_player.echo_dot_bedroom_2\";\n\nmsg.alexa_device = device;\nmsg.volume_level = { \n    \"old\" : gHomeAssistant.states[ device ].attributes.volume_level,\n    \"new\" :  0.5\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":1340,"wires":[["e4967201c6355ab0"]]},{"id":"b9fb615b89979085","type":"link in","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Send Audible Notification, BEDROOM 2 (GUEST)","links":[],"x":595,"y":1340,"wires":[["c722151add88f640"]]},{"id":"e4967201c6355ab0","type":"link out","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Send Audible Notification","mode":"link","links":["23bf231d5f92d898"],"x":935,"y":1340,"wires":[]},{"id":"85de72e04aaa2de6","type":"function","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Setup Device Data","func":"const gHomeAssistant = global.get(\"homeassistant\").homeAssistant;\nconst device = \"media_player.echo_dot_bedroom_1\";\n\nmsg.alexa_device = device;\nmsg.volume_level = { \n    \"old\" : gHomeAssistant.states[ device ].attributes.volume_level,\n    \"new\" :  0.5\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":290,"y":1340,"wires":[["d892463cc91098f1"]]},{"id":"d892463cc91098f1","type":"link out","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Send Audible Notification","mode":"link","links":["23bf231d5f92d898"],"x":455,"y":1340,"wires":[]},{"id":"915f38fb1e724141","type":"link out","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Send Audible Notification","mode":"link","links":["23bf231d5f92d898"],"x":455,"y":1180,"wires":[]},{"id":"d86681ccbd79c9f3","type":"function","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Setup Device Data","func":"const gHomeAssistant = global.get(\"homeassistant\").homeAssistant;\nconst device = \"media_player.echo_kitchen\";\n\nmsg.alexa_device = device;\nmsg.volume_level = { \n    \"old\" : gHomeAssistant.states[ device ].attributes.volume_level,\n    \"new\" :  0.7\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":290,"y":1180,"wires":[["915f38fb1e724141"]]},{"id":"4c26de52a53acb79","type":"comment","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"----- Echo Dot, Dining Room -----","info":"","x":710,"y":1120,"wires":[]},{"id":"064a1785b9c6a8a0","type":"link in","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Send Audible Notification, BEDROOM 3 (OFFICE, HERS)","links":["8be476363dfd33d3","2d78febda41962f1","b8f60790ac1aa5c6","1d4347f55d10d1e9"],"x":115,"y":1500,"wires":[["fd82a36789e9f0fd"]]},{"id":"d0dc2e32d91cc767","type":"comment","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"----- Echo Dot, Bedroom 4 (Office, His) -----","info":"","x":750,"y":1440,"wires":[]},{"id":"30a58835931e351d","type":"function","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Setup Device Data","func":"const gHomeAssistant = global.get(\"homeassistant\").homeAssistant;\nconst device = \"media_player.echo_dot_bedroom_4\";\n\nmsg.alexa_device = device;\nmsg.volume_level = { \n    \"old\" : gHomeAssistant.states[ device ].attributes.volume_level,\n    \"new\" :  0.5\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":1500,"wires":[["e6130a39a2ab366a"]]},{"id":"e6130a39a2ab366a","type":"link out","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Send Audible Notification","mode":"link","links":["23bf231d5f92d898"],"x":935,"y":1500,"wires":[]},{"id":"e3f52efe96ae8364","type":"link in","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Send Audible Notification, BEDROOM 4 (OFFICE, HIS)","links":["8be476363dfd33d3","2d78febda41962f1","b8f60790ac1aa5c6","1d4347f55d10d1e9"],"x":595,"y":1500,"wires":[["30a58835931e351d"]]},{"id":"ef5c926b3d1b7d84","type":"comment","z":"4e1d02e135536c14","g":"ac8b5c16b46e9c89","name":"----- Send Home Assistant Persistent Notification -----","info":"","x":280,"y":80,"wires":[]},{"id":"34c20fee04f5acb2","type":"change","z":"4e1d02e135536c14","g":"ac8b5c16b46e9c89","name":"Setup Notification","rules":[{"t":"delete","p":"payload","pt":"msg"},{"t":"set","p":"payload","pt":"msg","to":"notification","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":270,"y":140,"wires":[["634407b9c4245106"]]},{"id":"b9d4c31f4c3cc017","type":"link in","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Send Audible Notification, DINING ROOM","links":[],"x":595,"y":1180,"wires":[["42fa0ba60aff98c6"]]},{"id":"42fa0ba60aff98c6","type":"function","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Setup Device Data","func":"const gHomeAssistant = global.get(\"homeassistant\").homeAssistant;\nconst device = \"media_player.echo_dining_room\";\n\nmsg.alexa_device = device;\nmsg.volume_level = { \n    \"old\" : gHomeAssistant.states[ device ].attributes.volume_level,\n    \"new\" :  0.6\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":1180,"wires":[["06d2f5e90b465001"]]},{"id":"06d2f5e90b465001","type":"link out","z":"4e1d02e135536c14","g":"c4be9eb3db479d51","name":"Send Audible Notification","mode":"link","links":["23bf231d5f92d898"],"x":935,"y":1180,"wires":[]},{"id":"5c045c6f71cafd52","type":"api-current-state","z":"4e1d02e135536c14","g":"09e750898cfc8b60","name":"Check: Devices Can Speak","server":"1040bb61.673d75","version":3,"outputs":2,"halt_if":"on","halt_if_type":"str","halt_if_compare":"is","entity_id":"input_boolean.audible_notifications_johan","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"for":0,"forType":"num","forUnits":"minutes","override_topic":false,"state_location":"payload","override_payload":"msg","entity_location":"data","override_data":"msg","x":300,"y":1000,"wires":[["8a1a871a9a68c76c"],[]]},{"id":"17b416995544c0ca","type":"function","z":"4e1d02e135536c14","g":"09e750898cfc8b60","name":"Setup Volume","func":"msg.payload = {\n    data : {\n        \"volume_level\" : msg.volume_level.old\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1000,"y":940,"wires":[["05df8139c9f6130f"]]},{"id":"46ebda7d20107695","type":"api-call-service","z":"4e1d02e135536c14","g":"c27b37bacfd81b8e","name":"Snooze: INDEFINITELY","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_on","areaId":[],"deviceId":[],"entityId":["input_boolean.doorbell_motion_snooze_indefinite"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":710,"y":2300,"wires":[["cfa47ef66a12662e"]]},{"id":"58d39ac25a967346","type":"comment","z":"4e1d02e135536c14","g":"0d3a64265ec09852","name":"----- Garage Door iOS Actions -----","info":"","x":220,"y":1680,"wires":[]},{"id":"dc5c6a3cf1f36edd","type":"comment","z":"4e1d02e135536c14","g":"40db6052de5b63de","name":"----- Away Mode iOS Actions -----","info":"","x":230,"y":2440,"wires":[]},{"id":"c5ecd5198894a738","type":"server-events","z":"4e1d02e135536c14","g":"40db6052de5b63de","name":"Away Mode iOS Actions","server":"1040bb61.673d75","version":1,"event_type":"ios.notification_action_fired","exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"waitForRunning":true,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"},{"property":"event_type","propertyType":"msg","value":"$outputData(\"eventData\").event_type","valueType":"jsonata"}],"x":200,"y":2500,"wires":[["9c5653e8a90c95e0"]]},{"id":"9c5653e8a90c95e0","type":"switch","z":"4e1d02e135536c14","g":"40db6052de5b63de","name":"Action Selected","property":"payload.event.actionName","propertyType":"msg","rules":[{"t":"eq","v":"VACATION_MODE_ON","vt":"str"},{"t":"eq","v":"VACATION_MODE_OFF","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":450,"y":2500,"wires":[["420cb61e6f9134cb"],["acc1c2bbdc58ad22"]]},{"id":"420cb61e6f9134cb","type":"api-call-service","z":"4e1d02e135536c14","g":"40db6052de5b63de","name":"Away Mode: ON","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_on","areaId":[],"deviceId":[],"entityId":["input_boolean.home_away_mode"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":680,"y":2500,"wires":[["1d49619462c6119c"]]},{"id":"1d49619462c6119c","type":"debug","z":"4e1d02e135536c14","g":"40db6052de5b63de","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":890,"y":2500,"wires":[]},{"id":"acc1c2bbdc58ad22","type":"api-call-service","z":"4e1d02e135536c14","g":"40db6052de5b63de","name":"Away Mode: OFF","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_off","areaId":[],"deviceId":[],"entityId":["input_boolean.home_away_mode"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":690,"y":2560,"wires":[["1d49619462c6119c"]]},{"id":"e08ed68555da4b82","type":"api-call-service","z":"4e1d02e135536c14","g":"0d3a64265ec09852","name":"Snooze: TODAY","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_on","areaId":[],"deviceId":[],"entityId":["input_boolean.garage_left_open_snooze_today"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":660,"y":1860,"wires":[["6e24d360031a0fbd"]]},{"id":"9842fe79057cd998","type":"api-call-service","z":"4e1d02e135536c14","g":"0d3a64265ec09852","name":"Snooze: INDEFINITE","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"input_boolean","service":"turn_on","areaId":[],"deviceId":[],"entityId":["input_boolean.garage_left_open_snooze_indefinite"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":680,"y":1920,"wires":[["6e24d360031a0fbd"]]},{"id":"995c225c75538054","type":"comment","z":"81dea24119402f3d","g":"8806b584b745745a","name":"----- Set Default Values When Turned On -----","info":"","x":250,"y":620,"wires":[]},{"id":"78328d42.dfbd24","type":"comment","z":"81dea24119402f3d","name":"----- Circadian (Adaptive Lighting) Routines -----","info":"","x":260,"y":100,"wires":[]},{"id":"a7bca137.c0d2f","type":"comment","z":"81dea24119402f3d","name":"----- Update Home Assistant Entities -----","info":"","x":240,"y":140,"wires":[]},{"id":"4c3673c951e9d7b9","type":"ha-entity","z":"81dea24119402f3d","name":"SET SENSOR: Brightness in Percent","server":"1040bb61.673d75","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"nr_circadian_brightness"},{"property":"device_class","value":""},{"property":"icon","value":"mdi:brightness-percent"},{"property":"unit_of_measurement","value":"%"},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"payload","stateType":"msg","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"","outputPayloadType":"str","x":1050,"y":380,"wires":[[]]},{"id":"c3c756d436a23c64","type":"ha-entity","z":"81dea24119402f3d","name":"SET SENSOR: Color Temp in Mireds","server":"1040bb61.673d75","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"nr_circadian_mireds"},{"property":"device_class","value":""},{"property":"icon","value":"mdi:brightness-6"},{"property":"unit_of_measurement","value":""},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"payload","stateType":"msg","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"$entity().state ? \"on\": \"off\"","outputPayloadType":"jsonata","x":1050,"y":440,"wires":[[]]},{"id":"a84c4f21f6acb97b","type":"ha-entity","z":"81dea24119402f3d","name":"SET SENSOR: Color Temp in Kelvin","server":"1040bb61.673d75","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"nr_circadian_kelvin"},{"property":"device_class","value":""},{"property":"icon","value":"mdi:brightness-6"},{"property":"unit_of_measurement","value":"K"},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"payload","stateType":"msg","attributes":[],"resend":true,"outputLocation":"payload","outputLocationType":"msg","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"","outputPayloadType":"str","x":1050,"y":500,"wires":[[]]},{"id":"f1c1abfe3bf53636","type":"inject","z":"81dea24119402f3d","name":"Every 2 minutes","props":[{"p":"payload"}],"repeat":"120","crontab":"","once":true,"onceDelay":"10","topic":"","payloadType":"date","x":170,"y":380,"wires":[["645224af50a0017e"]]},{"id":"645224af50a0017e","type":"subflow:9d5b166df6c5a423","z":"81dea24119402f3d","name":"","env":[],"x":420,"y":380,"wires":[["e8b57cc49ea15a40"],["43b21201b05c8013","3cb5b773cf80c3ef"],[]]},{"id":"e8b57cc49ea15a40","type":"function","z":"81dea24119402f3d","name":"SET GLOBAL: Brightness","func":"var brightness = msg.payload\n\nglobal.set( 'nr_circadian_brightness', brightness );\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":711,"y":380,"wires":[["4c3673c951e9d7b9"]]},{"id":"43b21201b05c8013","type":"function","z":"81dea24119402f3d","name":"CONVERT: Kelvin to Mireds","func":"var kelvin = msg.payload;\nvar mireds = Math.round( 1000000 / kelvin );\n\nmsg.payload = mireds;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":721,"y":440,"wires":[["c3c756d436a23c64"]]},{"id":"3cb5b773cf80c3ef","type":"function","z":"81dea24119402f3d","name":"SET GLOBAL: Kelvin","func":"var kelvin = msg.payload;\n\nglobal.set( 'nr_circadian_kelvin', kelvin );\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":701,"y":500,"wires":[["a84c4f21f6acb97b"]]},{"id":"bfbe267f.ea05f8","type":"inject","z":"81dea24119402f3d","name":"","props":[{"p":"payload"}],"repeat":"60","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":150,"y":200,"wires":[["ecf00c0c.9acbc"]]},{"id":"ecf00c0c.9acbc","type":"subflow:26c6c4d5.3a01e4","z":"81dea24119402f3d","name":"","env":[],"x":370,"y":200,"wires":[["ef0a208b.3ff8e8"],["f5e1d08b.a8cd58"],[]],"outputLabels":["Bigthness [%]","Warmth [K]","Debug"],"icon":"node-red-node-suncalc/sun.png"},{"id":"ef0a208b.3ff8e8","type":"ha-entity","z":"81dea24119402f3d","name":"MODIFY SENSOR: Gain [%]","server":"1040bb61.673d75","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"nr_circadian_gain"},{"property":"device_class","value":""},{"property":"icon","value":"mdi:brightness-percent"},{"property":"unit_of_measurement","value":"%"},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"payload","stateType":"msg","attributes":[],"resend":true,"outputLocation":"","outputLocationType":"none","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"","outputPayloadType":"str","x":640,"y":200,"wires":[[]]},{"id":"f5e1d08b.a8cd58","type":"ha-entity","z":"81dea24119402f3d","name":"MODIFY SENSOR: Warmth [K]","server":"1040bb61.673d75","version":2,"debugenabled":false,"outputs":1,"entityType":"sensor","config":[{"property":"name","value":"nr_circadian_warmth"},{"property":"device_class","value":""},{"property":"icon","value":"mdi:brightness-6"},{"property":"unit_of_measurement","value":"K"},{"property":"state_class","value":""},{"property":"last_reset","value":""}],"state":"payload","stateType":"msg","attributes":[],"resend":true,"outputLocation":"payload","outputLocationType":"msg","inputOverride":"allow","outputOnStateChange":false,"outputPayload":"","outputPayloadType":"str","x":650,"y":260,"wires":[[]]},{"id":"b9c175af458d5925","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Outside, Garage Lights","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.garage_exterior","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":180,"y":680,"wires":[["6d4b1fde79a29de3"],[]]},{"id":"6d4b1fde79a29de3","type":"function","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Setup Brightness, 100%","func":"msg.payload = {\n    data : {\n        \"brightness_pct\" : 100\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":890,"y":1000,"wires":[["44c2360e2973d30b"]]},{"id":"b9afd6461191262c","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Foyer, Entryway Light","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.foyer_entryway_ceiling","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":180,"y":1040,"wires":[["6d4b1fde79a29de3"],[]]},{"id":"d01b9c3f05e47861","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Foyer, Hallway Light","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.foyer_ceiling_ledge","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":170,"y":1100,"wires":[["6d4b1fde79a29de3"],[]]},{"id":"28b0e8376823b8b7","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Outside, Entryway Lights","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.foyer_exterior_entryway","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":190,"y":740,"wires":[["6d4b1fde79a29de3"],[]]},{"id":"077858d3b827010a","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Bedroom 1, Closet (Hers)","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.closet_hallway_light_j","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":190,"y":1400,"wires":[["6d4b1fde79a29de3"],[]]},{"id":"cc50702b59c1daa6","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Bedroom 1, Closet (His)","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.closet_hallway_light_t","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":180,"y":1460,"wires":[["6d4b1fde79a29de3"],[]]},{"id":"1c6b4d87eb9ef8c5","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Dining Room, Chandelier","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.dining_room_chandelier","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":190,"y":860,"wires":[["6d4b1fde79a29de3"],[]]},{"id":"d107c7d766bf05d1","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Kitchen, Ceiling Lights","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.kitchen_ceiling_lights","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":180,"y":800,"wires":[["6d4b1fde79a29de3","e2040307364eefff"],[]]},{"id":"44c2360e2973d30b","type":"api-call-service","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Turn Light ON with custom SETTINGS","server":"1040bb61.673d75","version":5,"debugenabled":false,"domain":"light","service":"turn_on","areaId":[],"deviceId":[],"entityId":["{{ topic }}"],"data":"","dataType":"json","mergeContext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1270,"y":800,"wires":[["0e31fd0f938087c7"]]},{"id":"e2040307364eefff","type":"function","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Setup Circadian Color Temp","func":"msg.payload = {\n    data : {\n        \"kelvin\" : context.global.get( 'nr_circadian_kelvin' )\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":900,"y":780,"wires":[["44c2360e2973d30b"]]},{"id":"abf8d9ee7ba9cf8d","type":"function","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Setup Brightness, 80%","func":"msg.payload = {\n    data : {\n        \"brightness_pct\" : 80\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":880,"y":1060,"wires":[["44c2360e2973d30b"]]},{"id":"1dc768bbdc5359ac","type":"function","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Setup Brightness, 60%","func":"msg.payload = {\n    data : {\n        \"brightness_pct\" : 60\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":880,"y":1120,"wires":[["44c2360e2973d30b"]]},{"id":"848729d2b586e7b0","type":"function","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Setup Brightness, 40%","func":"msg.payload = {\n    data : {\n        \"brightness_pct\" : 40\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":880,"y":1180,"wires":[["44c2360e2973d30b"]]},{"id":"475dcb9934229d2f","type":"function","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Setup Brightness, 20%","func":"msg.payload = {\n    data : {\n        \"brightness_pct\" : 20\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":880,"y":1240,"wires":[["44c2360e2973d30b"]]},{"id":"c125f1ef115a3db3","type":"function","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Setup Generic Color Temp","func":"msg.payload = {\n    data : {\n        \"color_temp\" : 200\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":900,"y":840,"wires":[["44c2360e2973d30b"]]},{"id":"5e65ca9be181824f","type":"function","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Setup Circadian Brightness","func":"msg.payload = {\n    data : {\n        \"brightness_pct\" : context.global.get( 'nr_circadian_brightness' )\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":900,"y":940,"wires":[["44c2360e2973d30b"]]},{"id":"56b474f2908c2b33","type":"function","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Setup Circadian Color & Brightness","func":"msg.payload = {\n    data : {\n        \"kelvin\" : context.global.get( 'nr_circadian_kelvin' ), \n        \"brightness_pct\" : context.global.get( 'nr_circadian_brightness' )\n    }\n};\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":920,"y":680,"wires":[["44c2360e2973d30b"]]},{"id":"0e31fd0f938087c7","type":"debug","z":"81dea24119402f3d","g":"8806b584b745745a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1530,"y":800,"wires":[]},{"id":"dc79f3514cd3514d","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Bedroom 4, Desk Lamp","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.bedroom_4_desk_lamp","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":180,"y":1520,"wires":[["e2040307364eefff","848729d2b586e7b0"],[]]},{"id":"1837f7aa88a7ae60","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Bedroom 1, Bedside Lamps","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.bedroom_1_bedside_lamps","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":200,"y":1280,"wires":[["e2040307364eefff"],[]]},{"id":"126413cbde7b5d5e","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Living Room, Corner Lamp","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.living_room_corner_lamp","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":190,"y":920,"wires":[["e2040307364eefff","1dc768bbdc5359ac"],[]]},{"id":"0e296da289d591b5","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Laundry Room, Ceiling Light","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.laundry_ceiling_light","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":200,"y":980,"wires":[["abf8d9ee7ba9cf8d","c125f1ef115a3db3"],[]]},{"id":"f05247446c43b482","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Bedroom 1, Closet Hallway","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.closet_hallway_ceiling_light","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":190,"y":1340,"wires":[["abf8d9ee7ba9cf8d"],[]]},{"id":"7efdbde4e0e67848","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Bedroom 4, Lightstrip","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.bedroom_4_lightstrip","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":180,"y":1580,"wires":[["848729d2b586e7b0","c125f1ef115a3db3"],[]]},{"id":"f19ff094baa9b02b","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Foyer, Lightstrip Ceiling Ledge","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.foyer_ceiling_ledge","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":200,"y":1160,"wires":[["848729d2b586e7b0","c125f1ef115a3db3"],[]]},{"id":"b1a00b993f06f4e5","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Foyer, Lightstrip Under Table","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.foyer_under_table","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off","propertyValue":"old_state.state"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on","propertyValue":"new_state.state"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":200,"y":1220,"wires":[["475dcb9934229d2f","c125f1ef115a3db3"],[]]},{"id":"db49b0e0b2f5d0d1","type":"trigger-state","z":"81dea24119402f3d","g":"8806b584b745745a","name":"Kitchen, Cabinets, Upper Coffee Bar","server":"1040bb61.673d75","version":2,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityid":"light.kitchen_cabinet_upper_coffee_bar","entityidfiltertype":"exact","debugenabled":false,"constraints":[{"targetType":"this_entity","targetValue":"","propertyType":"previous_state","propertyValue":"old_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"off"},{"targetType":"this_entity","targetValue":"","propertyType":"current_state","propertyValue":"new_state.state","comparatorType":"is","comparatorValueDatatype":"str","comparatorValue":"on"}],"inputs":0,"outputs":2,"customoutputs":[],"outputinitially":false,"state_type":"str","enableInput":false,"x":220,"y":1640,"wires":[["c125f1ef115a3db3","475dcb9934229d2f"],[]]}]